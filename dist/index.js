"use strict";var ia=Object.defineProperty;var sa=(e,t,n)=>t in e?ia(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var B=(e,t,n)=>sa(e,typeof t!="symbol"?t+"":t,n);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const l=require("react/jsx-runtime"),y=require("react");async function aa(e,t){const n={"Content-Type":"application/json"};t!=null&&t.userMpAuthToken&&(n["x-oddle-mp-auth-token"]=t.userMpAuthToken),t!=null&&t.chatServerKey&&(n["x-oddle-chat-server-key"]=t.chatServerKey);const r=await fetch(`${e}/api/v1/agent-configuration`,{method:"GET",headers:n});if(!r.ok){const s=await r.json().catch(()=>({}));throw new Error(s.message||`Failed to get agent configuration: ${r.statusText}`)}return(await r.json()).configuration}async function oa(e,t,n){const r={"Content-Type":"application/json"};n!=null&&n.userMpAuthToken&&(r["x-oddle-mp-auth-token"]=n.userMpAuthToken),n!=null&&n.chatServerKey&&(r["x-oddle-chat-server-key"]=n.chatServerKey);const i=await fetch(`${e}/api/v1/agent-configuration`,{method:"PUT",headers:r,body:JSON.stringify(t)});if(!i.ok){const a=await i.json().catch(()=>({}));throw new Error(a.message||`Failed to update agent configuration: ${i.statusText}`)}return(await i.json()).configuration}async function Gi(e,t,n){const r=new URLSearchParams;r.append("format","client"),t.entityId&&r.append("entityId",t.entityId),t.entityType&&r.append("entityType",t.entityType),console.log("Metadata to append:",t.metadata),t.metadata&&Object.keys(t.metadata).length>0&&r.append("metadata",JSON.stringify(t.metadata));const i=`${e}/api/v1/messages/query?${r.toString()}`,s={"Content-Type":"application/json"};n!=null&&n.userMpAuthToken&&(s["x-oddle-mp-auth-token"]=n.userMpAuthToken),n!=null&&n.chatServerKey&&(s["x-oddle-chat-server-key"]=n.chatServerKey),console.log("Fetching thread messages from:",i);const a=await fetch(i,{method:"GET",headers:s});if(!a.ok)throw new Error(`Failed to fetch thread messages: ${a.statusText}`);const o=await a.json();return{messages:o.messages||[],providerResId:o.providerResId,threadId:o.threadId}}async function cr(e,t,n,r){const i=`${e}/api/v1/threads/${t}`,s={"Content-Type":"application/json"};r!=null&&r.userMpAuthToken&&(s["x-oddle-mp-auth-token"]=r.userMpAuthToken),r!=null&&r.chatServerKey&&(s["x-oddle-chat-server-key"]=r.chatServerKey);const a=await fetch(i,{method:"PATCH",headers:s,body:JSON.stringify(n)});if(!a.ok){const c=await a.json().catch(()=>({error:"Failed to update thread"}));throw new Error(c.error||"Failed to update thread")}const o=await a.json();if(!o.success)throw new Error(o.error||"Failed to update thread");return o.data}async function ur(e,t,n,r){const i=`${e}/api/v1/threads/${t}`,s={"Content-Type":"application/json"};r!=null&&r.userMpAuthToken&&(s["x-oddle-mp-auth-token"]=r.userMpAuthToken),r!=null&&r.chatServerKey&&(s["x-oddle-chat-server-key"]=r.chatServerKey);const a=await fetch(i,{method:"PATCH",headers:s,body:JSON.stringify(n)});if(!a.ok){const c=await a.json().catch(()=>({error:"Failed to update thread metadata"}));throw new Error(c.error||"Failed to update thread metadata")}const o=await a.json();if(!o.success)throw new Error(o.error||"Failed to update thread metadata");return o.data}const Ur=e=>{let t;const n=new Set,r=(u,h)=>{const p=typeof u=="function"?u(t):u;if(!Object.is(p,t)){const g=t;t=h??(typeof p!="object"||p===null)?p:Object.assign({},t,p),n.forEach(d=>d(t,g))}},i=()=>t,o={setState:r,getState:i,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u))},c=t=e(r,i,o);return o},la=e=>e?Ur(e):Ur,ca=e=>e;function ua(e,t=ca){const n=y.useSyncExternalStore(e.subscribe,y.useCallback(()=>t(e.getState()),[e,t]),y.useCallback(()=>t(e.getInitialState()),[e,t]));return y.useDebugValue(n),n}const ha=e=>{const t=la(e),n=r=>ua(t,r);return Object.assign(n,t),n},da=e=>ha,zr={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Xt=new Map,ln=e=>{const t=Xt.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([n,r])=>[n,r.getState()])):{}},pa=(e,t,n)=>{if(e===void 0)return{type:"untracked",connection:t.connect(n)};const r=Xt.get(n.name);if(r)return{type:"tracked",store:e,...r};const i={connection:t.connect(n),stores:{}};return Xt.set(n.name,i),{type:"tracked",store:e,...i}},fa=(e,t)=>{if(t===void 0)return;const n=Xt.get(e);n&&(delete n.stores[t],Object.keys(n.stores).length===0&&Xt.delete(e))},ga=e=>{var t,n;if(!e)return;const r=e.split(`
`),i=r.findIndex(a=>a.includes("api.setState"));if(i<0)return;const s=((t=r[i+1])==null?void 0:t.trim())||"";return(n=/.+ (.+) .+/.exec(s))==null?void 0:n[1]},ma=(e,t={})=>(n,r,i)=>{const{enabled:s,anonymousActionType:a,store:o,...c}=t;let u;try{u=(s??(zr?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return e(n,r,i);const{connection:h,...p}=pa(o,u,c);let g=!0;i.setState=(w,A,E)=>{const _=n(w,A);if(!g)return _;const N=E===void 0?{type:a||ga(new Error().stack)||"anonymous"}:typeof E=="string"?{type:E}:E;return o===void 0?(h==null||h.send(N,r()),_):(h==null||h.send({...N,type:`${o}/${N.type}`},{...ln(c.name),[o]:i.getState()}),_)},i.devtools={cleanup:()=>{h&&typeof h.unsubscribe=="function"&&h.unsubscribe(),fa(c.name,o)}};const d=(...w)=>{const A=g;g=!1,n(...w),g=A},x=e(i.setState,r,i);if(p.type==="untracked"?h==null||h.init(x):(p.stores[p.store]=i,h==null||h.init(Object.fromEntries(Object.entries(p.stores).map(([w,A])=>[w,w===p.store?x:A.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let w=!1;const A=i.dispatch;i.dispatch=(...E)=>{(zr?"production":void 0)!=="production"&&E[0].type==="__setState"&&!w&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),w=!0),A(...E)}}return h.subscribe(w=>{var A;switch(w.type){case"ACTION":if(typeof w.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return An(w.payload,E=>{if(E.type==="__setState"){if(o===void 0){d(E.state);return}Object.keys(E.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const _=E.state[o];if(_==null)return;JSON.stringify(i.getState())!==JSON.stringify(_)&&d(_);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(E)});case"DISPATCH":switch(w.payload.type){case"RESET":return d(x),o===void 0?h==null?void 0:h.init(i.getState()):h==null?void 0:h.init(ln(c.name));case"COMMIT":if(o===void 0){h==null||h.init(i.getState());return}return h==null?void 0:h.init(ln(c.name));case"ROLLBACK":return An(w.state,E=>{if(o===void 0){d(E),h==null||h.init(i.getState());return}d(E[o]),h==null||h.init(ln(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return An(w.state,E=>{if(o===void 0){d(E);return}JSON.stringify(i.getState())!==JSON.stringify(E[o])&&d(E[o])});case"IMPORT_STATE":{const{nextLiftedState:E}=w.payload,_=(A=E.computedStates.slice(-1)[0])==null?void 0:A.state;if(!_)return;d(o===void 0?_:_[o]),h==null||h.send(null,E);return}case"PAUSE_RECORDING":return g=!g}return}}),x},Ca=ma,An=(e,t)=>{let n;try{n=JSON.parse(e)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&t(n)},xa=e=>({isModalOpen:!1,isCollapsed:!1,currentMode:"sidebar",setIsModalOpen:t=>e({isModalOpen:t}),setIsCollapsed:t=>e({isCollapsed:t}),setCurrentMode:t=>e({currentMode:t}),openModal:()=>e({isModalOpen:!0}),closeModal:()=>e({isModalOpen:!1}),toggleCollapse:()=>e(t=>({isCollapsed:!t.isCollapsed})),toggleFullscreen:()=>e(t=>({currentMode:t.currentMode==="sidebar"?"fullscreen":"sidebar"}))}),Ge={IDLE:"idle",SUBMITTED:"submitted",STREAMING:"streaming",ERROR:"error"},Yt={STARTING:"Starting...",PROCESSING:"Processing...",THINKING:"Thinking...",STREAMING:"Streaming response...",FINALIZING:"Finalizing...",COMPLETED:"Completed",ERROR:"Error occurred",IDLE:""},be={PROCESSING:"processing",COMPLETED:"completed",ERROR:"error"},ya=e=>e===Ge.SUBMITTED||e===Ge.STREAMING,wa=e=>e===Ge.IDLE,Sa=e=>e===Ge.ERROR,Ea=e=>e===be.PROCESSING,Ta=e=>e===be.COMPLETED,_a=e=>e===be.ERROR,ka=e=>({chatStatus:Ge.IDLE,streamingStatus:Yt.IDLE,setChatStatus:t=>e({chatStatus:t}),setStreamingStatus:t=>e({streamingStatus:t}),resetChatStatus:()=>e({chatStatus:Ge.IDLE,streamingStatus:Yt.IDLE})}),ba=e=>({isLoadingConversation:!1,conversationError:null,setIsLoadingConversation:t=>e({isLoadingConversation:t}),setConversationError:t=>e({conversationError:t}),clearConversationError:()=>e({conversationError:null})}),va=e=>({currentThreadId:null,providerResId:null,setCurrentThreadId:t=>e({currentThreadId:t}),setProviderResId:t=>e({providerResId:t}),clearThreadData:()=>e({currentThreadId:null,providerResId:null})}),Ia=e=>({isDevSettingsOpen:!1,setIsDevSettingsOpen:t=>e({isDevSettingsOpen:t}),toggleDevSettings:()=>e(t=>({isDevSettingsOpen:!t.isDevSettingsOpen}))}),Ra=e=>({isStreaming:!1,isThinking:!1,streamingContent:"",isHandlingTool:!1,currentAssistantMessageId:null,setIsStreaming:t=>e({isStreaming:t}),setIsThinking:t=>e({isThinking:t}),setStreamingContent:t=>e({streamingContent:t}),setIsHandlingTool:t=>e({isHandlingTool:t}),setCurrentAssistantMessageId:t=>e({currentAssistantMessageId:t}),startStreaming:t=>e({isStreaming:!0,isThinking:!0,currentAssistantMessageId:t,streamingContent:"",isHandlingTool:!1}),stopStreaming:()=>e({isStreaming:!1,isThinking:!1}),clearStreamingBuffers:()=>e({streamingContent:"",currentAssistantMessageId:null}),resetToolHandling:()=>e({isHandlingTool:!1})}),$=da()(Ca((...e)=>({...xa(...e),...ka(...e),...ba(...e),...va(...e),...Ia(...e),...Ra(...e)}),{name:"ChatUI-Store"})),Aa=()=>$(e=>({isModalOpen:e.isModalOpen,isCollapsed:e.isCollapsed,currentMode:e.currentMode,openModal:e.openModal,closeModal:e.closeModal,toggleCollapse:e.toggleCollapse,toggleFullscreen:e.toggleFullscreen})),Ma=()=>$(e=>({chatStatus:e.chatStatus,streamingStatus:e.streamingStatus,setChatStatus:e.setChatStatus,setStreamingStatus:e.setStreamingStatus,resetChatStatus:e.resetChatStatus})),Na=()=>$(e=>({isLoadingConversation:e.isLoadingConversation,conversationError:e.conversationError,setIsLoadingConversation:e.setIsLoadingConversation,setConversationError:e.setConversationError,clearConversationError:e.clearConversationError})),La=()=>$(e=>({currentThreadId:e.currentThreadId,providerResId:e.providerResId,setCurrentThreadId:e.setCurrentThreadId,setProviderResId:e.setProviderResId,clearThreadData:e.clearThreadData})),Oa=()=>$(e=>({isDevSettingsOpen:e.isDevSettingsOpen,setIsDevSettingsOpen:e.setIsDevSettingsOpen,toggleDevSettings:e.toggleDevSettings})),Vi=({isOpen:e,onClose:t,apiUrl:n,userMpAuthToken:r,chatServerKey:i,app:s="UD21",onDisconnect:a,isConnected:o=!1})=>{const[c,u]=y.useState(null),[h,p]=y.useState(""),[g,d]=y.useState(""),x=$(f=>f.providerResId),[w,A]=y.useState(""),[E,_]=y.useState("BRAND"),[N,j]=y.useState(""),[L,T]=y.useState(""),[O,D]=y.useState(!1),[P,U]=y.useState(null),[M,b]=y.useState(null),[H,G]=y.useState("agent");y.useEffect(()=>{e&&!c&&F()},[e]);const F=y.useCallback(async()=>{D(!0),U(null);try{const f=await aa(n,{userMpAuthToken:r,chatServerKey:i});if(!f)throw new Error(`No configuration found for app: ${s}`);u(f),p(f.promptPath),d(f.versionUuid)}catch(f){U(f instanceof Error?f.message:"Failed to fetch configuration"),console.error("Error fetching agent configuration:",f)}finally{D(!1)}},[n,s,r,i]),q=y.useCallback(async()=>{if(c){D(!0),U(null);try{const f=await oa(n,{app:c.app,promptPath:h,versionUuid:g,isDefault:c.isDefault},{userMpAuthToken:r,chatServerKey:i});u(f),t(),window.location.reload()}catch(f){U(f instanceof Error?f.message:"Failed to update configuration"),console.error("Error updating agent configuration:",f)}finally{D(!1)}}},[n,h,g,c,t,r,i]),X=y.useCallback(async()=>{if(!x){U("No active conversation to attach");return}D(!0),U(null),b(null);try{let f;if(L.trim())try{f=JSON.parse(L)}catch{throw new Error("Invalid JSON in metadata field")}const Q=w&&E,ge=N||f;if(Q&&await cr(n,x,{entityId:w,entityType:E},{userMpAuthToken:r,chatServerKey:i}),ge&&await ur(n,x,{tag:N||void 0,metadata:f},{userMpAuthToken:r,chatServerKey:i}),!Q&&!ge){U("Please provide at least one field to update");return}b("Thread updated successfully!"),setTimeout(()=>{A(""),_("BRAND"),j(""),T(""),b(null)},2e3)}catch(f){U(f instanceof Error?f.message:"Failed to update thread"),console.error("Error updating thread:",f)}finally{D(!1)}},[x,n,w,E,N,L,r,i]),ie=y.useCallback(()=>{a&&(U(null),b(null),a(),b("WebSocket disconnected successfully!"),setTimeout(()=>{b(null),t()},1500))},[a,t]),ve=y.useCallback(()=>{c&&(p(c.promptPath),d(c.versionUuid)),U(null),t()},[c,t]);return e?l.jsx("div",{className:"chat-wrapper__dev-settings-overlay",children:l.jsxs("div",{className:"chat-wrapper__dev-settings-popup",children:[l.jsxs("div",{className:"chat-wrapper__dev-settings-header",children:[l.jsx("h3",{children:"Developer Settings"}),l.jsx("button",{className:"chat-wrapper__dev-settings-close",onClick:ve,title:"Close settings",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z",fill:"currentColor"})})})]}),l.jsxs("div",{className:"chat-wrapper__dev-settings-tabs",children:[l.jsx("button",{className:`chat-wrapper__dev-settings-tab ${H==="agent"?"active":""}`,onClick:()=>G("agent"),children:"Agent Config"}),l.jsx("button",{className:`chat-wrapper__dev-settings-tab ${H==="thread"?"active":""}`,onClick:()=>G("thread"),children:"Thread Attachment"}),l.jsx("button",{className:`chat-wrapper__dev-settings-tab ${H==="connection"?"active":""}`,onClick:()=>G("connection"),children:"Connection"})]}),l.jsxs("div",{className:"chat-wrapper__dev-settings-content",children:[M&&l.jsx("div",{className:"chat-wrapper__dev-settings-success",children:M}),O&&l.jsx("div",{className:"chat-wrapper__dev-settings-loading",children:"Loading configuration..."}),P&&l.jsxs("div",{className:"chat-wrapper__dev-settings-error",children:[l.jsxs("p",{children:["Error: ",P]}),l.jsx("button",{onClick:H==="agent"?F:void 0,className:"chat-wrapper__dev-settings-retry",children:"Retry"})]}),H==="agent"&&c&&!O&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"chat-wrapper__dev-settings-field",children:[l.jsx("label",{htmlFor:"agent-prompt-path",children:"Prompt Path:"}),l.jsx("input",{id:"agent-prompt-path",type:"text",value:h,onChange:f=>p(f.target.value),placeholder:"e.g., /prompts/custom-agent.md",className:"chat-wrapper__dev-settings-input",disabled:O}),l.jsx("p",{className:"chat-wrapper__dev-settings-help",children:"Path to the agent prompt file."})]}),l.jsxs("div",{className:"chat-wrapper__dev-settings-field",children:[l.jsx("label",{htmlFor:"version-uuid",children:"Version UUID:"}),l.jsx("input",{id:"version-uuid",type:"text",value:g,onChange:f=>d(f.target.value),placeholder:"e.g., 123e4567-e89b-12d3-a456-426614174000",className:"chat-wrapper__dev-settings-input",disabled:O}),l.jsx("p",{className:"chat-wrapper__dev-settings-help",children:"Version UUID for the agent configuration."})]}),l.jsxs("div",{className:"chat-wrapper__dev-settings-field",children:[l.jsx("label",{htmlFor:"app-name",children:"App:"}),l.jsx("input",{id:"app-name",type:"text",value:c.app,className:"chat-wrapper__dev-settings-input",disabled:!0,readOnly:!0}),l.jsx("p",{className:"chat-wrapper__dev-settings-help",children:"Application name for this agent configuration."})]})]}),H==="thread"&&!O&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"chat-wrapper__dev-settings-info",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Provider Resource ID:"})," ",x||"No active conversation"]}),l.jsx("p",{style:{fontSize:"12px",color:"#666",marginTop:"8px"},children:"Note: Entity ownership is typically set at initialization. Use this to update business context."})]}),l.jsxs("div",{className:"chat-wrapper__dev-settings-section",children:[l.jsx("h4",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:"600"},children:"Update Business Context"}),l.jsx("p",{style:{marginBottom:"12px",fontSize:"12px",color:"#666"},children:"Update dynamic metadata like order IDs, table IDs, status, etc."}),l.jsxs("div",{className:"chat-wrapper__dev-settings-field",children:[l.jsx("label",{htmlFor:"tag",children:"Tag:"}),l.jsx("input",{id:"tag",type:"text",value:N,onChange:f=>j(f.target.value),placeholder:"e.g., customer-inquiry, support",className:"chat-wrapper__dev-settings-input",disabled:O||!x}),l.jsx("p",{className:"chat-wrapper__dev-settings-help",children:"Optional tag for categorizing the thread."})]}),l.jsxs("div",{className:"chat-wrapper__dev-settings-field",children:[l.jsx("label",{htmlFor:"metadata",children:"Metadata (JSON):"}),l.jsx("textarea",{id:"metadata",value:L,onChange:f=>T(f.target.value),placeholder:'{"orderId": "order_789", "tableId": "table_5", "status": "pending"}',className:"chat-wrapper__dev-settings-input",rows:4,disabled:O||!x}),l.jsx("p",{className:"chat-wrapper__dev-settings-help",children:"App-specific business data (orderId, tableId, campaignId, etc.)."})]})]}),l.jsx("div",{style:{borderTop:"1px solid #e0e0e0",margin:"20px 0"}}),l.jsxs("details",{style:{marginTop:"16px"},children:[l.jsx("summary",{style:{cursor:"pointer",fontSize:"13px",fontWeight:"600",color:"#666"},children:"Advanced: Change Entity Ownership (Rare)"}),l.jsxs("div",{style:{marginTop:"12px",padding:"12px",backgroundColor:"#f9f9f9",borderRadius:"4px"},children:[l.jsx("p",{style:{fontSize:"12px",color:"#666",marginBottom:"12px"},children:"âš ï¸ Entity is typically set at initialization. Only change this if transferring conversation ownership."}),l.jsxs("div",{className:"chat-wrapper__dev-settings-field",children:[l.jsx("label",{htmlFor:"entity-id",children:"Entity ID:"}),l.jsx("input",{id:"entity-id",type:"text",value:w,onChange:f=>A(f.target.value),placeholder:"e.g., brand_123 or account_456",className:"chat-wrapper__dev-settings-input",disabled:O||!x}),l.jsx("p",{className:"chat-wrapper__dev-settings-help",children:"The brand or account ID to attach this thread to."})]}),l.jsxs("div",{className:"chat-wrapper__dev-settings-field",children:[l.jsx("label",{htmlFor:"entity-type",children:"Entity Type:"}),l.jsxs("select",{id:"entity-type",value:E,onChange:f=>_(f.target.value),className:"chat-wrapper__dev-settings-input",disabled:O||!x,children:[l.jsx("option",{value:"",children:"-- Select Type --"}),l.jsx("option",{value:"BRAND",children:"BRAND"}),l.jsx("option",{value:"ACCOUNT",children:"ACCOUNT"})]}),l.jsx("p",{className:"chat-wrapper__dev-settings-help",children:"Type of entity (BRAND or ACCOUNT)."})]})]})]})]}),H==="connection"&&!O&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"chat-wrapper__dev-settings-info",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Connection Status:"})," ",o?"ðŸŸ¢ Connected":"ðŸ”´ Disconnected"]}),l.jsx("p",{style:{fontSize:"12px",color:"#666",marginTop:"8px"},children:"Manage your WebSocket connection to the chat server."})]}),l.jsxs("div",{className:"chat-wrapper__dev-settings-section",children:[l.jsx("h4",{style:{marginBottom:"8px",fontSize:"14px",fontWeight:"600"},children:"Disconnect WebSocket"}),l.jsx("p",{style:{marginBottom:"12px",fontSize:"12px",color:"#666"},children:"Click the button below to manually disconnect the WebSocket connection. This will stop all communication with the chat server."}),l.jsx("button",{className:"chat-wrapper__dev-settings-btn chat-wrapper__dev-settings-btn--save",onClick:ie,disabled:!o||!a,style:{width:"100%",marginTop:"12px"},children:o?"Disconnect WebSocket":"Already Disconnected"}),!a&&l.jsx("p",{style:{fontSize:"12px",color:"#ff6b6b",marginTop:"8px"},children:"âš ï¸ Disconnect function not available"})]})]})]}),l.jsxs("div",{className:"chat-wrapper__dev-settings-footer",children:[l.jsx("button",{className:"chat-wrapper__dev-settings-btn chat-wrapper__dev-settings-btn--cancel",onClick:ve,disabled:O,children:"Cancel"}),H==="agent"&&l.jsx("button",{className:"chat-wrapper__dev-settings-btn chat-wrapper__dev-settings-btn--save",onClick:q,disabled:O||!c,children:O?"Saving...":"Save & Reload"}),H==="thread"&&l.jsx("button",{className:"chat-wrapper__dev-settings-btn chat-wrapper__dev-settings-btn--save",onClick:X,disabled:O||!x,children:O?"Updating...":"Update Thread"})]})]})}):null},Da={maxReconnectAttempts:1/0,reconnectDelay:1e3,heartbeatInterval:3e4},cn={NORMAL:1e3,GOING_AWAY:1001};var Ke=(e=>(e.CONNECTION_ESTABLISHED="connection_established",e.CONNECTION_LOST="connection_lost",e.CONNECTION_RESTORED="connection_restored",e.CONNECTION_FAILED="connection_failed",e.RECONNECTING="reconnecting",e.CHAT_COMPLETED="chat_completed",e.CHAT_ERROR="chat_error",e))(Ke||{}),ft=(e=>(e.CHAT_MESSAGE="chat_message",e.CONFIGURE_TOOLS="configure_tools",e.UPDATE_TOOLS="update_tools",e.UPDATE_CONTEXT_HELPERS="update_context_helpers",e.TOOL_CALL_RESPONSE="tool_call_response",e.HEARTBEAT_PING="heartbeat_ping",e.HEARTBEAT_PONG="heartbeat_pong",e))(ft||{}),Me=(e=>(e.SESSION_ESTABLISHED="session_established",e.TOOLS_CONFIGURED="tools_configured",e.CLIENT_TOOLS_UPDATED="client_tools_updated",e.CONFIGURE_TOOLS="configure_tools",e.CHAT_EVENT="chat_event",e.CHAT_FINISHED="chat_finished",e.CHAT_ERROR="chat_error",e.THREAD_CREATED="thread_created",e.TOOL_CALL_REQUEST="tool_call_request",e.HEARTBEAT_PING="heartbeat_ping",e.HEARTBEAT_ACK="heartbeat_ack",e.ERROR="error",e))(Me||{}),gn=(e=>(e.PROVIDER_EVENT="provider-event",e.LATITUDE_EVENT="latitude-event",e.CONTENT_DELTA="content-delta",e))(gn||{}),St=(e=>(e.TEXT_DELTA="text-delta",e.REASONING_START="reasoning-start",e.REASONING_DELTA="reasoning-delta",e.REASONING_END="reasoning-end",e.TOOL_CALL="tool-call",e.TOOL_RESULT="tool-result",e))(St||{});class Ot{static createConnectionEvent(t,n){return{type:t,timestamp:new Date,data:n}}static createChatEvent(t,n){return{type:t,timestamp:new Date,data:n}}static connectionEstablished(){return this.createConnectionEvent(Ke.CONNECTION_ESTABLISHED)}static connectionLost(t){return this.createConnectionEvent(Ke.CONNECTION_LOST,{reason:t})}static connectionRestored(){return this.createConnectionEvent(Ke.CONNECTION_RESTORED)}static reconnecting(t,n){return this.createConnectionEvent(Ke.RECONNECTING,{attempt:t,maxAttempts:n})}static chatCompleted(t){return this.createChatEvent(Ke.CHAT_COMPLETED,{conversationId:t})}static chatError(t,n){return this.createChatEvent(Ke.CHAT_ERROR,{error:t,errorCode:n})}}class Et{static createChatMessage(t){return{type:ft.CHAT_MESSAGE,content:t.content,media:t.media||[],providerResId:t.providerResId}}static createConfigureToolsMessage(t,n){return{type:ft.CONFIGURE_TOOLS,toolSchemas:t,contextHelpers:n}}static createUpdateToolsMessage(t){return{type:ft.UPDATE_TOOLS,toolSchemas:t}}static createUpdateContextHelpersMessage(t){return{type:ft.UPDATE_CONTEXT_HELPERS,contextHelpers:t}}static createToolCallSuccessResponse(t,n){return{type:ft.TOOL_CALL_RESPONSE,callId:t,result:n}}static createToolCallErrorResponse(t,n){return{type:ft.TOOL_CALL_RESPONSE,callId:t,error:n}}static createHeartbeatPing(){return{type:ft.HEARTBEAT_PING,timestamp:new Date().toISOString(),pingTime:Date.now()}}static createHeartbeatPong(t,n){return{type:ft.HEARTBEAT_PONG,timestamp:new Date().toISOString(),originalTimestamp:t,pingTime:n}}static serialize(t){return JSON.stringify(t)}static createAndSerialize(t){return this.serialize(t())}static serializeChatMessage(t){return this.createAndSerialize(()=>this.createChatMessage(t))}static serializeConfigureTools(t,n){return this.createAndSerialize(()=>this.createConfigureToolsMessage(t,n))}static serializeUpdateTools(t){return this.createAndSerialize(()=>this.createUpdateToolsMessage(t))}static serializeUpdateContextHelpers(t){return this.createAndSerialize(()=>this.createUpdateContextHelpersMessage(t))}static serializeToolCallSuccess(t,n){return this.createAndSerialize(()=>this.createToolCallSuccessResponse(t,n))}static serializeToolCallError(t,n){return this.createAndSerialize(()=>this.createToolCallErrorResponse(t,n))}static serializeHeartbeatPing(){return this.createAndSerialize(()=>this.createHeartbeatPing())}static serializeHeartbeatPong(t,n){return this.createAndSerialize(()=>this.createHeartbeatPong(t,n))}}class ja{constructor(t,n){B(this,"ws",null);B(this,"config");B(this,"connectionState");B(this,"reconnectTimer",null);B(this,"heartbeatInterval",null);B(this,"visibilityChangeHandler");B(this,"currentTicket",null);B(this,"currentSessionId",null);B(this,"intentionalDisconnect",!1);B(this,"onOpen");B(this,"onMessage");B(this,"onError");B(this,"onClose");B(this,"onSystemEvent");this.config=t,this.connectionState=n,this.visibilityChangeHandler=this.handleVisibilityChange.bind(this),this.registerVisibilityHandler()}connect(t){return new Promise((n,r)=>{try{this.intentionalDisconnect=!1,t&&(this.currentTicket=t);const i=this.buildWebSocketUrl();if(this.ws=new WebSocket(i),!this.ws){r(new Error("WebSocket not initialized"));return}this.setupEventHandlers(n,r)}catch(i){r(i)}})}buildWebSocketUrl(){let t=this.config.apiUrl.replace(/^https:\/\//,"wss://").replace(/^http:\/\//,"ws://");if(t=t.endsWith("/ws")?t:t+"/ws",this.currentSessionId){const n=t.includes("?")?"&":"?";return t=`${t}${n}sessionId=${this.currentSessionId}`,t}if(this.currentTicket){const n=t.includes("?")?"&":"?";t=`${t}${n}ticket=${this.currentTicket}`}return t}setupEventHandlers(t,n){this.ws&&(this.ws.onopen=()=>this.handleConnectionOpened(t),this.ws.onerror=r=>this.handleConnectionError(r,t,n),this.ws.onmessage=r=>{var i;return(i=this.onMessage)==null?void 0:i.call(this,r)},this.ws.onclose=r=>this.handleConnectionClosed(r))}handleConnectionOpened(t){var n;this.updateConnectionState(!0,!1),this.startHeartbeat(),(n=this.onOpen)==null||n.call(this),t==null||t()}handleConnectionError(t,n,r){var i;if((i=this.onError)==null||i.call(this,t),this.connectionState.setConnected(!1),r){r(t);return}this.intentionalDisconnect||this.scheduleReconnectAfterError()}handleConnectionClosed(t){var n;console.log("[WebSocketManager] Connection closed",{code:t.code,reason:t.reason,intentionalDisconnect:this.intentionalDisconnect}),this.processConnectionClosure(t),(n=this.onClose)==null||n.call(this,t),this.shouldReconnectAfterClose(t.code)?(console.log("[WebSocketManager] Should reconnect, calling attemptReconnect"),this.attemptReconnect()):console.log("[WebSocketManager] Should NOT reconnect")}updateConnectionState(t,n){this.connectionState.setConnected(t),this.connectionState.setReconnecting(n),this.connectionState.resetReconnectAttempts(),this.connectionState.updateReconnectDelay(this.config.reconnectDelay)}processConnectionClosure(t){this.connectionState.setConnected(!1),this.stopHeartbeat()}shouldReconnectAfterClose(t){if(console.log("[WebSocketManager] shouldReconnectAfterClose check",{closeCode:t,intentionalDisconnect:this.intentionalDisconnect,NORMAL:cn.NORMAL,GOING_AWAY:cn.GOING_AWAY}),this.intentionalDisconnect)return console.log("[WebSocketManager] Intentional disconnect - no reconnect"),!1;const{NORMAL:n}=cn,r=t!==n;return console.log("[WebSocketManager] Should reconnect?",r),r}handleVisibilityChange(){document.visibilityState==="visible"&&!this.connectionState.isConnected&&!this.connectionState.isReconnecting&&this.attemptReconnect()}registerVisibilityHandler(){typeof document<"u"&&document.addEventListener("visibilitychange",this.visibilityChangeHandler)}attemptReconnect(){var a,o;if(console.log("[WebSocketManager] attemptReconnect called",{reconnectAttempts:this.connectionState.reconnectAttempts,maxReconnectAttempts:this.config.maxReconnectAttempts,isReconnecting:this.connectionState.isReconnecting,reconnectTimer:this.reconnectTimer}),this.connectionState.reconnectAttempts>=this.config.maxReconnectAttempts){console.log("[WebSocketManager] Max reconnection attempts reached"),(a=this.onSystemEvent)==null||a.call(this,Ot.connectionLost("Max reconnection attempts reached")),this.connectionState.setReconnecting(!1);return}if(this.reconnectTimer!==null){console.log("[WebSocketManager] Reconnection already in progress, skipping");return}this.connectionState.setReconnecting(!0),this.connectionState.incrementReconnectAttempts();const t=this.connectionState.reconnectAttempts,n=this.config.maxReconnectAttempts;console.log("[WebSocketManager] Firing RECONNECTING event",{attempt:t,maxAttempts:n}),(o=this.onSystemEvent)==null||o.call(this,Ot.reconnecting(t,n));const r=this.config.reconnectDelay,i=Math.random()*90+10,s=r+i;this.reconnectTimer=window.setTimeout(()=>{this.reconnectTimer=null,this.connectionState.isConnected||this.reconnect()},s)}reconnect(){try{this.closeConnection();const t=this.buildWebSocketUrl();this.ws=new WebSocket(t),this.setupReconnectHandlers()}catch{this.scheduleReconnectAfterError()}}updateTicket(t){this.currentTicket=t}updateSession(t){this.currentSessionId=t}setupReconnectHandlers(){this.ws&&(this.ws.onopen=()=>this.handleReconnectionOpened(),this.ws.onerror=()=>this.handleReconnectionError(),this.ws.onmessage=t=>{var n;return(n=this.onMessage)==null?void 0:n.call(this,t)},this.ws.onclose=t=>this.handleReconnectionClosed(t))}handleReconnectionOpened(){var t,n;this.updateConnectionState(!0,!1),this.startHeartbeat(),(t=this.onSystemEvent)==null||t.call(this,Ot.connectionRestored()),(n=this.onOpen)==null||n.call(this)}handleReconnectionError(){this.scheduleReconnectAfterError()}scheduleReconnectAfterError(){const t=this.config.reconnectDelay,n=Math.random()*90+10,r=t+n;this.reconnectTimer!==null&&(window.clearTimeout(this.reconnectTimer),this.reconnectTimer=null),setTimeout(()=>this.attemptReconnect(),r)}handleReconnectionClosed(t){this.processConnectionClosure(t),this.shouldReconnectAfterClose(t.code)?this.attemptReconnect():this.connectionState.setReconnecting(!1)}startHeartbeat(){}sendHeartbeat(){const t=Et.serializeHeartbeatPing();this.send(t)}stopHeartbeat(){this.heartbeatInterval&&(clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}send(t){var n;((n=this.ws)==null?void 0:n.readyState)===WebSocket.OPEN&&this.ws.send(t)}closeConnection(){this.ws&&this.ws.close(cn.NORMAL)}disconnect(){this.intentionalDisconnect=!0,this.clearTimers(),this.removeEventListeners(),this.closeConnection(),this.connectionState.reset(),this.ws=null}clearTimers(){this.reconnectTimer&&(window.clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.stopHeartbeat()}removeEventListeners(){typeof document<"u"&&this.visibilityChangeHandler&&document.removeEventListener("visibilitychange",this.visibilityChangeHandler)}getWebSocketState(){return this.ws?{[WebSocket.CONNECTING]:"CONNECTING",[WebSocket.OPEN]:"OPEN",[WebSocket.CLOSING]:"CLOSING",[WebSocket.CLOSED]:"CLOSED"}[this.ws.readyState]||"UNKNOWN":"null"}setEventHandlers(t){this.onOpen=t.onOpen,this.onMessage=t.onMessage,this.onError=t.onError,this.onClose=t.onClose,this.onSystemEvent=t.onSystemEvent}}class Pa{constructor(){B(this,"state");this.state={isConnected:!1,isReconnecting:!1,reconnectAttempts:0,reconnectDelay:1e3}}update(t){Object.assign(this.state,t)}get isConnected(){return this.state.isConnected}get isReconnecting(){return this.state.isReconnecting}get reconnectAttempts(){return this.state.reconnectAttempts}get reconnectDelay(){return this.state.reconnectDelay}setConnected(t){this.state.isConnected=t}setReconnecting(t){this.state.isReconnecting=t}incrementReconnectAttempts(){this.state.reconnectAttempts++}resetReconnectAttempts(){this.state.reconnectAttempts=0}updateReconnectDelay(t){this.state.reconnectDelay=t}reset(){this.state={isConnected:!1,isReconnecting:!1,reconnectAttempts:0,reconnectDelay:1e3}}getSnapshot(){return{...this.state}}}class yn{static createServerToolCall(t,n,r={}){return{toolName:t,callId:n,parameters:r}}static createReasoningCall(t,n,r){return{toolName:"reasoning",callId:t,parameters:{phase:n,...r}}}static createLatitudeToolCall(t,n,r={}){return{toolName:t,callId:n,parameters:r}}}class $i{constructor(t={}){B(this,"handlers",{});this.handlers=t}updateEventHandlers(t){Object.assign(this.handlers,t),this.onHandlersUpdated(t)}onHandlersUpdated(t){}getHandler(t){return this.handlers[t]}}const Z={THINKING_PREFIX:"THINKING:",REASONING_PREFIX:"REASONING:",THOUGHT_PREFIX:"THOUGHT:",COMPLETED_MARKER:"âœ… Completed:",ERROR_MARKER:"âŒ",HANDLING_MARKER:"ðŸ”§ Handling:",UI_TEXT:{AI_IS_THINKING:"AI is thinking",THINKING:"Thinking",THINKING_ELLIPSIS:"Thinking...",PROCESSING:"Processing",THOUGHT:"Thought"},MESSAGE_TYPES:{THINKING:"thinking",REASONING:"reasoning",THOUGHT:"thought",COMPLETED:"completed",ERROR:"error",PROCESSING:"processing"},PATTERNS:{DURATION:/for ([\d.]+) seconds/,THOUGHT_CONTENT:/\*\*(.*?)\*\*/g,HANDLING_TOOL:/ðŸ”§ Handling: (.+)/,COMPLETED_OR_ERROR_TOOL:/(?:âœ… Completed|âŒ Error): (.+?)(?:\s-\s|$)/}},Ee={isThinkingMessage:e=>e.startsWith(Z.THINKING_PREFIX)||e.startsWith(Z.REASONING_PREFIX)||e.startsWith(Z.THOUGHT_PREFIX),isCompletedMessage:e=>e.includes(Z.COMPLETED_MARKER),isErrorMessage:e=>e.includes(Z.ERROR_MARKER),isHandlingMessage:e=>e.includes(Z.HANDLING_MARKER),extractDuration:e=>{const t=e.match(Z.PATTERNS.DURATION);return t?` for ${t[1]} seconds`:void 0},cleanReasoningContent:e=>{let t=e.replace(new RegExp(`^${Z.THINKING_PREFIX}\\s*`),"").replace(new RegExp(`^${Z.REASONING_PREFIX}\\s*`),"").replace(new RegExp(`^${Z.THOUGHT_PREFIX}\\s*`),"");return t=t.replace(/\s*for [\d.]+\s*seconds$/,""),t=t.replace(Z.PATTERNS.THOUGHT_CONTENT,""),t.trim()},getMessageType:(e,t)=>t===!1?Ee.isErrorMessage(e)?Z.MESSAGE_TYPES.ERROR:(Ee.isThinkingMessage(e)&&e.includes("for")&&e.includes("seconds")||Ee.isThinkingMessage(e),Z.MESSAGE_TYPES.THOUGHT):Ee.isCompletedMessage(e)?Z.MESSAGE_TYPES.COMPLETED:Ee.isErrorMessage(e)?Z.MESSAGE_TYPES.ERROR:(Ee.isHandlingMessage(e)||Ee.isThinkingMessage(e)&&!e.includes(Z.UI_TEXT.AI_IS_THINKING),Z.MESSAGE_TYPES.THINKING)};class Ha extends $i{constructor(n){super({onReasoningUpdate:n});B(this,"reasoningStartTimes",new Map);B(this,"reasoningContent",new Map)}onHandlersUpdated(n){}triggerReasoningUpdate(n,r,i,s,a){const o=this.getHandler("onReasoningUpdate");if(!o)return;const c=yn.createReasoningCall(i,s,a||{});o(n,r,c)}handleReasoningStart(n){const r=n.id||"reasoning";this.reasoningStartTimes.set(r,Date.now()),this.reasoningContent.set(r,"")}handleReasoningDelta(n){if(!n.text)return;const r=n.id||"reasoning",s=(this.reasoningContent.get(r)||"")+n.text;this.reasoningContent.set(r,s);const a=`${Z.THINKING_PREFIX} ${s}`;this.triggerReasoningUpdate(!0,a,r,"thinking",{text:s})}handleReasoningEnd(n){const r=n.id||"reasoning",i=this.reasoningContent.get(r)||"",s=this.reasoningStartTimes.get(r);let a="";s&&(a=` for ${((Date.now()-s)/1e3).toFixed(0)} seconds`,this.reasoningStartTimes.delete(r));const o=i||Z.UI_TEXT.THOUGHT,c=`${Z.THOUGHT_PREFIX} ${o}${a}`;this.triggerReasoningUpdate(!1,c,r,"end",{duration:a,fullContent:i}),this.reasoningContent.delete(r)}setReasoningUpdateHandler(n){this.updateEventHandlers({onReasoningUpdate:n})}}class Fa extends $i{constructor(n={},r){super({onReasoningUpdate:r});B(this,"processedToolCalls",new Set);B(this,"clientTools",{});B(this,"sendMessage");this.clientTools=n}async handleToolCallRequest(n){var a,o,c;const{callId:r,toolName:i,parameters:s}=n;if(!this.processedToolCalls.has(r)){this.processedToolCalls.add(r),(a=this.getHandler("onReasoningUpdate"))==null||a(!0,`${Z.HANDLING_MARKER} ${i}`,n);try{const u=await this.executeToolFunction(i,s);this.sendToolResponse(r,u),(o=this.getHandler("onReasoningUpdate"))==null||o(!1,`${Z.COMPLETED_MARKER} ${i}`,n)}catch(u){this.sendToolError(r,u),(c=this.getHandler("onReasoningUpdate"))==null||c(!1,`${Z.ERROR_MARKER} Error: ${i} - ${u}`,n)}}}async executeToolFunction(n,r){const i=this.clientTools[n];if(!i)throw new Error(`Tool not found: ${n}`);return await i(r)}sendToolResponse(n,r){if(!this.sendMessage)return;const i=Et.serializeToolCallSuccess(n,r);this.sendMessage(i)}sendToolError(n,r){if(!this.sendMessage)return;const i=r instanceof Error?r.message:"Unknown error",s=Et.serializeToolCallError(n,i);this.sendMessage(s)}handleServerToolCall(n){var i;const r=this.getHandler("onReasoningUpdate");if(r&&((i=n.toolName)!=null&&i.startsWith("lat_"))&&n.toolCallId){const s=yn.createLatitudeToolCall(n.toolName,n.toolCallId,n.args||{});r(!0,`${Z.HANDLING_MARKER} ${n.toolName}`,s)}}handleServerToolResult(n){var i;const r=this.getHandler("onReasoningUpdate");if(r&&((i=n.toolName)!=null&&i.startsWith("lat_"))&&n.toolCallId){const s=yn.createLatitudeToolCall(n.toolName,n.toolCallId);r(!1,`${Z.COMPLETED_MARKER} ${n.toolName}`,s)}}clearProcessedToolCalls(){this.processedToolCalls.clear()}updateClientTools(n){this.clientTools={...this.clientTools,...n}}setSendMessageHandler(n){this.sendMessage=n}setReasoningUpdateHandler(n){this.updateEventHandlers({onReasoningUpdate:n})}}class Ua{constructor(t,n={}){B(this,"reasoningHandler");B(this,"toolHandler");B(this,"handlers");B(this,"sendMessage");this.handlers=t,this.reasoningHandler=new Ha(t.onReasoningUpdate),this.toolHandler=new Fa(n,t.onReasoningUpdate)}handleMessage(t){try{const n=JSON.parse(t.data);switch(n.type){case Me.SESSION_ESTABLISHED:this.handleSessionEstablished();break;case Me.TOOLS_CONFIGURED:this.handleToolsConfigured();break;case Me.CLIENT_TOOLS_UPDATED:this.handleClientToolsUpdated();break;case Me.CONFIGURE_TOOLS:this.handleConfigureToolsRequest();break;case Me.CHAT_EVENT:this.handleChatEvent(n);break;case Me.CHAT_FINISHED:this.handleChatFinished(n);break;case Me.CHAT_ERROR:this.handleChatError(n);break;case Me.TOOL_CALL_REQUEST:this.handleToolCallRequest(n);break;case Me.HEARTBEAT_PING:this.handleHeartbeatPing(n);break;case Me.HEARTBEAT_ACK:break;case Me.ERROR:this.handleError(n);break;default:break}return n}catch{return null}}handleSessionEstablished(){}handleToolsConfigured(){}handleClientToolsUpdated(){}handleConfigureToolsRequest(){}handleChatEvent(t){var n,r,i;switch(t.event){case gn.PROVIDER_EVENT:this.handleProviderEvent(t);break;case gn.LATITUDE_EVENT:this.handleLatitudeEvent(t);break;case gn.CONTENT_DELTA:(n=t.data)!=null&&n.delta&&((i=(r=this.handlers).onSetMessage)==null||i.call(r,t.data.delta));break}}handleProviderEvent(t){var r,i,s;switch((r=t.data)==null?void 0:r.type){case St.TEXT_DELTA:t.data.textDelta&&((s=(i=this.handlers).onSetMessage)==null||s.call(i,t.data.textDelta));break;case St.REASONING_START:this.reasoningHandler.handleReasoningStart(t.data);break;case St.REASONING_DELTA:this.reasoningHandler.handleReasoningDelta(t.data);break;case St.REASONING_END:this.reasoningHandler.handleReasoningEnd(t.data);break;case St.TOOL_CALL:this.toolHandler.handleServerToolCall(t.data);break;case St.TOOL_RESULT:this.toolHandler.handleServerToolResult(t.data);break}}handleLatitudeEvent(t){var n;if(((n=t.data)==null?void 0:n.type)===St.TOOL_RESULT&&this.handlers.onReasoningUpdate){const r=t.data;if(r.toolCallId&&r.toolName){const i=yn.createServerToolCall(r.toolName,r.toolCallId);this.handlers.onReasoningUpdate(!1,`${Z.COMPLETED_MARKER} ${r.toolName}`,i)}}}handleChatFinished(t){var n,r;(r=(n=this.handlers).onSystemEvent)==null||r.call(n,Ot.chatCompleted(t.uuid))}handleChatError(t){var n,r;(r=(n=this.handlers).onSystemEvent)==null||r.call(n,Ot.chatError(t.error||"Unknown error"))}handleToolCallRequest(t){this.toolHandler.handleToolCallRequest(t)}handleHeartbeatPing(t){if(!this.sendMessage)return;const n=Et.serializeHeartbeatPong(t.timestamp,t.pingTime);this.sendMessage(n)}handleError(t){var n,r;(r=(n=this.handlers).onSystemEvent)==null||r.call(n,Ot.chatError(t.error||"Unknown WebSocket error"))}updateClientTools(t){this.toolHandler.updateClientTools(t)}clearProcessedToolCalls(){this.toolHandler.clearProcessedToolCalls()}setSendMessageHandler(t){this.sendMessage=t,this.toolHandler.setSendMessageHandler(t)}updateEventHandlers(t){Object.assign(this.handlers,t),this.reasoningHandler.updateEventHandlers(t),this.toolHandler.updateEventHandlers(t)}}async function za(e,t){const n={"Content-Type":"application/json"};t!=null&&t.userMpAuthToken&&(n["x-oddle-mp-auth-token"]=t.userMpAuthToken),t!=null&&t.chatServerKey&&(n["x-oddle-chat-server-key"]=t.chatServerKey);try{const r=await fetch(`${e}/api/v1/tickets`,{method:"POST",headers:n,body:JSON.stringify({entityId:t.entityId,entityType:t.entityType,providerResId:t.providerResId,clientInfo:{userAgent:navigator.userAgent,timestamp:new Date().toISOString(),...t.clientInfo}})});if(!r.ok){const s=await r.json().catch(()=>({}));throw new Error(s.error||`Failed to get WebSocket ticket: ${r.statusText}`)}const i=await r.json();if(!i.success||!i.ticket)throw new Error(i.error||"Invalid ticket response from server");return i}catch(r){throw console.error("Error requesting WebSocket ticket:",r),r}}function Kn(e){if(!e.success||!e.ticket||!e.expiresAt)return!1;const t=new Date(e.expiresAt).getTime();return Date.now()<t-3e4}function Br(e){const t=Kn(e),n=new Date(e.expiresAt).getTime(),r=Date.now(),i=Math.max(0,Math.floor((n-r)/1e3));return{isValid:t,expiresIn:i,expired:r>=n}}class Ba{constructor(t,n,r={}){B(this,"ticket",null);B(this,"refreshPromise",null);B(this,"validationInterval",null);B(this,"authData");B(this,"apiUrl");B(this,"config");this.authData=t,this.apiUrl=this.convertToHttpUrl(n),this.config={checkInterval:r.checkInterval??6e4,renewalThreshold:r.renewalThreshold??300}}convertToHttpUrl(t){return t.replace(/^wss:\/\//,"https://").replace(/^ws:\/\//,"http://")}async getValidTicket(){return this.ticket&&Kn(this.ticket)?(console.log("TicketManager: Using existing valid ticket"),this.ticket.ticket):(console.log("TicketManager: No valid ticket, refreshing..."),this.refreshTicket())}async refreshTicket(){if(this.refreshPromise)return console.log("TicketManager: Refresh already in progress, waiting..."),this.refreshPromise;this.refreshPromise=this._doRefresh();try{return await this.refreshPromise}finally{this.refreshPromise=null}}async _doRefresh(){console.log("TicketManager: Requesting new ticket...",{apiUrl:this.apiUrl});try{return this.ticket=await za(this.apiUrl,this.authData),console.log("TicketManager: Ticket received successfully",{hasTicket:!!this.ticket.ticket,expiresAt:this.ticket.expiresAt}),this.ticket.ticket}catch(t){throw console.error("TicketManager: Failed to refresh ticket",t),new Error(`Ticket refresh failed: ${t instanceof Error?t.message:"Unknown error"}`)}}startProactiveRenewal(t){this.stopProactiveRenewal(),console.log("TicketManager: Starting proactive renewal",{checkInterval:this.config.checkInterval,renewalThreshold:this.config.renewalThreshold}),this.validationInterval=window.setInterval(async()=>{await this.checkAndRenew(t)},this.config.checkInterval)}async checkAndRenew(t){if(!this.ticket){console.warn("TicketManager: No ticket to validate");return}try{const r=Br(this.ticket).expiresIn/1e3;r<this.config.renewalThreshold&&(console.log(`TicketManager: Ticket expires in ${r.toFixed(0)}s, renewing...`),await this.refreshTicket(),console.log("TicketManager: Ticket renewed proactively"),t==null||t())}catch(n){console.error("TicketManager: Error during proactive renewal",n)}}stopProactiveRenewal(){this.validationInterval&&(clearInterval(this.validationInterval),this.validationInterval=null,console.log("TicketManager: Stopped proactive renewal"))}isValid(){return this.ticket?Kn(this.ticket):!1}getExpiresIn(){if(this.ticket)try{return Br(this.ticket).expiresIn}catch(t){console.warn("TicketManager: Error getting ticket info",t);return}}getExpiresAt(){var t;return(t=this.ticket)==null?void 0:t.expiresAt}updateAuthData(t){this.authData={...this.authData,...t},console.log("TicketManager: Auth data updated")}clear(){this.ticket=null,this.stopProactiveRenewal(),console.log("TicketManager: Ticket cleared")}getDebugInfo(){return{hasTicket:!!this.ticket,isValid:this.isValid(),expiresAt:this.getExpiresAt(),expiresIn:this.getExpiresIn(),isRefreshing:!!this.refreshPromise}}}class Wa{constructor(){B(this,"config");B(this,"connectionState");B(this,"wsManager");B(this,"messageHandler");B(this,"initResolve");B(this,"initReject");B(this,"toolSchemas",[]);B(this,"contextHelpers",{});B(this,"ticketManager",null);B(this,"authCredentials",{});this.config={...Da},this.connectionState=new Pa,this.wsManager=new ja(this.config,this.connectionState),this.messageHandler=new Ua({}),this.setupWebSocketHandlers()}setupWebSocketHandlers(){this.wsManager.setEventHandlers({onMessage:t=>this.handleWebSocketMessage(t),onOpen:()=>this.handleConnectionOpen(),onSystemEvent:t=>{var r,i;(i=(r=this.messageHandler.handlers)==null?void 0:r.onSystemEvent)==null||i.call(r,t)}}),this.messageHandler.setSendMessageHandler(t=>this.wsManager.send(t))}handleWebSocketMessage(t){var r,i,s,a;const n=this.messageHandler.handleMessage(t);if((n==null?void 0:n.type)==="authentication_error"&&(console.error("WebSocket authentication failed:",n==null?void 0:n.error,n==null?void 0:n.code),this.handleAuthenticationFailure(n)),(n==null?void 0:n.type)===Me.THREAD_CREATED){(i=(r=this.messageHandler.handlers)==null?void 0:r.onThreadCreated)==null||i.call(r,n.data);return}if((n==null?void 0:n.type)===Me.TOOLS_CONFIGURED){(s=this.initResolve)==null||s.call(this);return}if((n==null?void 0:n.type)===Me.SESSION_ESTABLISHED&&(this.toolSchemas&&this.toolSchemas.length>0?this.sendToolConfiguration():(a=this.initResolve)==null||a.call(this)),(n==null?void 0:n.type)===Me.SESSION_ESTABLISHED){const o=n==null?void 0:n.sessionId;o&&this.wsManager.updateSession(o)}}handleConnectionOpen(){console.log("WebSocket connection opened with ticket authentication")}handleAuthenticationFailure(t){var r,i;const n=t;console.error("Authentication failure details:",{error:n==null?void 0:n.error,code:n==null?void 0:n.code,hasTicket:((r=this.ticketManager)==null?void 0:r.isValid())??!1}),(n==null?void 0:n.code)==="TICKET_INVALID"||(n==null?void 0:n.code)==="TICKET_EXPIRED"?(console.log("Attempting to refresh ticket and reconnect..."),this.refreshTicketAndReconnect().catch(s=>{var a;console.error("Failed to refresh ticket:",s),(a=this.initReject)==null||a.call(this,s)})):(i=this.initReject)==null||i.call(this,new Error(`Authentication failed: ${n==null?void 0:n.error}`))}sendToolConfiguration(){const t=Et.serializeConfigureTools(this.toolSchemas,this.contextHelpers);this.wsManager.send(t)}async onInit(t){return this.setupEventHandlers(t),this.setupToolsAndContext(t),this.updateConfig(t),this.authCredentials={userMpAuthToken:t.userMpAuthToken,chatServerKey:t.chatServerKey},this.ticketManager=new Ba({userMpAuthToken:t.userMpAuthToken,chatServerKey:t.chatServerKey,entityId:t.entityId,entityType:t.entityType},this.config.apiUrl),new Promise(async(n,r)=>{this.initResolve=n,this.initReject=r;try{const i=await this.ticketManager.getValidTicket();await this.wsManager.connect(i)}catch(i){console.error("WebSocketChatClient: Initialization failed",i),r(i)}})}setupEventHandlers(t){const n={onSetMessage:t.onSetMessage,onSystemEvent:t.onSystemEvent,onReasoningUpdate:t.onReasoningUpdate,onThreadCreated:t.onThreadCreated};this.messageHandler.updateEventHandlers(n)}setupToolsAndContext(t){this.toolSchemas=t.toolSchemas||[],this.contextHelpers=t.contextHelpers,t.clientTools&&this.messageHandler.updateClientTools(t.clientTools)}updateConfig(t){t.chatServerUrl&&(this.config.apiUrl=t.chatServerUrl)}async onTriggerMessage(t){if(!this.connectionState.isConnected)throw new Error("Client not connected");const{message:n,media:r,providerResId:i}=t;try{this.messageHandler.clearProcessedToolCalls();const s=Et.serializeChatMessage({content:n,media:r,providerResId:i});this.wsManager.send(s)}catch(s){throw s}}disconnect(){var t,n;(t=this.ticketManager)==null||t.stopProactiveRenewal(),(n=this.ticketManager)==null||n.clear(),this.wsManager.disconnect()}isClientConnected(){return this.connectionState.isConnected}updateContextHelpers(t){this.contextHelpers={...this.contextHelpers,...t};const n=Et.serializeUpdateContextHelpers(this.contextHelpers);this.wsManager.send(n)}addClientTools(t,n){this.messageHandler.updateClientTools(t),n&&(this.toolSchemas=[...this.toolSchemas,...n]);const r=Et.serializeUpdateTools(this.toolSchemas);this.wsManager.send(r)}getConnectionStatus(){var t,n;return{connected:this.connectionState.isConnected,reconnectAttempts:this.connectionState.reconnectAttempts,isReconnecting:this.connectionState.isReconnecting,websocketState:this.wsManager.getWebSocketState(),hasValidTicket:((t=this.ticketManager)==null?void 0:t.isValid())??!1,ticketExpiresIn:(n=this.ticketManager)==null?void 0:n.getExpiresIn()}}async refreshTicketAndReconnect(){console.log("WebSocketChatClient: Refreshing ticket and reconnecting...");try{if(!this.ticketManager)throw new Error("TicketManager not initialized");this.wsManager.disconnect();const t=await this.ticketManager.refreshTicket();this.wsManager.updateTicket(t),await this.wsManager.connect(),console.log("WebSocketChatClient: Successfully refreshed ticket and reconnected")}catch(t){throw console.error("WebSocketChatClient: Failed to refresh ticket and reconnect:",t),t}}isTicketValid(){var t;return((t=this.ticketManager)==null?void 0:t.isValid())??!1}async reconnect(){console.log("WebSocketChatClient: Manual reconnection requested"),await this.refreshTicketAndReconnect()}async updateEntityId(t,n,r){if(!this.ticketManager)throw new Error("WebSocketChatClient: Cannot update entityId - TicketManager not initialized");console.log(`WebSocketChatClient: Updating entity attachment - providerResId: ${t}, entityId: ${n}, entityType: ${r}`);try{await cr(this.config.apiUrl,t,{entityId:n,entityType:r},this.authCredentials);const i={entityId:n,entityType:r};this.ticketManager.updateAuthData(i)}catch(i){throw console.error("WebSocketChatClient: Failed to update entity attachment:",i),i}}async updateMetadata(t,n){try{await ur(this.config.apiUrl,t,n,this.authCredentials),console.log("WebSocketChatClient: Thread metadata updated successfully")}catch(r){throw console.error("WebSocketChatClient: Failed to update thread metadata:",r),r}}}function Ga({userMpAuthToken:e,chatServerUrl:t,chatServerKey:n,entityId:r,entityType:i,tools:s,contextHelpers:a,onSetMessage:o,onSystemEvent:c,onReasoningUpdate:u,onThreadCreated:h}){const[p,g]=y.useState(null),[d,x]=y.useState(!1),[w,A]=y.useState(!1),[E,_]=y.useState(!1),[N,j]=y.useState(0),L=y.useRef(null),T=y.useRef(o),O=y.useRef(c),D=y.useRef(u),P=y.useRef(h);y.useEffect(()=>{T.current=o,O.current=c,D.current=u,P.current=h},[o,c,u,h]);const{toolSchemas:U,clientToolExecutors:M}=y.useMemo(()=>{if(s&&s.length>0){const F=s.map(({execute:X,...ie})=>ie),q={};return s.forEach(X=>{q[X.name]=X.execute}),{toolSchemas:F,clientToolExecutors:q}}return{toolSchemas:[],clientToolExecutors:{}}},[s]),b=y.useRef(),H=y.useCallback(async()=>{try{if(A(!0),!e)throw new Error("userMpAuthToken is required");if(!t)throw new Error("chatServerUrl is required");if(!n)throw new Error("chatServerKey is required");const F=new Wa;L.current=F,g(F);const q=a||{};await F.onInit({userMpAuthToken:e,chatServerUrl:t,chatServerKey:n,entityId:r,entityType:i==null?void 0:i.toString(),toolSchemas:U,clientTools:M,contextHelpers:q,onSetMessage:T.current,onSystemEvent:O.current,onReasoningUpdate:D.current,onThreadCreated:P.current}),x(!0)}catch(F){console.error("Error connecting WebSocketChatClient:",F),x(!1),setTimeout(()=>{var q;(L.current===null||!L.current.getConnectionStatus().connected)&&((q=b.current)==null||q.call(b))},2e3)}finally{A(!1)}},[e,t,n,r,i,U,M,a]),G=y.useCallback(()=>{L.current&&(L.current.disconnect(),L.current=null),g(null),x(!1)},[]);return b.current=H,y.useEffect(()=>(H(),()=>{G()}),[H,G]),y.useEffect(()=>{const F=setInterval(()=>{if(L.current){const q=L.current.getConnectionStatus();x(q.connected),_(q.isReconnecting),j(q.reconnectAttempts)}},1e3);return()=>clearInterval(F)},[]),{chatClient:p,isConnected:d,isConnecting:w,isReconnecting:E,reconnectAttempts:N,connectChatClient:H,disconnectChatClient:G}}/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:Zi,setPrototypeOf:Wr,isFrozen:Va,getPrototypeOf:$a,getOwnPropertyDescriptor:Za}=Object;let{freeze:Oe,seal:Xe,create:qn}=Object,{apply:Xn,construct:Yn}=typeof Reflect<"u"&&Reflect;Oe||(Oe=function(t){return t});Xe||(Xe=function(t){return t});Xn||(Xn=function(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return t.apply(n,i)});Yn||(Yn=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return new t(...r)});const un=De(Array.prototype.forEach),Ka=De(Array.prototype.lastIndexOf),Gr=De(Array.prototype.pop),Ut=De(Array.prototype.push),qa=De(Array.prototype.splice),mn=De(String.prototype.toLowerCase),Mn=De(String.prototype.toString),Nn=De(String.prototype.match),zt=De(String.prototype.replace),Xa=De(String.prototype.indexOf),Ya=De(String.prototype.trim),et=De(Object.prototype.hasOwnProperty),Le=De(RegExp.prototype.test),Bt=Ja(TypeError);function De(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Xn(e,t,r)}}function Ja(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Yn(e,n)}}function ee(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:mn;Wr&&Wr(e,null);let r=t.length;for(;r--;){let i=t[r];if(typeof i=="string"){const s=n(i);s!==i&&(Va(t)||(t[r]=s),i=s)}e[i]=!0}return e}function Qa(e){for(let t=0;t<e.length;t++)et(e,t)||(e[t]=null);return e}function gt(e){const t=qn(null);for(const[n,r]of Zi(e))et(e,n)&&(Array.isArray(r)?t[n]=Qa(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=gt(r):t[n]=r);return t}function Wt(e,t){for(;e!==null;){const r=Za(e,t);if(r){if(r.get)return De(r.get);if(typeof r.value=="function")return De(r.value)}e=$a(e)}function n(){return null}return n}const Vr=Oe(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ln=Oe(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),On=Oe(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),eo=Oe(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Dn=Oe(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),to=Oe(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),$r=Oe(["#text"]),Zr=Oe(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),jn=Oe(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Kr=Oe(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),hn=Oe(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),no=Xe(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ro=Xe(/<%[\w\W]*|[\w\W]*%>/gm),io=Xe(/\$\{[\w\W]*/gm),so=Xe(/^data-[\-\w.\u00B7-\uFFFF]+$/),ao=Xe(/^aria-[\-\w]+$/),Ki=Xe(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),oo=Xe(/^(?:\w+script|data):/i),lo=Xe(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),qi=Xe(/^html$/i),co=Xe(/^[a-z][.\w]*(-[.\w]+)+$/i);var qr=Object.freeze({__proto__:null,ARIA_ATTR:ao,ATTR_WHITESPACE:lo,CUSTOM_ELEMENT:co,DATA_ATTR:so,DOCTYPE_NAME:qi,ERB_EXPR:ro,IS_ALLOWED_URI:Ki,IS_SCRIPT_OR_DATA:oo,MUSTACHE_EXPR:no,TMPLIT_EXPR:io});const Gt={element:1,text:3,progressingInstruction:7,comment:8,document:9},uo=function(){return typeof window>"u"?null:window},ho=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return t.createPolicy(s,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},Xr=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Xi(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:uo();const t=W=>Xi(W);if(t.version="3.3.0",t.removed=[],!e||!e.document||e.document.nodeType!==Gt.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:o,Element:c,NodeFilter:u,NamedNodeMap:h=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:p,DOMParser:g,trustedTypes:d}=e,x=c.prototype,w=Wt(x,"cloneNode"),A=Wt(x,"remove"),E=Wt(x,"nextSibling"),_=Wt(x,"childNodes"),N=Wt(x,"parentNode");if(typeof a=="function"){const W=n.createElement("template");W.content&&W.content.ownerDocument&&(n=W.content.ownerDocument)}let j,L="";const{implementation:T,createNodeIterator:O,createDocumentFragment:D,getElementsByTagName:P}=n,{importNode:U}=r;let M=Xr();t.isSupported=typeof Zi=="function"&&typeof N=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:b,ERB_EXPR:H,TMPLIT_EXPR:G,DATA_ATTR:F,ARIA_ATTR:q,IS_SCRIPT_OR_DATA:X,ATTR_WHITESPACE:ie,CUSTOM_ELEMENT:ve}=qr;let{IS_ALLOWED_URI:f}=qr,Q=null;const ge=ee({},[...Vr,...Ln,...On,...Dn,...$r]);let m=null;const xe=ee({},[...Zr,...jn,...Kr,...hn]);let ne=Object.seal(qn(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),se=null,Te=null;const le=Object.seal(qn(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let $e=!0,ze=!0,nt=!1,_t=!0,Ye=!1,ut=!0,Be=!1,mt=!1,Ct=!1,Je=!1,rt=!1,it=!1,xt=!0,st=!1;const kt="user-content-";let bt=!0,ht=!1,S={},I=null;const V=ee({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let J=null;const te=ee({},["audio","video","img","source","image","track"]);let ye=null;const _e=ee({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),me="http://www.w3.org/1998/Math/MathML",je="http://www.w3.org/2000/svg",we="http://www.w3.org/1999/xhtml";let ue=we,Ze=!1,Ie=null;const nn=ee({},[me,je,we],Mn);let vt=ee({},["mi","mo","mn","ms","mtext"]),It=ee({},["annotation-xml"]);const rn=ee({},["title","style","font","a","script"]);let yt=null;const sn=["application/xhtml+xml","text/html"],an="text/html";let he=null,Rt=null;const on=n.createElement("form"),Ft=function(C){return C instanceof RegExp||C instanceof Function},k=function(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Rt&&Rt===C)){if((!C||typeof C!="object")&&(C={}),C=gt(C),yt=sn.indexOf(C.PARSER_MEDIA_TYPE)===-1?an:C.PARSER_MEDIA_TYPE,he=yt==="application/xhtml+xml"?Mn:mn,Q=et(C,"ALLOWED_TAGS")?ee({},C.ALLOWED_TAGS,he):ge,m=et(C,"ALLOWED_ATTR")?ee({},C.ALLOWED_ATTR,he):xe,Ie=et(C,"ALLOWED_NAMESPACES")?ee({},C.ALLOWED_NAMESPACES,Mn):nn,ye=et(C,"ADD_URI_SAFE_ATTR")?ee(gt(_e),C.ADD_URI_SAFE_ATTR,he):_e,J=et(C,"ADD_DATA_URI_TAGS")?ee(gt(te),C.ADD_DATA_URI_TAGS,he):te,I=et(C,"FORBID_CONTENTS")?ee({},C.FORBID_CONTENTS,he):V,se=et(C,"FORBID_TAGS")?ee({},C.FORBID_TAGS,he):gt({}),Te=et(C,"FORBID_ATTR")?ee({},C.FORBID_ATTR,he):gt({}),S=et(C,"USE_PROFILES")?C.USE_PROFILES:!1,$e=C.ALLOW_ARIA_ATTR!==!1,ze=C.ALLOW_DATA_ATTR!==!1,nt=C.ALLOW_UNKNOWN_PROTOCOLS||!1,_t=C.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ye=C.SAFE_FOR_TEMPLATES||!1,ut=C.SAFE_FOR_XML!==!1,Be=C.WHOLE_DOCUMENT||!1,Je=C.RETURN_DOM||!1,rt=C.RETURN_DOM_FRAGMENT||!1,it=C.RETURN_TRUSTED_TYPE||!1,Ct=C.FORCE_BODY||!1,xt=C.SANITIZE_DOM!==!1,st=C.SANITIZE_NAMED_PROPS||!1,bt=C.KEEP_CONTENT!==!1,ht=C.IN_PLACE||!1,f=C.ALLOWED_URI_REGEXP||Ki,ue=C.NAMESPACE||we,vt=C.MATHML_TEXT_INTEGRATION_POINTS||vt,It=C.HTML_INTEGRATION_POINTS||It,ne=C.CUSTOM_ELEMENT_HANDLING||{},C.CUSTOM_ELEMENT_HANDLING&&Ft(C.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ne.tagNameCheck=C.CUSTOM_ELEMENT_HANDLING.tagNameCheck),C.CUSTOM_ELEMENT_HANDLING&&Ft(C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ne.attributeNameCheck=C.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),C.CUSTOM_ELEMENT_HANDLING&&typeof C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ne.allowCustomizedBuiltInElements=C.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ye&&(ze=!1),rt&&(Je=!0),S&&(Q=ee({},$r),m=[],S.html===!0&&(ee(Q,Vr),ee(m,Zr)),S.svg===!0&&(ee(Q,Ln),ee(m,jn),ee(m,hn)),S.svgFilters===!0&&(ee(Q,On),ee(m,jn),ee(m,hn)),S.mathMl===!0&&(ee(Q,Dn),ee(m,Kr),ee(m,hn))),C.ADD_TAGS&&(typeof C.ADD_TAGS=="function"?le.tagCheck=C.ADD_TAGS:(Q===ge&&(Q=gt(Q)),ee(Q,C.ADD_TAGS,he))),C.ADD_ATTR&&(typeof C.ADD_ATTR=="function"?le.attributeCheck=C.ADD_ATTR:(m===xe&&(m=gt(m)),ee(m,C.ADD_ATTR,he))),C.ADD_URI_SAFE_ATTR&&ee(ye,C.ADD_URI_SAFE_ATTR,he),C.FORBID_CONTENTS&&(I===V&&(I=gt(I)),ee(I,C.FORBID_CONTENTS,he)),bt&&(Q["#text"]=!0),Be&&ee(Q,["html","head","body"]),Q.table&&(ee(Q,["tbody"]),delete se.tbody),C.TRUSTED_TYPES_POLICY){if(typeof C.TRUSTED_TYPES_POLICY.createHTML!="function")throw Bt('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof C.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Bt('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');j=C.TRUSTED_TYPES_POLICY,L=j.createHTML("")}else j===void 0&&(j=ho(d,i)),j!==null&&typeof L=="string"&&(L=j.createHTML(""));Oe&&Oe(C),Rt=C}},de=ee({},[...Ln,...On,...eo]),Se=ee({},[...Dn,...to]),Ce=function(C){let R=N(C);(!R||!R.tagName)&&(R={namespaceURI:ue,tagName:"template"});const z=mn(C.tagName),ce=mn(R.tagName);return Ie[C.namespaceURI]?C.namespaceURI===je?R.namespaceURI===we?z==="svg":R.namespaceURI===me?z==="svg"&&(ce==="annotation-xml"||vt[ce]):!!de[z]:C.namespaceURI===me?R.namespaceURI===we?z==="math":R.namespaceURI===je?z==="math"&&It[ce]:!!Se[z]:C.namespaceURI===we?R.namespaceURI===je&&!It[ce]||R.namespaceURI===me&&!vt[ce]?!1:!Se[z]&&(rn[z]||!de[z]):!!(yt==="application/xhtml+xml"&&Ie[C.namespaceURI]):!1},Re=function(C){Ut(t.removed,{element:C});try{N(C).removeChild(C)}catch{A(C)}},Qe=function(C,R){try{Ut(t.removed,{attribute:R.getAttributeNode(C),from:R})}catch{Ut(t.removed,{attribute:null,from:R})}if(R.removeAttribute(C),C==="is")if(Je||rt)try{Re(R)}catch{}else try{R.setAttribute(C,"")}catch{}},Mr=function(C){let R=null,z=null;if(Ct)C="<remove></remove>"+C;else{const pe=Nn(C,/^[\r\n\t ]+/);z=pe&&pe[0]}yt==="application/xhtml+xml"&&ue===we&&(C='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+C+"</body></html>");const ce=j?j.createHTML(C):C;if(ue===we)try{R=new g().parseFromString(ce,yt)}catch{}if(!R||!R.documentElement){R=T.createDocument(ue,"template",null);try{R.documentElement.innerHTML=Ze?L:ce}catch{}}const Ae=R.body||R.documentElement;return C&&z&&Ae.insertBefore(n.createTextNode(z),Ae.childNodes[0]||null),ue===we?P.call(R,Be?"html":"body")[0]:Be?R.documentElement:Ae},Nr=function(C){return O.call(C.ownerDocument||C,C,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null)},In=function(C){return C instanceof p&&(typeof C.nodeName!="string"||typeof C.textContent!="string"||typeof C.removeChild!="function"||!(C.attributes instanceof h)||typeof C.removeAttribute!="function"||typeof C.setAttribute!="function"||typeof C.namespaceURI!="string"||typeof C.insertBefore!="function"||typeof C.hasChildNodes!="function")},Lr=function(C){return typeof o=="function"&&C instanceof o};function dt(W,C,R){un(W,z=>{z.call(t,C,R,Rt)})}const Or=function(C){let R=null;if(dt(M.beforeSanitizeElements,C,null),In(C))return Re(C),!0;const z=he(C.nodeName);if(dt(M.uponSanitizeElement,C,{tagName:z,allowedTags:Q}),ut&&C.hasChildNodes()&&!Lr(C.firstElementChild)&&Le(/<[/\w!]/g,C.innerHTML)&&Le(/<[/\w!]/g,C.textContent)||C.nodeType===Gt.progressingInstruction||ut&&C.nodeType===Gt.comment&&Le(/<[/\w]/g,C.data))return Re(C),!0;if(!(le.tagCheck instanceof Function&&le.tagCheck(z))&&(!Q[z]||se[z])){if(!se[z]&&jr(z)&&(ne.tagNameCheck instanceof RegExp&&Le(ne.tagNameCheck,z)||ne.tagNameCheck instanceof Function&&ne.tagNameCheck(z)))return!1;if(bt&&!I[z]){const ce=N(C)||C.parentNode,Ae=_(C)||C.childNodes;if(Ae&&ce){const pe=Ae.length;for(let Pe=pe-1;Pe>=0;--Pe){const pt=w(Ae[Pe],!0);pt.__removalCount=(C.__removalCount||0)+1,ce.insertBefore(pt,E(C))}}}return Re(C),!0}return C instanceof c&&!Ce(C)||(z==="noscript"||z==="noembed"||z==="noframes")&&Le(/<\/no(script|embed|frames)/i,C.innerHTML)?(Re(C),!0):(Ye&&C.nodeType===Gt.text&&(R=C.textContent,un([b,H,G],ce=>{R=zt(R,ce," ")}),C.textContent!==R&&(Ut(t.removed,{element:C.cloneNode()}),C.textContent=R)),dt(M.afterSanitizeElements,C,null),!1)},Dr=function(C,R,z){if(xt&&(R==="id"||R==="name")&&(z in n||z in on))return!1;if(!(ze&&!Te[R]&&Le(F,R))){if(!($e&&Le(q,R))){if(!(le.attributeCheck instanceof Function&&le.attributeCheck(R,C))){if(!m[R]||Te[R]){if(!(jr(C)&&(ne.tagNameCheck instanceof RegExp&&Le(ne.tagNameCheck,C)||ne.tagNameCheck instanceof Function&&ne.tagNameCheck(C))&&(ne.attributeNameCheck instanceof RegExp&&Le(ne.attributeNameCheck,R)||ne.attributeNameCheck instanceof Function&&ne.attributeNameCheck(R,C))||R==="is"&&ne.allowCustomizedBuiltInElements&&(ne.tagNameCheck instanceof RegExp&&Le(ne.tagNameCheck,z)||ne.tagNameCheck instanceof Function&&ne.tagNameCheck(z))))return!1}else if(!ye[R]){if(!Le(f,zt(z,ie,""))){if(!((R==="src"||R==="xlink:href"||R==="href")&&C!=="script"&&Xa(z,"data:")===0&&J[C])){if(!(nt&&!Le(X,zt(z,ie,"")))){if(z)return!1}}}}}}}return!0},jr=function(C){return C!=="annotation-xml"&&Nn(C,ve)},Pr=function(C){dt(M.beforeSanitizeAttributes,C,null);const{attributes:R}=C;if(!R||In(C))return;const z={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:m,forceKeepAttr:void 0};let ce=R.length;for(;ce--;){const Ae=R[ce],{name:pe,namespaceURI:Pe,value:pt}=Ae,Nt=he(pe),Rn=pt;let ke=pe==="value"?Rn:Ya(Rn);if(z.attrName=Nt,z.attrValue=ke,z.keepAttr=!0,z.forceKeepAttr=void 0,dt(M.uponSanitizeAttribute,C,z),ke=z.attrValue,st&&(Nt==="id"||Nt==="name")&&(Qe(pe,C),ke=kt+ke),ut&&Le(/((--!?|])>)|<\/(style|title|textarea)/i,ke)){Qe(pe,C);continue}if(Nt==="attributename"&&Nn(ke,"href")){Qe(pe,C);continue}if(z.forceKeepAttr)continue;if(!z.keepAttr){Qe(pe,C);continue}if(!_t&&Le(/\/>/i,ke)){Qe(pe,C);continue}Ye&&un([b,H,G],Fr=>{ke=zt(ke,Fr," ")});const Hr=he(C.nodeName);if(!Dr(Hr,Nt,ke)){Qe(pe,C);continue}if(j&&typeof d=="object"&&typeof d.getAttributeType=="function"&&!Pe)switch(d.getAttributeType(Hr,Nt)){case"TrustedHTML":{ke=j.createHTML(ke);break}case"TrustedScriptURL":{ke=j.createScriptURL(ke);break}}if(ke!==Rn)try{Pe?C.setAttributeNS(Pe,pe,ke):C.setAttribute(pe,ke),In(C)?Re(C):Gr(t.removed)}catch{Qe(pe,C)}}dt(M.afterSanitizeAttributes,C,null)},ra=function W(C){let R=null;const z=Nr(C);for(dt(M.beforeSanitizeShadowDOM,C,null);R=z.nextNode();)dt(M.uponSanitizeShadowNode,R,null),Or(R),Pr(R),R.content instanceof s&&W(R.content);dt(M.afterSanitizeShadowDOM,C,null)};return t.sanitize=function(W){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},R=null,z=null,ce=null,Ae=null;if(Ze=!W,Ze&&(W="<!-->"),typeof W!="string"&&!Lr(W))if(typeof W.toString=="function"){if(W=W.toString(),typeof W!="string")throw Bt("dirty is not a string, aborting")}else throw Bt("toString is not a function");if(!t.isSupported)return W;if(mt||k(C),t.removed=[],typeof W=="string"&&(ht=!1),ht){if(W.nodeName){const pt=he(W.nodeName);if(!Q[pt]||se[pt])throw Bt("root node is forbidden and cannot be sanitized in-place")}}else if(W instanceof o)R=Mr("<!---->"),z=R.ownerDocument.importNode(W,!0),z.nodeType===Gt.element&&z.nodeName==="BODY"||z.nodeName==="HTML"?R=z:R.appendChild(z);else{if(!Je&&!Ye&&!Be&&W.indexOf("<")===-1)return j&&it?j.createHTML(W):W;if(R=Mr(W),!R)return Je?null:it?L:""}R&&Ct&&Re(R.firstChild);const pe=Nr(ht?W:R);for(;ce=pe.nextNode();)Or(ce),Pr(ce),ce.content instanceof s&&ra(ce.content);if(ht)return W;if(Je){if(rt)for(Ae=D.call(R.ownerDocument);R.firstChild;)Ae.appendChild(R.firstChild);else Ae=R;return(m.shadowroot||m.shadowrootmode)&&(Ae=U.call(r,Ae,!0)),Ae}let Pe=Be?R.outerHTML:R.innerHTML;return Be&&Q["!doctype"]&&R.ownerDocument&&R.ownerDocument.doctype&&R.ownerDocument.doctype.name&&Le(qi,R.ownerDocument.doctype.name)&&(Pe="<!DOCTYPE "+R.ownerDocument.doctype.name+`>
`+Pe),Ye&&un([b,H,G],pt=>{Pe=zt(Pe,pt," ")}),j&&it?j.createHTML(Pe):Pe},t.setConfig=function(){let W=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};k(W),mt=!0},t.clearConfig=function(){Rt=null,mt=!1},t.isValidAttribute=function(W,C,R){Rt||k({});const z=he(W),ce=he(C);return Dr(z,ce,R)},t.addHook=function(W,C){typeof C=="function"&&Ut(M[W],C)},t.removeHook=function(W,C){if(C!==void 0){const R=Ka(M[W],C);return R===-1?void 0:qa(M[W],R,1)[0]}return Gr(M[W])},t.removeHooks=function(W){M[W]=[]},t.removeAllHooks=function(){M=Xr()},t}var po=Xi();function fo(e){return[/javascript:/i,/data:.*base64/i,/vbscript:/i,/on\w+\s*=/i,/<script/i,/<iframe/i,/<object/i,/<embed/i,/<link/i,/<style/i].some(n=>n.test(e))}function wn(e,t=!1){return e}function go(e){return typeof e!="string"?"":e.replace(/[<>:"/\\|?*]/g,"_").replace(/\.\./g,"_").replace(/^\./,"_").trim().substring(0,255)}function Yr(e){if(typeof e!="string")return!1;try{const t=new URL(e);return!(!["http:","https:","data:"].includes(t.protocol)||fo(e))}catch{return!1}}function mo(){po.addHook("beforeSanitizeAttributes",e=>{if(["onclick","onload","onerror","onmouseover","onfocus"].forEach(n=>{e.hasAttribute(n)&&e.removeAttribute(n)}),e.hasAttribute("href")){const n=e.getAttribute("href");n&&!Yr(n)&&e.removeAttribute("href")}if(e.hasAttribute("src")){const n=e.getAttribute("src");n&&!Yr(n)&&e.removeAttribute("src")}})}mo();function Co(){const[e,t]=y.useState([]),n=y.useCallback(()=>Math.random().toString(36).substring(2)+Date.now().toString(36),[]),r=y.useCallback((a,o)=>{const u=wn(o,a==="assistant");t(h=>[...h,{id:n(),role:a,content:u,timestamp:new Date}])},[n]),i=y.useCallback((a,o)=>{t(c=>c.map(u=>u.id===a?{...u,...o}:u))},[]),s=y.useCallback((a,o,c)=>{t(u=>u.map(h=>h.id===a?{...h,content:o,isStreaming:c}:h))},[]);return{messages:e,setMessages:t,addMessage:r,updateMessage:i,updateMessageContent:s,generateId:n}}function xo(){const e=$(_=>_.isStreaming),t=$(_=>_.setIsStreaming),n=$(_=>_.isThinking),r=$(_=>_.setIsThinking),i=$(_=>_.streamingContent),s=$(_=>_.setStreamingContent),a=$(_=>_.isHandlingTool),o=$(_=>_.setIsHandlingTool),c=$(_=>_.startStreaming),u=$(_=>_.stopStreaming),h=$(_=>_.clearStreamingBuffers),p=$(_=>_.resetToolHandling),g=y.useRef(""),d=y.useMemo(()=>({get current(){return $.getState().currentAssistantMessageId},set current(_){$.getState().setCurrentAssistantMessageId(_)}}),[]),x=y.useCallback(_=>{_?c(_):(t(!0),r(!0),s("")),g.current=""},[c,t,r,s]),w=y.useCallback(()=>{u(),g.current=""},[u]),A=y.useCallback(()=>{p()},[p]),E=y.useCallback(()=>{h(),g.current=""},[h]);return{isStreaming:e,setIsStreaming:t,isThinking:n,setIsThinking:r,streamingContent:i,setStreamingContent:s,isHandlingTool:a,setIsHandlingTool:o,currentAssistantMessageIdRef:d,streamingContentRef:g,startStreaming:x,stopStreaming:w,resetToolHandling:A,clearStreamingBuffers:E}}function yo(){const e=y.useMemo(()=>(i,s)=>s===!1?Ee.isErrorMessage(i)?be.ERROR:be.COMPLETED:Ee.isCompletedMessage(i)?be.COMPLETED:Ee.isErrorMessage(i)?be.ERROR:be.PROCESSING,[]),t=y.useMemo(()=>i=>Ee.extractDuration(i),[]),n=y.useMemo(()=>i=>Ee.cleanReasoningContent(i),[]),r=y.useMemo(()=>(i,s)=>{switch(Ee.getMessageType(i,s)){case Z.MESSAGE_TYPES.ERROR:return"Error";case Z.MESSAGE_TYPES.COMPLETED:return"Completed";case Z.MESSAGE_TYPES.THOUGHT:return Z.UI_TEXT.THOUGHT;case Z.MESSAGE_TYPES.THINKING:default:return Z.UI_TEXT.THINKING_ELLIPSIS}},[]);return{getReasoningStatus:e,getReasoningDuration:t,getReasoningContentOnly:n,getReasoningTitle:r}}function wo(){const e=y.useMemo(()=>(n,r)=>r===!1?n.includes(Z.ERROR_MARKER)?"Tool Error":"Tool Completed":n.includes(Z.COMPLETED_MARKER)||n.includes("âœ…")?"Tool Completed":n.includes(Z.ERROR_MARKER)?"Tool Error":(n.includes(Z.HANDLING_MARKER),"Tool Processing..."),[]),t=y.useMemo(()=>(n,r)=>r===!1?n.includes(Z.ERROR_MARKER)?be.ERROR:be.COMPLETED:n.includes(Z.COMPLETED_MARKER)||n.includes("âœ…")?be.COMPLETED:n.includes(Z.ERROR_MARKER)?be.ERROR:be.PROCESSING,[]);return{getToolingTitle:e,getToolingStatus:t}}function So({setMessages:e,addMessage:t,updateMessageContent:n,generateId:r,setIsThinking:i,setIsStreaming:s,setStreamingContent:a,setIsHandlingTool:o,currentAssistantMessageIdRef:c,streamingContentRef:u,clearStreamingBuffers:h,resetToolHandling:p}){const g=y.useRef(new Map),d=y.useRef(new Map),x=y.useCallback(()=>{if(c.current&&u.current){const j=wn(u.current,!0);return n(c.current,j,!1),h(),!0}return!1},[c,u,n,h]),w=y.useCallback(j=>{const L=wn(j,!0);if(c.current)u.current+=L,a(u.current),n(c.current,u.current,!0);else{i(!1);const T=r();c.current=T,u.current=L,a(L);const O={id:T,role:"assistant",content:L,timestamp:new Date,isStreaming:!0};e(D=>[...D,O])}},[c,u,a,n,i,r,e]),A=y.useCallback((j,L,T)=>{const{callId:O}=T||{};if(o(j),!O)return;const D=Ee.isThinkingMessage(L)&&!L.includes("for")&&!L.includes("seconds"),P=Ee.isThinkingMessage(L)&&L.includes("for")&&L.includes("seconds"),U=Ee.isHandlingMessage(L),M=Ee.isCompletedMessage(L),b=Ee.isErrorMessage(L);if(D||P){const G=g.current.get(O);if(D&&!G){x();const F=r();g.current.set(O,F);const q={id:F,role:"reasoning",content:L,timestamp:new Date,isStreaming:!0};e(X=>[...X,q])}else P&&G?(n(G,L,!1),g.current.delete(O)):G&&D&&n(G,L,!0)}const H=d.current.get(O);if(U&&!H){x();const G=L.match(Z.PATTERNS.HANDLING_TOOL),F=G?G[1]:"Unknown Tool",q=r();d.current.set(O,q);const X={id:q,role:"tooling",content:L,timestamp:new Date,isStreaming:!0,toolData:{...T,toolName:F,callId:O,status:be.PROCESSING}};e(ie=>[...ie,X])}else if((M||b)&&H){const G=L.match(Z.PATTERNS.COMPLETED_OR_ERROR_TOOL),F=G?G[1]:"Unknown Tool";e(q=>q.map(X=>X.id===H?{...X,content:L,isStreaming:!1,toolData:{...X.toolData,toolName:F,status:b?be.ERROR:be.COMPLETED,callId:O??""}}:X)),d.current.delete(O)}else H&&j&&!M&&!b&&n(H,L,!0)},[o,x,r,e,n]),E=y.useCallback(()=>{s(!1),i(!1),x()},[s,i,x]),_=y.useCallback(j=>{console.error("Chat error:",j),s(!1),i(!1),x(),t("system",`âŒ Chat error: ${j}`)},[s,i,x,t]),N=y.useCallback(()=>{s(!1),i(!1),h(),p()},[s,i,h,p]);return{handleSetMessage:w,handleReasoningUpdate:A,handleChatFinished:E,handleChatError:_,stopGeneration:N,finalizeCurrentStreamingMessage:x}}function Eo(){const e=Co(),t=xo(),n=yo(),r=wo(),i=So({setMessages:e.setMessages,addMessage:e.addMessage,updateMessageContent:e.updateMessageContent,generateId:e.generateId,setIsThinking:t.setIsThinking,setIsStreaming:t.setIsStreaming,setStreamingContent:t.setStreamingContent,setIsHandlingTool:t.setIsHandlingTool,currentAssistantMessageIdRef:t.currentAssistantMessageIdRef,streamingContentRef:t.streamingContentRef,clearStreamingBuffers:t.clearStreamingBuffers,resetToolHandling:t.resetToolHandling});return{messages:e.messages,setMessages:e.setMessages,isStreaming:t.isStreaming,setIsStreaming:t.setIsStreaming,isThinking:t.isThinking,setIsThinking:t.setIsThinking,streamingContent:t.streamingContent,isHandlingTool:t.isHandlingTool,currentAssistantMessageIdRef:t.currentAssistantMessageIdRef,getReasoningStatus:n.getReasoningStatus,getReasoningDuration:n.getReasoningDuration,getReasoningContentOnly:n.getReasoningContentOnly,getReasoningTitle:n.getReasoningTitle,getToolingTitle:r.getToolingTitle,getToolingStatus:r.getToolingStatus,addMessage:e.addMessage,handleSetMessage:i.handleSetMessage,handleReasoningUpdate:i.handleReasoningUpdate,handleChatFinished:i.handleChatFinished,handleChatError:i.handleChatError,stopGeneration:i.stopGeneration,finalizeCurrentStreamingMessage:i.finalizeCurrentStreamingMessage}}function To({initialMode:e="sidebar"}){const t=$();return y.useEffect(()=>{e&&t.currentMode!==e&&t.setCurrentMode(e)},[e]),y.useEffect(()=>{if(typeof window>"u"||typeof document>"u")return;const n=r=>{r.key==="Escape"&&t.currentMode==="modal"&&t.isModalOpen&&t.closeModal()};if(t.currentMode==="modal"&&t.isModalOpen)return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)},[t.currentMode,t.isModalOpen,t.closeModal]),{isModalOpen:t.isModalOpen,setIsModalOpen:t.setIsModalOpen,isCollapsed:t.isCollapsed,setIsCollapsed:t.setIsCollapsed,currentMode:t.currentMode,setCurrentMode:t.setCurrentMode,chatStatus:t.chatStatus,setChatStatus:t.setChatStatus,streamingStatus:t.streamingStatus,setStreamingStatus:t.setStreamingStatus,isLoadingConversation:t.isLoadingConversation,setIsLoadingConversation:t.setIsLoadingConversation,conversationError:t.conversationError,setConversationError:t.setConversationError,currentThreadId:t.currentThreadId,setCurrentThreadId:t.setCurrentThreadId,providerResId:t.providerResId,setProviderResId:t.setProviderResId,isDevSettingsOpen:t.isDevSettingsOpen,setIsDevSettingsOpen:t.setIsDevSettingsOpen,openModal:t.openModal,closeModal:t.closeModal,toggleCollapse:t.toggleCollapse,toggleFullscreen:t.toggleFullscreen}}function _o({entityId:e,entityType:t,httpApiUrl:n,userMpAuthToken:r,chatServerKey:i,messages:s,setMessages:a,setIsLoadingConversation:o,setConversationError:c,setCurrentThreadId:u,setProviderResId:h,metadata:p}){const g=y.useRef(!1),d=async()=>{if(!e){console.log("useConversationLoader: No entityId provided, skipping history fetch");return}if(!p||typeof p=="object"&&Object.keys(p).length===0){console.log("useConversationLoader: No metadata provided (empty/undefined), skipping history fetch - starting fresh conversation");return}if(!n){console.error("httpApiUrl is required for conversation loading");return}if(!r){console.error("userMpAuthToken is required for conversation loading");return}if(!i){console.error("chatServerKey is required for conversation loading");return}if(!g.current&&!(s.length>0))try{o(!0),c(null),console.log("useConversationLoader: Fetching messages for entityId:",e,"entityType:",t);const w=await Gi(n,{entityId:e,entityType:t,metadata:p},{userMpAuthToken:r,chatServerKey:i});console.log(`useConversationLoader: Loaded ${w.messages.length} messages`),a(w.messages),w.threadId&&(console.log("useConversationLoader: Setting threadId from response:",w.threadId),u(w.threadId)),w.providerResId&&(console.log("useConversationLoader: Setting providerResId:",w.providerResId),h(w.providerResId)),g.current=!0}catch(w){console.error("âŒ Error loading conversation:",w),c(w instanceof Error?w.message:"Failed to load conversation"),g.current=!0}finally{o(!1)}};return y.useEffect(()=>{d()},[e,t,n,r,i,s.length,a,o,c,u,h,p]),{hasLoadedConversationRef:g,resetConversationLoader:()=>{console.log("useConversationLoader: Resetting loader state"),g.current=!1},reloadConversation:d}}function ko({metadata:e,chatClient:t,currentProviderResId:n,isLoadingConversation:r,messages:i=[],entityId:s,entityType:a}){const o=y.useRef(void 0),c=y.useRef(!1);return y.useEffect(()=>{if(r||!t)return;const u=!n&&i.length===0,h=!!n;if(u&&(!s||!a)||h&&!n)return;if(!c.current){c.current=!0,o.current=e;return}if(!(o.current!==e))return;if(!(e&&Object.keys(e).length>0)){o.current=e;return}u?o.current=e:h&&t.updateMetadata(n,{metadata:e}).then(()=>{o.current=e}).catch(d=>{console.error("[useMetadataSync] âŒ Failed to update existing thread metadata:",d)})},[e,n,t,r,i.length,s,a]),{lastMetadata:o.current,hasInitialized:c.current,isDraftState:!n&&i.length===0,isExistingThread:!!n}}class bo{constructor(t){B(this,"config");B(this,"defaultFolder","chat-uploads");B(this,"defaultMaxFileSize",10*1024*1024);this.config={folder:this.defaultFolder,maxFileSize:this.defaultMaxFileSize,...t}}async uploadFiles(t,n){const r=[],i=t.map(s=>({file:s,progress:0,status:"uploading"}));for(let s=0;s<t.length;s++){const a=t[s];try{this.validateFile(a),n&&(i[s].progress=0,n([...i]));const o=await this.uploadSingleFile(a,c=>{n&&(i[s].progress=c,n([...i]))});r.push(o),i[s].status="completed",i[s].progress=100}catch(o){console.error(`âŒ Upload failed for ${a.name}:`,o),i[s].status="error";const c=await this.handleUploadFallback(a);c&&r.push(c)}n&&n([...i])}return r}async uploadSingleFile(t,n){const r=new FormData;r.append("file",t),r.append("folder",this.config.folder||this.defaultFolder);const i=this.buildAuthHeaders();return new Promise((s,a)=>{const o=new XMLHttpRequest;o.upload.addEventListener("progress",c=>{if(c.lengthComputable&&n){const u=c.loaded/c.total*100;n(u)}}),o.addEventListener("load",async()=>{if(o.status>=200&&o.status<300)try{const c=JSON.parse(o.responseText),u=this.processUploadResult(t,c);s(u)}catch{a(new Error("Invalid response format"))}else a(new Error(`Upload failed with status ${o.status}`))}),o.addEventListener("error",()=>{a(new Error("Network error during upload"))}),o.open("POST",`${this.config.apiUrl}/api/v1/upload`),Object.entries(i).forEach(([c,u])=>{o.setRequestHeader(c,u)}),o.send(r)})}processUploadResult(t,n){return t.type.startsWith("image/")?n.url:`data:${t.type};name=${encodeURIComponent(n.fileName||t.name)};url=${encodeURIComponent(n.url)}`}async handleUploadFallback(t){if(t.type.startsWith("image/"))try{return await this.convertToBase64(t)}catch(n){return console.error("Base64 conversion failed:",n),null}else return`data:${t.type};name=${encodeURIComponent(t.name)};base64,placeholder`}convertToBase64(t){return new Promise((n,r)=>{const i=new FileReader;i.onload=()=>n(i.result),i.onerror=r,i.readAsDataURL(t)})}validateFile(t){if(t.size>(this.config.maxFileSize||this.defaultMaxFileSize))throw new Error(`File ${t.name} is too large. Maximum size is ${this.formatFileSize(this.config.maxFileSize||this.defaultMaxFileSize)}`);if(this.config.allowedTypes&&this.config.allowedTypes.length>0&&!this.config.allowedTypes.some(r=>t.type.startsWith(r)||t.name.toLowerCase().endsWith(r)))throw new Error(`File type ${t.type} is not allowed`)}buildAuthHeaders(){const t={};return this.config.userMpAuthToken&&(t["x-oddle-mp-auth-token"]=this.config.userMpAuthToken),this.config.chatServerKey&&(t["x-oddle-chat-server-key"]=this.config.chatServerKey),t}formatFileSize(t){if(t===0)return"0 Bytes";const n=1024,r=["Bytes","KB","MB","GB"],i=Math.floor(Math.log(t)/Math.log(n));return parseFloat((t/Math.pow(n,i)).toFixed(2))+" "+r[i]}updateConfig(t){this.config={...this.config,...t}}getConfig(){return{...this.config}}}class vo{constructor(t,n={}){B(this,"config");B(this,"chatClient");this.chatClient=t,this.config=n}canSubmit(t,n,r){return!!(t.trim()&&!n&&this.chatClient&&r)}createUserMessage(t,n){return{id:this.generateId(),role:"user",content:t.trim(),timestamp:new Date,media:n}}async submitMessage(t){const{message:n,media:r,providerResId:i}=t,s=this.createUserMessage(n,r);try{return await this.chatClient.onTriggerMessage({message:s.content,media:r,providerResId:i}),s}catch(a){throw this.handleError(a),a}}handleError(t){const n=t instanceof Error?t:new Error("Unknown error");console.error("Agent client send error:",n),this.config.onError&&this.config.onError(n)}generateId(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}createErrorMessage(t){return`Sorry, there was an error: ${t instanceof Error?t.message:"Unknown error"}`}}const Io={shouldShowBubble:(e,t,n)=>e==="modal"&&!t||(e==="sidebar"||e==="fullscreen")&&n,isCollapsedState:(e,t)=>(e==="sidebar"||e==="fullscreen")&&t,getBubbleTitle:(e,t)=>e==="modal"?`Open ${t}`:`Expand ${t}`,shouldShowHeader:e=>e!==!1,shouldShowMainHeader:(e,t,n)=>e===0&&!t&&!n,getContentAreaClass:(e,t,n)=>`chat-wrapper__content ${e===0&&!t&&!n?"chat-wrapper__content--empty":"chat-wrapper__content--with-messages"}`,shouldShowSuggestedPrompts:(e,t,n,r)=>e===0&&!t&&!n&&!!r},Yi={convertWebSocketToHttp:e=>e.replace(/^wss?:\/\//,t=>t==="wss://"?"https://":"http://"),isValidWebSocketUrl:e=>{try{const t=new URL(e);return t.protocol==="ws:"||t.protocol==="wss:"}catch{return!1}},isValidHttpUrl:e=>{try{const t=new URL(e);return t.protocol==="http:"||t.protocol==="https:"}catch{return!1}}},Ro={validateAuthProps:e=>{if(!e.userMpAuthToken)throw new Error("ChatWrapper: userMpAuthToken is required");if(!e.chatServerUrl)throw new Error("ChatWrapper: chatServerUrl is required");if(!e.chatServerKey)throw new Error("ChatWrapper: chatServerKey is required")},validateWebSocketUrl:e=>{if(!Yi.isValidWebSocketUrl(e))throw new Error(`Invalid WebSocket URL: ${e}. Must start with ws:// or wss://`)},validateMessageContent:e=>e.trim().length>0},Ji={buildClasses:(...e)=>e.filter(Boolean).join(" "),getContainerClasses:(e,t,n,r,i)=>Ji.buildClasses("chat-wrapper",`chat-wrapper--${e}`,t&&`chat-wrapper--${t}`,n&&`chat-wrapper--${n}`,r&&"chat-wrapper--collapsed",e==="embedded"&&i&&"chat-wrapper--constrained")},Qi={createChatError:(e,t,n)=>{const r=new Error(e);return r.code=t,r.originalError=n,r},isNetworkError:e=>e.message.includes("fetch")||e.message.includes("network")||e.message.includes("connection"),getUserFriendlyErrorMessage:e=>Qi.isNetworkError(e)?"Connection error. Please check your internet connection and try again.":e.message.includes("authentication")||e.message.includes("auth")?"Authentication error. Please refresh the page and try again.":e.message.includes("timeout")?"Request timed out. Please try again.":"An unexpected error occurred. Please try again."},ot={state:Io,url:Yi,validation:Ro,css:Ji,error:Qi};class Jr extends y.Component{constructor(n){super(n);B(this,"resetTimeoutId",null);B(this,"resetErrorBoundary",()=>{this.resetTimeoutId&&clearTimeout(this.resetTimeoutId),this.setState({hasError:!1,error:void 0,errorInfo:void 0})});B(this,"handleRetry",()=>{this.resetTimeoutId=window.setTimeout(()=>{this.resetErrorBoundary()},100)});this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){this.setState({error:n,errorInfo:r}),this.props.onError&&this.props.onError(n,r),console.error("ChatErrorBoundary caught an error:",n,r)}componentDidUpdate(n){const{resetOnPropsChange:r,resetKeys:i}=this.props,{hasError:s}=this.state;if(s&&r&&i){const a=n.resetKeys||[];i.some((c,u)=>c!==a[u])&&this.resetErrorBoundary()}}render(){const{hasError:n,error:r}=this.state,{children:i,fallback:s}=this.props;return n&&r?s?s(r,this.handleRetry):l.jsx("div",{className:"chat-wrapper__error-boundary",children:l.jsxs("div",{className:"chat-wrapper__error-content",children:[l.jsx("div",{className:"chat-wrapper__error-icon",children:"âš ï¸"}),l.jsx("h3",{className:"chat-wrapper__error-title",children:"Something went wrong"}),l.jsx("p",{className:"chat-wrapper__error-message",children:ot.error.getUserFriendlyErrorMessage(r)}),l.jsx("div",{className:"chat-wrapper__error-actions",children:l.jsx("button",{className:"chat-wrapper__error-retry",onClick:this.handleRetry,type:"button",children:"Try Again"})}),(()=>{try{return!1}catch{return!1}})()&&l.jsxs("details",{className:"chat-wrapper__error-details",children:[l.jsx("summary",{children:"Error Details (Development)"}),l.jsx("pre",{className:"chat-wrapper__error-stack",children:r.stack})]})]})}):i}}class Ao extends y.Component{constructor(n){super(n);B(this,"retryCount",0);B(this,"retryTimeoutId",null);B(this,"handleRetry",()=>{const{maxRetries:n=3,retryDelay:r=1e3,onRetry:i}=this.props;if(this.retryCount>=n){console.warn("Max retry attempts reached for WebSocket connection");return}this.setState({isRetrying:!0}),this.retryCount++,this.retryTimeoutId=window.setTimeout(()=>{this.setState({hasError:!1,error:void 0,isRetrying:!1}),i&&i()},r*this.retryCount)});B(this,"handleManualReset",()=>{this.retryCount=0,this.setState({hasError:!1,error:void 0,isRetrying:!1}),this.props.onRetry&&this.props.onRetry()});this.state={hasError:!1,isRetrying:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n){console.error("WebSocketErrorBoundary caught an error:",n),this.props.onError&&this.props.onError(n)}componentWillUnmount(){this.retryTimeoutId&&clearTimeout(this.retryTimeoutId)}render(){const{hasError:n,error:r,isRetrying:i}=this.state,{children:s,maxRetries:a=3}=this.props;return n&&r&&(r.message.includes("WebSocket")||r.message.includes("connection")||ot.error.isNetworkError(r))?l.jsx("div",{className:"chat-wrapper__websocket-error",children:l.jsxs("div",{className:"chat-wrapper__error-content",children:[l.jsx("div",{className:"chat-wrapper__error-icon",children:"ðŸ”Œ"}),l.jsx("h3",{className:"chat-wrapper__error-title",children:"Connection Error"}),l.jsx("p",{className:"chat-wrapper__error-message",children:"Unable to establish connection to the chat server."}),l.jsx("div",{className:"chat-wrapper__error-actions",children:i?l.jsxs("div",{className:"chat-wrapper__error-retrying",children:[l.jsx("span",{children:"Reconnecting..."}),l.jsx("div",{className:"chat-wrapper__spinner"})]}):l.jsxs(l.Fragment,{children:[this.retryCount<a&&l.jsxs("button",{className:"chat-wrapper__error-retry",onClick:this.handleRetry,type:"button",children:["Retry Connection (",a-this.retryCount," attempts left)"]}),l.jsx("button",{className:"chat-wrapper__error-reset",onClick:this.handleManualReset,type:"button",children:"Reset Connection"})]})}),(()=>{try{return!1}catch{return!1}})()&&l.jsxs("details",{className:"chat-wrapper__error-details",children:[l.jsx("summary",{children:"Error Details (Development)"}),l.jsx("pre",{className:"chat-wrapper__error-stack",children:r.stack})]})]})}):s}}class Mo extends y.Component{constructor(n){super(n);B(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0,failedFiles:void 0}),this.props.onRetry&&this.props.onRetry()});B(this,"handleDismiss",()=>{this.setState({hasError:!1,error:void 0,failedFiles:void 0})});this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n){console.error("FileUploadErrorBoundary caught an error:",n);const r=this.extractFailedFiles(n);this.setState({failedFiles:r}),this.props.onError&&this.props.onError(n,r)}extractFailedFiles(n){const r=/file[s]?\s*['":]?\s*([^,\n]+)/gi,i=n.message.match(r);return i?i.map(s=>s.replace(/file[s]?\s*['":]?\s*/i,"").trim()):[]}render(){const{hasError:n,error:r,failedFiles:i}=this.state,{children:s,allowRetry:a=!0}=this.props;return n&&r&&(r.message.includes("upload")||r.message.includes("file")||r.message.includes("attachment"))?l.jsx("div",{className:"chat-wrapper__file-upload-error",children:l.jsxs("div",{className:"chat-wrapper__error-content",children:[l.jsx("div",{className:"chat-wrapper__error-icon",children:"ðŸ“"}),l.jsx("h3",{className:"chat-wrapper__error-title",children:"File Upload Error"}),l.jsx("p",{className:"chat-wrapper__error-message",children:this.getFileUploadErrorMessage(r)}),i&&i.length>0&&l.jsxs("div",{className:"chat-wrapper__failed-files",children:[l.jsx("p",{className:"chat-wrapper__failed-files-title",children:"Failed files:"}),l.jsx("ul",{className:"chat-wrapper__failed-files-list",children:i.map((c,u)=>l.jsx("li",{className:"chat-wrapper__failed-file",children:c},u))})]}),l.jsxs("div",{className:"chat-wrapper__error-actions",children:[a&&l.jsx("button",{className:"chat-wrapper__error-retry",onClick:this.handleRetry,type:"button",children:"Try Again"}),l.jsx("button",{className:"chat-wrapper__error-dismiss",onClick:this.handleDismiss,type:"button",children:"Continue Without Files"})]}),(()=>{try{return!1}catch{return!1}})()&&l.jsxs("details",{className:"chat-wrapper__error-details",children:[l.jsx("summary",{children:"Error Details (Development)"}),l.jsx("pre",{className:"chat-wrapper__error-stack",children:r.stack})]})]})}):s}getFileUploadErrorMessage(n){return n.message.includes("size")||n.message.includes("large")?"File size is too large. Please try with smaller files.":n.message.includes("type")||n.message.includes("format")?"File type is not supported. Please try with different file types.":n.message.includes("network")||n.message.includes("connection")?"Network error during upload. Please check your connection and try again.":n.message.includes("timeout")?"Upload timed out. Please try again with smaller files or better connection.":"Failed to upload files. Please try again."}}const es=({className:e,onClick:t,size:n=24,color:r="currentColor"})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,onClick:t,style:{cursor:t?"pointer":"default"},children:[l.jsx("path",{d:"M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2ZM20 16H5.17L4 17.17V4H20V16Z",fill:r}),l.jsx("circle",{cx:"7",cy:"10",r:"1",fill:r}),l.jsx("circle",{cx:"12",cy:"10",r:"1",fill:r}),l.jsx("circle",{cx:"17",cy:"10",r:"1",fill:r})]}),ts=({className:e,onClick:t,size:n=20,color:r="currentColor"})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,onClick:t,style:{cursor:t?"pointer":"default"},children:l.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z",fill:r})}),ns=({className:e,onClick:t,size:n=20,color:r="currentColor",isFullscreen:i=!1})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,onClick:t,style:{cursor:t?"pointer":"default"},children:i?l.jsx("path",{d:"M8 3v3a2 2 0 01-2 2H3M21 8h-3a2 2 0 01-2-2V3M3 16h3a2 2 0 012 2v3M16 21v-3a2 2 0 012-2h3",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}):l.jsx("path",{d:"M7 14H5v5h5v-2M5 10V5h5v2M17 14h2v5h-5v-2M19 10V5h-5v2",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),rs=({className:e,onClick:t,size:n=20,color:r="currentColor"})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,onClick:t,style:{cursor:t?"pointer":"default"},children:l.jsx("path",{d:"M18 12l-3 3-3-3m-6 3l-3 3-3-3",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),hr=({className:e,onClick:t,size:n=16,color:r="currentColor"})=>l.jsx("svg",{width:n,height:n,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,onClick:t,style:{cursor:t?"pointer":"default"},children:l.jsx("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.488.488 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.484.484 0 00-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z",fill:r})}),is=({className:e,onClick:t,size:n=18,color:r="currentColor"})=>l.jsxs("svg",{width:n,height:n,viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e,onClick:t,style:{cursor:t?"pointer":"default"},children:[l.jsx("mask",{id:"mask0_444_23118",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"18",height:"18",children:l.jsx("rect",{width:"18",height:"18",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_444_23118)",children:l.jsx("path",{d:"M5.8498 13.4998C5.47855 13.4998 5.16074 13.3676 4.89637 13.1032C4.63199 12.8389 4.4998 12.5211 4.4998 12.1498V3.1498C4.4998 2.77855 4.63199 2.46074 4.89637 2.19637C5.16074 1.93199 5.47855 1.7998 5.8498 1.7998H14.8498C15.2211 1.7998 15.5389 1.93199 15.8032 2.19637C16.0676 2.46074 16.1998 2.77855 16.1998 3.1498V12.1498C16.1998 12.5211 16.0676 12.8389 15.8032 13.1032C15.5389 13.3676 15.2211 13.4998 14.8498 13.4998H5.8498ZM5.8498 12.1498H14.8498V3.1498H5.8498V12.1498ZM3.1498 16.1998C2.77855 16.1998 2.46074 16.0676 2.19637 15.8032C1.93199 15.5389 1.7998 15.2211 1.7998 14.8498V4.4998H3.1498V14.8498H13.4998V16.1998H3.1498Z",fill:r})})]}),No=({mode:e,headerName:t,bubbleText:n,showBubbleText:r=!0,onClick:i})=>{const s=e==="modal"?`Open ${t}`:`Expand ${t}`;return l.jsxs("button",{className:"chat-wrapper__bubble-button",onClick:i,title:s,children:[l.jsx(es,{className:"chat-wrapper__bubble-icon",size:24}),r&&l.jsx("span",{className:"chat-wrapper__bubble-text",children:n||"Chat"})]})},Lo=({headerName:e,mode:t,isCollapsed:n,isModalOpen:r,devMode:i=!1,onClose:s,onToggleFullscreen:a,onToggleCollapse:o,onOpenSettings:c})=>{const u=()=>t==="modal"&&r&&s?l.jsx("button",{className:"chat-wrapper__close-button",onClick:s,title:"Close chat",children:l.jsx(ts,{size:20})}):null,h=()=>{if((t==="sidebar"||t==="fullscreen")&&!n&&a){const d=t==="fullscreen";return l.jsx("button",{className:d?"chat-wrapper__minimize-button":"chat-wrapper__fullscreen-button",onClick:a,title:d?"Switch to sidebar":"Switch to fullscreen",children:l.jsx(ns,{size:20,isFullscreen:d})})}return null},p=()=>(t==="sidebar"||t==="fullscreen")&&!n&&o?l.jsx("button",{className:"chat-wrapper__collapse-button",onClick:o,title:"Collapse chat",children:l.jsx(rs,{size:20})}):null,g=()=>!i||!c?null:l.jsx("button",{className:"chat-wrapper__settings-button",onClick:c,title:"Developer Settings",children:l.jsx(hr,{size:16})});return l.jsxs("div",{className:"chat-wrapper__header",children:[l.jsx("div",{className:"chat-wrapper__title-area",children:l.jsx("h2",{className:"chat-wrapper__title",children:e})}),l.jsxs("div",{className:"chat-wrapper__header-controls",children:[g(),h(),p(),u()]})]})};function Oo(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const Do=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,jo=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Po={};function Qr(e,t){return(Po.jsx?jo:Do).test(e)}const Ho=/[ \t\n\f\r]/g;function Fo(e){return typeof e=="object"?e.type==="text"?ei(e.value):!1:ei(e)}function ei(e){return e.replace(Ho,"")===""}class Qt{constructor(t,n,r){this.normal=n,this.property=t,r&&(this.space=r)}}Qt.prototype.normal={};Qt.prototype.property={};Qt.prototype.space=void 0;function ss(e,t){const n={},r={};for(const i of e)Object.assign(n,i.property),Object.assign(r,i.normal);return new Qt(n,r,t)}function Jn(e){return e.toLowerCase()}class Ue{constructor(t,n){this.attribute=n,this.property=t}}Ue.prototype.attribute="";Ue.prototype.booleanish=!1;Ue.prototype.boolean=!1;Ue.prototype.commaOrSpaceSeparated=!1;Ue.prototype.commaSeparated=!1;Ue.prototype.defined=!1;Ue.prototype.mustUseProperty=!1;Ue.prototype.number=!1;Ue.prototype.overloadedBoolean=!1;Ue.prototype.property="";Ue.prototype.spaceSeparated=!1;Ue.prototype.space=void 0;let Uo=0;const Y=Mt(),fe=Mt(),Qn=Mt(),v=Mt(),ae=Mt(),Dt=Mt(),We=Mt();function Mt(){return 2**++Uo}const er=Object.freeze(Object.defineProperty({__proto__:null,boolean:Y,booleanish:fe,commaOrSpaceSeparated:We,commaSeparated:Dt,number:v,overloadedBoolean:Qn,spaceSeparated:ae},Symbol.toStringTag,{value:"Module"})),Pn=Object.keys(er);class dr extends Ue{constructor(t,n,r,i){let s=-1;if(super(t,n),ti(this,"space",i),typeof r=="number")for(;++s<Pn.length;){const a=Pn[s];ti(this,Pn[s],(r&er[a])===er[a])}}}dr.prototype.defined=!0;function ti(e,t,n){n&&(e[t]=n)}function Pt(e){const t={},n={};for(const[r,i]of Object.entries(e.properties)){const s=new dr(r,e.transform(e.attributes||{},r),i,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),t[r]=s,n[Jn(r)]=r,n[Jn(s.attribute)]=r}return new Qt(t,n,e.space)}const as=Pt({properties:{ariaActiveDescendant:null,ariaAtomic:fe,ariaAutoComplete:null,ariaBusy:fe,ariaChecked:fe,ariaColCount:v,ariaColIndex:v,ariaColSpan:v,ariaControls:ae,ariaCurrent:null,ariaDescribedBy:ae,ariaDetails:null,ariaDisabled:fe,ariaDropEffect:ae,ariaErrorMessage:null,ariaExpanded:fe,ariaFlowTo:ae,ariaGrabbed:fe,ariaHasPopup:null,ariaHidden:fe,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:ae,ariaLevel:v,ariaLive:null,ariaModal:fe,ariaMultiLine:fe,ariaMultiSelectable:fe,ariaOrientation:null,ariaOwns:ae,ariaPlaceholder:null,ariaPosInSet:v,ariaPressed:fe,ariaReadOnly:fe,ariaRelevant:null,ariaRequired:fe,ariaRoleDescription:ae,ariaRowCount:v,ariaRowIndex:v,ariaRowSpan:v,ariaSelected:fe,ariaSetSize:v,ariaSort:null,ariaValueMax:v,ariaValueMin:v,ariaValueNow:v,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function os(e,t){return t in e?e[t]:t}function ls(e,t){return os(e,t.toLowerCase())}const zo=Pt({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Dt,acceptCharset:ae,accessKey:ae,action:null,allow:null,allowFullScreen:Y,allowPaymentRequest:Y,allowUserMedia:Y,alt:null,as:null,async:Y,autoCapitalize:null,autoComplete:ae,autoFocus:Y,autoPlay:Y,blocking:ae,capture:null,charSet:null,checked:Y,cite:null,className:ae,cols:v,colSpan:null,content:null,contentEditable:fe,controls:Y,controlsList:ae,coords:v|Dt,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Y,defer:Y,dir:null,dirName:null,disabled:Y,download:Qn,draggable:fe,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Y,formTarget:null,headers:ae,height:v,hidden:Qn,high:v,href:null,hrefLang:null,htmlFor:ae,httpEquiv:ae,id:null,imageSizes:null,imageSrcSet:null,inert:Y,inputMode:null,integrity:null,is:null,isMap:Y,itemId:null,itemProp:ae,itemRef:ae,itemScope:Y,itemType:ae,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Y,low:v,manifest:null,max:null,maxLength:v,media:null,method:null,min:null,minLength:v,multiple:Y,muted:Y,name:null,nonce:null,noModule:Y,noValidate:Y,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Y,optimum:v,pattern:null,ping:ae,placeholder:null,playsInline:Y,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Y,referrerPolicy:null,rel:ae,required:Y,reversed:Y,rows:v,rowSpan:v,sandbox:ae,scope:null,scoped:Y,seamless:Y,selected:Y,shadowRootClonable:Y,shadowRootDelegatesFocus:Y,shadowRootMode:null,shape:null,size:v,sizes:null,slot:null,span:v,spellCheck:fe,src:null,srcDoc:null,srcLang:null,srcSet:null,start:v,step:null,style:null,tabIndex:v,target:null,title:null,translate:null,type:null,typeMustMatch:Y,useMap:null,value:fe,width:v,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:ae,axis:null,background:null,bgColor:null,border:v,borderColor:null,bottomMargin:v,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Y,declare:Y,event:null,face:null,frame:null,frameBorder:null,hSpace:v,leftMargin:v,link:null,longDesc:null,lowSrc:null,marginHeight:v,marginWidth:v,noResize:Y,noHref:Y,noShade:Y,noWrap:Y,object:null,profile:null,prompt:null,rev:null,rightMargin:v,rules:null,scheme:null,scrolling:fe,standby:null,summary:null,text:null,topMargin:v,valueType:null,version:null,vAlign:null,vLink:null,vSpace:v,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Y,disableRemotePlayback:Y,prefix:null,property:null,results:v,security:null,unselectable:null},space:"html",transform:ls}),Bo=Pt({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:We,accentHeight:v,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:v,amplitude:v,arabicForm:null,ascent:v,attributeName:null,attributeType:null,azimuth:v,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:v,by:null,calcMode:null,capHeight:v,className:ae,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:v,diffuseConstant:v,direction:null,display:null,dur:null,divisor:v,dominantBaseline:null,download:Y,dx:null,dy:null,edgeMode:null,editable:null,elevation:v,enableBackground:null,end:null,event:null,exponent:v,externalResourcesRequired:null,fill:null,fillOpacity:v,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Dt,g2:Dt,glyphName:Dt,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:v,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:v,horizOriginX:v,horizOriginY:v,id:null,ideographic:v,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:v,k:v,k1:v,k2:v,k3:v,k4:v,kernelMatrix:We,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:v,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:v,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:v,overlineThickness:v,paintOrder:null,panose1:null,path:null,pathLength:v,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:ae,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:v,pointsAtY:v,pointsAtZ:v,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:We,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:We,rev:We,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:We,requiredFeatures:We,requiredFonts:We,requiredFormats:We,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:v,specularExponent:v,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:v,strikethroughThickness:v,string:null,stroke:null,strokeDashArray:We,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:v,strokeOpacity:v,strokeWidth:null,style:null,surfaceScale:v,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:We,tabIndex:v,tableValues:null,target:null,targetX:v,targetY:v,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:We,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:v,underlineThickness:v,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:v,values:null,vAlphabetic:v,vMathematical:v,vectorEffect:null,vHanging:v,vIdeographic:v,version:null,vertAdvY:v,vertOriginX:v,vertOriginY:v,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:v,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:os}),cs=Pt({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),us=Pt({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:ls}),hs=Pt({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),Wo={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},Go=/[A-Z]/g,ni=/-[a-z]/g,Vo=/^data[-\w.:]+$/i;function $o(e,t){const n=Jn(t);let r=t,i=Ue;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&Vo.test(t)){if(t.charAt(4)==="-"){const s=t.slice(5).replace(ni,Ko);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=t.slice(4);if(!ni.test(s)){let a=s.replace(Go,Zo);a.charAt(0)!=="-"&&(a="-"+a),t="data"+a}}i=dr}return new i(r,t)}function Zo(e){return"-"+e.toLowerCase()}function Ko(e){return e.charAt(1).toUpperCase()}const qo=ss([as,zo,cs,us,hs],"html"),pr=ss([as,Bo,cs,us,hs],"svg");function Xo(e){return e.join(" ").trim()}var Sn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ds(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var fr={},ri=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,Yo=/\n/g,Jo=/^\s*/,Qo=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,el=/^:\s*/,tl=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,nl=/^[;\s]*/,rl=/^\s+|\s+$/g,il=`
`,ii="/",si="*",At="",sl="comment",al="declaration",ol=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,r=1;function i(x){var w=x.match(Yo);w&&(n+=w.length);var A=x.lastIndexOf(il);r=~A?x.length-A:r+x.length}function s(){var x={line:n,column:r};return function(w){return w.position=new a(x),u(),w}}function a(x){this.start=x,this.end={line:n,column:r},this.source=t.source}a.prototype.content=e;function o(x){var w=new Error(t.source+":"+n+":"+r+": "+x);if(w.reason=x,w.filename=t.source,w.line=n,w.column=r,w.source=e,!t.silent)throw w}function c(x){var w=x.exec(e);if(w){var A=w[0];return i(A),e=e.slice(A.length),w}}function u(){c(Jo)}function h(x){var w;for(x=x||[];w=p();)w!==!1&&x.push(w);return x}function p(){var x=s();if(!(ii!=e.charAt(0)||si!=e.charAt(1))){for(var w=2;At!=e.charAt(w)&&(si!=e.charAt(w)||ii!=e.charAt(w+1));)++w;if(w+=2,At===e.charAt(w-1))return o("End of comment missing");var A=e.slice(2,w-2);return r+=2,i(A),e=e.slice(w),r+=2,x({type:sl,comment:A})}}function g(){var x=s(),w=c(Qo);if(w){if(p(),!c(el))return o("property missing ':'");var A=c(tl),E=x({type:al,property:ai(w[0].replace(ri,At)),value:A?ai(A[0].replace(ri,At)):At});return c(nl),E}}function d(){var x=[];h(x);for(var w;w=g();)w!==!1&&(x.push(w),h(x));return x}return u(),d()};function ai(e){return e?e.replace(rl,At):At}var ll=Sn&&Sn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fr,"__esModule",{value:!0});fr.default=ul;var cl=ll(ol);function ul(e,t){var n=null;if(!e||typeof e!="string")return n;var r=(0,cl.default)(e),i=typeof t=="function";return r.forEach(function(s){if(s.type==="declaration"){var a=s.property,o=s.value;i?t(a,o,s):o&&(n=n||{},n[a]=o)}}),n}var _n={};Object.defineProperty(_n,"__esModule",{value:!0});_n.camelCase=void 0;var hl=/^--[a-zA-Z0-9_-]+$/,dl=/-([a-z])/g,pl=/^[^-]+$/,fl=/^-(webkit|moz|ms|o|khtml)-/,gl=/^-(ms)-/,ml=function(e){return!e||pl.test(e)||hl.test(e)},Cl=function(e,t){return t.toUpperCase()},oi=function(e,t){return"".concat(t,"-")},xl=function(e,t){return t===void 0&&(t={}),ml(e)?e:(e=e.toLowerCase(),t.reactCompat?e=e.replace(gl,oi):e=e.replace(fl,oi),e.replace(dl,Cl))};_n.camelCase=xl;var yl=Sn&&Sn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},wl=yl(fr),Sl=_n;function tr(e,t){var n={};return!e||typeof e!="string"||(0,wl.default)(e,function(r,i){r&&i&&(n[(0,Sl.camelCase)(r,t)]=i)}),n}tr.default=tr;var El=tr;const Tl=ds(El),ps=fs("end"),gr=fs("start");function fs(e){return t;function t(n){const r=n&&n.position&&n.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function _l(e){const t=gr(e),n=ps(e);if(t&&n)return{start:t,end:n}}function Zt(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?li(e.position):"start"in e||"end"in e?li(e):"line"in e||"column"in e?nr(e):""}function nr(e){return ci(e&&e.line)+":"+ci(e&&e.column)}function li(e){return nr(e&&e.start)+"-"+nr(e&&e.end)}function ci(e){return e&&typeof e=="number"?e:1}class Ne extends Error{constructor(t,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let i="",s={},a=!1;if(n&&("line"in n&&"column"in n?s={place:n}:"start"in n&&"end"in n?s={place:n}:"type"in n?s={ancestors:[n],place:n.position}:s={...n}),typeof t=="string"?i=t:!s.cause&&t&&(a=!0,i=t.message,s.cause=t),!s.ruleId&&!s.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?s.ruleId=r:(s.source=r.slice(0,c),s.ruleId=r.slice(c+1))}if(!s.place&&s.ancestors&&s.ancestors){const c=s.ancestors[s.ancestors.length-1];c&&(s.place=c.position)}const o=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=o?o.column:void 0,this.fatal=void 0,this.file="",this.message=i,this.line=o?o.line:void 0,this.name=Zt(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=a&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Ne.prototype.file="";Ne.prototype.name="";Ne.prototype.reason="";Ne.prototype.message="";Ne.prototype.stack="";Ne.prototype.column=void 0;Ne.prototype.line=void 0;Ne.prototype.ancestors=void 0;Ne.prototype.cause=void 0;Ne.prototype.fatal=void 0;Ne.prototype.place=void 0;Ne.prototype.ruleId=void 0;Ne.prototype.source=void 0;const mr={}.hasOwnProperty,kl=new Map,bl=/[A-Z]/g,vl=new Set(["table","tbody","thead","tfoot","tr"]),Il=new Set(["td","th"]),gs="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Rl(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=Pl(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=jl(n,t.jsx,t.jsxs)}const i={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?pr:qo,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},s=ms(i,e,void 0);return s&&typeof s!="string"?s:i.create(e,i.Fragment,{children:s||void 0},void 0)}function ms(e,t,n){if(t.type==="element")return Al(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return Ml(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return Ll(e,t,n);if(t.type==="mdxjsEsm")return Nl(e,t);if(t.type==="root")return Ol(e,t,n);if(t.type==="text")return Dl(e,t)}function Al(e,t,n){const r=e.schema;let i=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(i=pr,e.schema=i),e.ancestors.push(t);const s=xs(e,t.tagName,!1),a=Hl(e,t);let o=xr(e,t);return vl.has(t.tagName)&&(o=o.filter(function(c){return typeof c=="string"?!Fo(c):!0})),Cs(e,a,s,t),Cr(a,o),e.ancestors.pop(),e.schema=r,e.create(t,s,a,n)}function Ml(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}Jt(e,t.position)}function Nl(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);Jt(e,t.position)}function Ll(e,t,n){const r=e.schema;let i=r;t.name==="svg"&&r.space==="html"&&(i=pr,e.schema=i),e.ancestors.push(t);const s=t.name===null?e.Fragment:xs(e,t.name,!0),a=Fl(e,t),o=xr(e,t);return Cs(e,a,s,t),Cr(a,o),e.ancestors.pop(),e.schema=r,e.create(t,s,a,n)}function Ol(e,t,n){const r={};return Cr(r,xr(e,t)),e.create(t,e.Fragment,r,n)}function Dl(e,t){return t.value}function Cs(e,t,n,r){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=r)}function Cr(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function jl(e,t,n){return r;function r(i,s,a,o){const u=Array.isArray(a.children)?n:t;return o?u(s,a,o):u(s,a)}}function Pl(e,t){return n;function n(r,i,s,a){const o=Array.isArray(s.children),c=gr(r);return t(i,s,a,o,{columnNumber:c?c.column-1:void 0,fileName:e,lineNumber:c?c.line:void 0},void 0)}}function Hl(e,t){const n={};let r,i;for(i in t.properties)if(i!=="children"&&mr.call(t.properties,i)){const s=Ul(e,i,t.properties[i]);if(s){const[a,o]=s;e.tableCellAlignToStyle&&a==="align"&&typeof o=="string"&&Il.has(t.tagName)?r=o:n[a]=o}}if(r){const s=n.style||(n.style={});s[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function Fl(e,t){const n={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const s=r.data.estree.body[0];s.type;const a=s.expression;a.type;const o=a.properties[0];o.type,Object.assign(n,e.evaluater.evaluateExpression(o.argument))}else Jt(e,t.position);else{const i=r.name;let s;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const o=r.value.data.estree.body[0];o.type,s=e.evaluater.evaluateExpression(o.expression)}else Jt(e,t.position);else s=r.value===null?!0:r.value;n[i]=s}return n}function xr(e,t){const n=[];let r=-1;const i=e.passKeys?new Map:kl;for(;++r<t.children.length;){const s=t.children[r];let a;if(e.passKeys){const c=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(c){const u=i.get(c)||0;a=c+"-"+u,i.set(c,u+1)}}const o=ms(e,s,a);o!==void 0&&n.push(o)}return n}function Ul(e,t,n){const r=$o(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?Oo(n):Xo(n)),r.property==="style"){let i=typeof n=="object"?n:zl(e,String(n));return e.stylePropertyNameCase==="css"&&(i=Bl(i)),["style",i]}return[e.elementAttributeNameCase==="react"&&r.space?Wo[r.property]||r.property:r.attribute,n]}}function zl(e,t){try{return Tl(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const r=n,i=new Ne("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw i.file=e.filePath||void 0,i.url=gs+"#cannot-parse-style-attribute",i}}function xs(e,t,n){let r;if(!n)r={type:"Literal",value:t};else if(t.includes(".")){const i=t.split(".");let s=-1,a;for(;++s<i.length;){const o=Qr(i[s])?{type:"Identifier",name:i[s]}:{type:"Literal",value:i[s]};a=a?{type:"MemberExpression",object:a,property:o,computed:!!(s&&o.type==="Literal"),optional:!1}:o}r=a}else r=Qr(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const i=r.value;return mr.call(e.components,i)?e.components[i]:i}if(e.evaluater)return e.evaluater.evaluateExpression(r);Jt(e)}function Jt(e,t){const n=new Ne("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=gs+"#cannot-handle-mdx-estrees-without-createevaluater",n}function Bl(e){const t={};let n;for(n in e)mr.call(e,n)&&(t[Wl(n)]=e[n]);return t}function Wl(e){let t=e.replace(bl,Gl);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function Gl(e){return"-"+e.toLowerCase()}const Hn={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},Vl={};function $l(e,t){const n=Vl,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,i=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return ys(e,r,i)}function ys(e,t,n){if(Zl(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return ui(e.children,t,n)}return Array.isArray(e)?ui(e,t,n):""}function ui(e,t,n){const r=[];let i=-1;for(;++i<e.length;)r[i]=ys(e[i],t,n);return r.join("")}function Zl(e){return!!(e&&typeof e=="object")}const hi=document.createElement("i");function yr(e){const t="&"+e+";";hi.innerHTML=t;const n=hi.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function ct(e,t,n,r){const i=e.length;let s=0,a;if(t<0?t=-t>i?0:i+t:t=t>i?i:t,n=n>0?n:0,r.length<1e4)a=Array.from(r),a.unshift(t,n),e.splice(...a);else for(n&&e.splice(t,n);s<r.length;)a=r.slice(s,s+1e4),a.unshift(t,0),e.splice(...a),s+=1e4,t+=1e4}function qe(e,t){return e.length>0?(ct(e,e.length,0,t),e):t}const di={}.hasOwnProperty;function Kl(e){const t={};let n=-1;for(;++n<e.length;)ql(t,e[n]);return t}function ql(e,t){let n;for(n in t){const i=(di.call(e,n)?e[n]:void 0)||(e[n]={}),s=t[n];let a;if(s)for(a in s){di.call(i,a)||(i[a]=[]);const o=s[a];Xl(i[a],Array.isArray(o)?o:o?[o]:[])}}}function Xl(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);ct(e,0,0,r)}function ws(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"ï¿½":String.fromCodePoint(n)}function jt(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const lt=Tt(/[A-Za-z]/),Ve=Tt(/[\dA-Za-z]/),Yl=Tt(/[#-'*+\--9=?A-Z^-~]/);function rr(e){return e!==null&&(e<32||e===127)}const ir=Tt(/\d/),Jl=Tt(/[\dA-Fa-f]/),Ql=Tt(/[!-/:-@[-`{-~]/);function K(e){return e!==null&&e<-2}function Fe(e){return e!==null&&(e<0||e===32)}function re(e){return e===-2||e===-1||e===32}const ec=Tt(new RegExp("\\p{P}|\\p{S}","u")),tc=Tt(/\s/);function Tt(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function Ht(e){const t=[];let n=-1,r=0,i=0;for(;++n<e.length;){const s=e.charCodeAt(n);let a="";if(s===37&&Ve(e.charCodeAt(n+1))&&Ve(e.charCodeAt(n+2)))i=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(a=String.fromCharCode(s));else if(s>55295&&s<57344){const o=e.charCodeAt(n+1);s<56320&&o>56319&&o<57344?(a=String.fromCharCode(s,o),i=1):a="ï¿½"}else a=String.fromCharCode(s);a&&(t.push(e.slice(r,n),encodeURIComponent(a)),r=n+i+1,a=""),i&&(n+=i,i=0)}return t.join("")+e.slice(r)}function oe(e,t,n,r){const i=r?r-1:Number.POSITIVE_INFINITY;let s=0;return a;function a(c){return re(c)?(e.enter(n),o(c)):t(c)}function o(c){return re(c)&&s++<i?(e.consume(c),o):(e.exit(n),t(c))}}const nc={tokenize:rc};function rc(e){const t=e.attempt(this.parser.constructs.contentInitial,r,i);let n;return t;function r(o){if(o===null){e.consume(o);return}return e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),oe(e,t,"linePrefix")}function i(o){return e.enter("paragraph"),s(o)}function s(o){const c=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,a(o)}function a(o){if(o===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(o);return}return K(o)?(e.consume(o),e.exit("chunkText"),s):(e.consume(o),a)}}const ic={tokenize:sc},pi={tokenize:ac};function sc(e){const t=this,n=[];let r=0,i,s,a;return o;function o(N){if(r<n.length){const j=n[r];return t.containerState=j[1],e.attempt(j[0].continuation,c,u)(N)}return u(N)}function c(N){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,i&&_();const j=t.events.length;let L=j,T;for(;L--;)if(t.events[L][0]==="exit"&&t.events[L][1].type==="chunkFlow"){T=t.events[L][1].end;break}E(r);let O=j;for(;O<t.events.length;)t.events[O][1].end={...T},O++;return ct(t.events,L+1,0,t.events.slice(j)),t.events.length=O,u(N)}return o(N)}function u(N){if(r===n.length){if(!i)return g(N);if(i.currentConstruct&&i.currentConstruct.concrete)return x(N);t.interrupt=!!(i.currentConstruct&&!i._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(pi,h,p)(N)}function h(N){return i&&_(),E(r),g(N)}function p(N){return t.parser.lazy[t.now().line]=r!==n.length,a=t.now().offset,x(N)}function g(N){return t.containerState={},e.attempt(pi,d,x)(N)}function d(N){return r++,n.push([t.currentConstruct,t.containerState]),g(N)}function x(N){if(N===null){i&&_(),E(0),e.consume(N);return}return i=i||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:i,contentType:"flow",previous:s}),w(N)}function w(N){if(N===null){A(e.exit("chunkFlow"),!0),E(0),e.consume(N);return}return K(N)?(e.consume(N),A(e.exit("chunkFlow")),r=0,t.interrupt=void 0,o):(e.consume(N),w)}function A(N,j){const L=t.sliceStream(N);if(j&&L.push(null),N.previous=s,s&&(s.next=N),s=N,i.defineSkip(N.start),i.write(L),t.parser.lazy[N.start.line]){let T=i.events.length;for(;T--;)if(i.events[T][1].start.offset<a&&(!i.events[T][1].end||i.events[T][1].end.offset>a))return;const O=t.events.length;let D=O,P,U;for(;D--;)if(t.events[D][0]==="exit"&&t.events[D][1].type==="chunkFlow"){if(P){U=t.events[D][1].end;break}P=!0}for(E(r),T=O;T<t.events.length;)t.events[T][1].end={...U},T++;ct(t.events,D+1,0,t.events.slice(O)),t.events.length=T}}function E(N){let j=n.length;for(;j-- >N;){const L=n[j];t.containerState=L[1],L[0].exit.call(t,e)}n.length=N}function _(){i.write([null]),s=void 0,i=void 0,t.containerState._closeFlow=void 0}}function ac(e,t,n){return oe(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function fi(e){if(e===null||Fe(e)||tc(e))return 1;if(ec(e))return 2}function wr(e,t,n){const r=[];let i=-1;for(;++i<e.length;){const s=e[i].resolveAll;s&&!r.includes(s)&&(t=s(t,n),r.push(s))}return t}const sr={name:"attention",resolveAll:oc,tokenize:lc};function oc(e,t){let n=-1,r,i,s,a,o,c,u,h;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;c=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const p={...e[r][1].end},g={...e[n][1].start};gi(p,-c),gi(g,c),a={type:c>1?"strongSequence":"emphasisSequence",start:p,end:{...e[r][1].end}},o={type:c>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:g},s={type:c>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[n][1].start}},i={type:c>1?"strong":"emphasis",start:{...a.start},end:{...o.end}},e[r][1].end={...a.start},e[n][1].start={...o.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=qe(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=qe(u,[["enter",i,t],["enter",a,t],["exit",a,t],["enter",s,t]]),u=qe(u,wr(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),u=qe(u,[["exit",s,t],["enter",o,t],["exit",o,t],["exit",i,t]]),e[n][1].end.offset-e[n][1].start.offset?(h=2,u=qe(u,[["enter",e[n][1],t],["exit",e[n][1],t]])):h=0,ct(e,r-1,n-r+3,u),n=r+u.length-h-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function lc(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,i=fi(r);let s;return a;function a(c){return s=c,e.enter("attentionSequence"),o(c)}function o(c){if(c===s)return e.consume(c),o;const u=e.exit("attentionSequence"),h=fi(c),p=!h||h===2&&i||n.includes(c),g=!i||i===2&&h||n.includes(r);return u._open=!!(s===42?p:p&&(i||!g)),u._close=!!(s===42?g:g&&(h||!p)),t(c)}}function gi(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const cc={name:"autolink",tokenize:uc};function uc(e,t,n){let r=0;return i;function i(d){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s}function s(d){return lt(d)?(e.consume(d),a):d===64?n(d):u(d)}function a(d){return d===43||d===45||d===46||Ve(d)?(r=1,o(d)):u(d)}function o(d){return d===58?(e.consume(d),r=0,c):(d===43||d===45||d===46||Ve(d))&&r++<32?(e.consume(d),o):(r=0,u(d))}function c(d){return d===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):d===null||d===32||d===60||rr(d)?n(d):(e.consume(d),c)}function u(d){return d===64?(e.consume(d),h):Yl(d)?(e.consume(d),u):n(d)}function h(d){return Ve(d)?p(d):n(d)}function p(d){return d===46?(e.consume(d),r=0,h):d===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(d),e.exit("autolinkMarker"),e.exit("autolink"),t):g(d)}function g(d){if((d===45||Ve(d))&&r++<63){const x=d===45?g:p;return e.consume(d),x}return n(d)}}const kn={partial:!0,tokenize:hc};function hc(e,t,n){return r;function r(s){return re(s)?oe(e,i,"linePrefix")(s):i(s)}function i(s){return s===null||K(s)?t(s):n(s)}}const Ss={continuation:{tokenize:pc},exit:fc,name:"blockQuote",tokenize:dc};function dc(e,t,n){const r=this;return i;function i(a){if(a===62){const o=r.containerState;return o.open||(e.enter("blockQuote",{_container:!0}),o.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(a),e.exit("blockQuoteMarker"),s}return n(a)}function s(a){return re(a)?(e.enter("blockQuotePrefixWhitespace"),e.consume(a),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(a))}}function pc(e,t,n){const r=this;return i;function i(a){return re(a)?oe(e,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a):s(a)}function s(a){return e.attempt(Ss,t,n)(a)}}function fc(e){e.exit("blockQuote")}const Es={name:"characterEscape",tokenize:gc};function gc(e,t,n){return r;function r(s){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(s),e.exit("escapeMarker"),i}function i(s){return Ql(s)?(e.enter("characterEscapeValue"),e.consume(s),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(s)}}const Ts={name:"characterReference",tokenize:mc};function mc(e,t,n){const r=this;let i=0,s,a;return o;function o(p){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(p),e.exit("characterReferenceMarker"),c}function c(p){return p===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(p),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),s=31,a=Ve,h(p))}function u(p){return p===88||p===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(p),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,a=Jl,h):(e.enter("characterReferenceValue"),s=7,a=ir,h(p))}function h(p){if(p===59&&i){const g=e.exit("characterReferenceValue");return a===Ve&&!yr(r.sliceSerialize(g))?n(p):(e.enter("characterReferenceMarker"),e.consume(p),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return a(p)&&i++<s?(e.consume(p),h):n(p)}}const mi={partial:!0,tokenize:xc},Ci={concrete:!0,name:"codeFenced",tokenize:Cc};function Cc(e,t,n){const r=this,i={partial:!0,tokenize:L};let s=0,a=0,o;return c;function c(T){return u(T)}function u(T){const O=r.events[r.events.length-1];return s=O&&O[1].type==="linePrefix"?O[2].sliceSerialize(O[1],!0).length:0,o=T,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),h(T)}function h(T){return T===o?(a++,e.consume(T),h):a<3?n(T):(e.exit("codeFencedFenceSequence"),re(T)?oe(e,p,"whitespace")(T):p(T))}function p(T){return T===null||K(T)?(e.exit("codeFencedFence"),r.interrupt?t(T):e.check(mi,w,j)(T)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),g(T))}function g(T){return T===null||K(T)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),p(T)):re(T)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),oe(e,d,"whitespace")(T)):T===96&&T===o?n(T):(e.consume(T),g)}function d(T){return T===null||K(T)?p(T):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),x(T))}function x(T){return T===null||K(T)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),p(T)):T===96&&T===o?n(T):(e.consume(T),x)}function w(T){return e.attempt(i,j,A)(T)}function A(T){return e.enter("lineEnding"),e.consume(T),e.exit("lineEnding"),E}function E(T){return s>0&&re(T)?oe(e,_,"linePrefix",s+1)(T):_(T)}function _(T){return T===null||K(T)?e.check(mi,w,j)(T):(e.enter("codeFlowValue"),N(T))}function N(T){return T===null||K(T)?(e.exit("codeFlowValue"),_(T)):(e.consume(T),N)}function j(T){return e.exit("codeFenced"),t(T)}function L(T,O,D){let P=0;return U;function U(F){return T.enter("lineEnding"),T.consume(F),T.exit("lineEnding"),M}function M(F){return T.enter("codeFencedFence"),re(F)?oe(T,b,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(F):b(F)}function b(F){return F===o?(T.enter("codeFencedFenceSequence"),H(F)):D(F)}function H(F){return F===o?(P++,T.consume(F),H):P>=a?(T.exit("codeFencedFenceSequence"),re(F)?oe(T,G,"whitespace")(F):G(F)):D(F)}function G(F){return F===null||K(F)?(T.exit("codeFencedFence"),O(F)):D(F)}}}function xc(e,t,n){const r=this;return i;function i(a){return a===null?n(a):(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),s)}function s(a){return r.parser.lazy[r.now().line]?n(a):t(a)}}const Fn={name:"codeIndented",tokenize:wc},yc={partial:!0,tokenize:Sc};function wc(e,t,n){const r=this;return i;function i(u){return e.enter("codeIndented"),oe(e,s,"linePrefix",5)(u)}function s(u){const h=r.events[r.events.length-1];return h&&h[1].type==="linePrefix"&&h[2].sliceSerialize(h[1],!0).length>=4?a(u):n(u)}function a(u){return u===null?c(u):K(u)?e.attempt(yc,a,c)(u):(e.enter("codeFlowValue"),o(u))}function o(u){return u===null||K(u)?(e.exit("codeFlowValue"),a(u)):(e.consume(u),o)}function c(u){return e.exit("codeIndented"),t(u)}}function Sc(e,t,n){const r=this;return i;function i(a){return r.parser.lazy[r.now().line]?n(a):K(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),i):oe(e,s,"linePrefix",5)(a)}function s(a){const o=r.events[r.events.length-1];return o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(a):K(a)?i(a):n(a)}}const Ec={name:"codeText",previous:_c,resolve:Tc,tokenize:kc};function Tc(e){let t=e.length-4,n=3,r,i;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)i===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(i=r):(r===t||e[r][1].type==="lineEnding")&&(e[i][1].type="codeTextData",r!==i+2&&(e[i][1].end=e[r-1][1].end,e.splice(i+2,r-i-2),t-=r-i-2,r=i+2),i=void 0);return e}function _c(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function kc(e,t,n){let r=0,i,s;return a;function a(p){return e.enter("codeText"),e.enter("codeTextSequence"),o(p)}function o(p){return p===96?(e.consume(p),r++,o):(e.exit("codeTextSequence"),c(p))}function c(p){return p===null?n(p):p===32?(e.enter("space"),e.consume(p),e.exit("space"),c):p===96?(s=e.enter("codeTextSequence"),i=0,h(p)):K(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),c):(e.enter("codeTextData"),u(p))}function u(p){return p===null||p===32||p===96||K(p)?(e.exit("codeTextData"),c(p)):(e.consume(p),u)}function h(p){return p===96?(e.consume(p),i++,h):i===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(p)):(s.type="codeTextData",u(p))}}class bc{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,n,r){const i=n||0;this.setCursor(Math.trunc(t));const s=this.right.splice(this.right.length-i,Number.POSITIVE_INFINITY);return r&&Vt(this.left,r),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),Vt(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),Vt(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);Vt(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);Vt(this.left,n.reverse())}}}function Vt(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function _s(e){const t={};let n=-1,r,i,s,a,o,c,u;const h=new bc(e);for(;++n<h.length;){for(;n in t;)n=t[n];if(r=h.get(n),n&&r[1].type==="chunkFlow"&&h.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,s=0,s<c.length&&c[s][1].type==="lineEndingBlank"&&(s+=2),s<c.length&&c[s][1].type==="content"))for(;++s<c.length&&c[s][1].type!=="content";)c[s][1].type==="chunkText"&&(c[s][1]._isInFirstContentOfListItem=!0,s++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,vc(h,n)),n=t[n],u=!0);else if(r[1]._container){for(s=n,i=void 0;s--;)if(a=h.get(s),a[1].type==="lineEnding"||a[1].type==="lineEndingBlank")a[0]==="enter"&&(i&&(h.get(i)[1].type="lineEndingBlank"),a[1].type="lineEnding",i=s);else if(!(a[1].type==="linePrefix"||a[1].type==="listItemIndent"))break;i&&(r[1].end={...h.get(i)[1].start},o=h.slice(i,n),o.unshift(r),h.splice(i,n-i+1,o))}}return ct(e,0,Number.POSITIVE_INFINITY,h.slice(0)),!u}function vc(e,t){const n=e.get(t)[1],r=e.get(t)[2];let i=t-1;const s=[];let a=n._tokenizer;a||(a=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const o=a.events,c=[],u={};let h,p,g=-1,d=n,x=0,w=0;const A=[w];for(;d;){for(;e.get(++i)[1]!==d;);s.push(i),d._tokenizer||(h=r.sliceStream(d),d.next||h.push(null),p&&a.defineSkip(d.start),d._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(h),d._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),p=d,d=d.next}for(d=n;++g<o.length;)o[g][0]==="exit"&&o[g-1][0]==="enter"&&o[g][1].type===o[g-1][1].type&&o[g][1].start.line!==o[g][1].end.line&&(w=g+1,A.push(w),d._tokenizer=void 0,d.previous=void 0,d=d.next);for(a.events=[],d?(d._tokenizer=void 0,d.previous=void 0):A.pop(),g=A.length;g--;){const E=o.slice(A[g],A[g+1]),_=s.pop();c.push([_,_+E.length-1]),e.splice(_,2,E)}for(c.reverse(),g=-1;++g<c.length;)u[x+c[g][0]]=x+c[g][1],x+=c[g][1]-c[g][0]-1;return u}const Ic={resolve:Ac,tokenize:Mc},Rc={partial:!0,tokenize:Nc};function Ac(e){return _s(e),e}function Mc(e,t){let n;return r;function r(o){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),i(o)}function i(o){return o===null?s(o):K(o)?e.check(Rc,a,s)(o):(e.consume(o),i)}function s(o){return e.exit("chunkContent"),e.exit("content"),t(o)}function a(o){return e.consume(o),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,i}}function Nc(e,t,n){const r=this;return i;function i(a){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),oe(e,s,"linePrefix")}function s(a){if(a===null||K(a))return n(a);const o=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&o&&o[1].type==="linePrefix"&&o[2].sliceSerialize(o[1],!0).length>=4?t(a):e.interrupt(r.parser.constructs.flow,n,t)(a)}}function ks(e,t,n,r,i,s,a,o,c){const u=c||Number.POSITIVE_INFINITY;let h=0;return p;function p(E){return E===60?(e.enter(r),e.enter(i),e.enter(s),e.consume(E),e.exit(s),g):E===null||E===32||E===41||rr(E)?n(E):(e.enter(r),e.enter(a),e.enter(o),e.enter("chunkString",{contentType:"string"}),w(E))}function g(E){return E===62?(e.enter(s),e.consume(E),e.exit(s),e.exit(i),e.exit(r),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),d(E))}function d(E){return E===62?(e.exit("chunkString"),e.exit(o),g(E)):E===null||E===60||K(E)?n(E):(e.consume(E),E===92?x:d)}function x(E){return E===60||E===62||E===92?(e.consume(E),d):d(E)}function w(E){return!h&&(E===null||E===41||Fe(E))?(e.exit("chunkString"),e.exit(o),e.exit(a),e.exit(r),t(E)):h<u&&E===40?(e.consume(E),h++,w):E===41?(e.consume(E),h--,w):E===null||E===32||E===40||rr(E)?n(E):(e.consume(E),E===92?A:w)}function A(E){return E===40||E===41||E===92?(e.consume(E),w):w(E)}}function bs(e,t,n,r,i,s){const a=this;let o=0,c;return u;function u(d){return e.enter(r),e.enter(i),e.consume(d),e.exit(i),e.enter(s),h}function h(d){return o>999||d===null||d===91||d===93&&!c||d===94&&!o&&"_hiddenFootnoteSupport"in a.parser.constructs?n(d):d===93?(e.exit(s),e.enter(i),e.consume(d),e.exit(i),e.exit(r),t):K(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),h):(e.enter("chunkString",{contentType:"string"}),p(d))}function p(d){return d===null||d===91||d===93||K(d)||o++>999?(e.exit("chunkString"),h(d)):(e.consume(d),c||(c=!re(d)),d===92?g:p)}function g(d){return d===91||d===92||d===93?(e.consume(d),o++,p):p(d)}}function vs(e,t,n,r,i,s){let a;return o;function o(g){return g===34||g===39||g===40?(e.enter(r),e.enter(i),e.consume(g),e.exit(i),a=g===40?41:g,c):n(g)}function c(g){return g===a?(e.enter(i),e.consume(g),e.exit(i),e.exit(r),t):(e.enter(s),u(g))}function u(g){return g===a?(e.exit(s),c(a)):g===null?n(g):K(g)?(e.enter("lineEnding"),e.consume(g),e.exit("lineEnding"),oe(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),h(g))}function h(g){return g===a||g===null||K(g)?(e.exit("chunkString"),u(g)):(e.consume(g),g===92?p:h)}function p(g){return g===a||g===92?(e.consume(g),h):h(g)}}function Kt(e,t){let n;return r;function r(i){return K(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),n=!0,r):re(i)?oe(e,r,n?"linePrefix":"lineSuffix")(i):t(i)}}const Lc={name:"definition",tokenize:Dc},Oc={partial:!0,tokenize:jc};function Dc(e,t,n){const r=this;let i;return s;function s(d){return e.enter("definition"),a(d)}function a(d){return bs.call(r,e,o,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(d)}function o(d){return i=jt(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),d===58?(e.enter("definitionMarker"),e.consume(d),e.exit("definitionMarker"),c):n(d)}function c(d){return Fe(d)?Kt(e,u)(d):u(d)}function u(d){return ks(e,h,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(d)}function h(d){return e.attempt(Oc,p,p)(d)}function p(d){return re(d)?oe(e,g,"whitespace")(d):g(d)}function g(d){return d===null||K(d)?(e.exit("definition"),r.parser.defined.push(i),t(d)):n(d)}}function jc(e,t,n){return r;function r(o){return Fe(o)?Kt(e,i)(o):n(o)}function i(o){return vs(e,s,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(o)}function s(o){return re(o)?oe(e,a,"whitespace")(o):a(o)}function a(o){return o===null||K(o)?t(o):n(o)}}const Pc={name:"hardBreakEscape",tokenize:Hc};function Hc(e,t,n){return r;function r(s){return e.enter("hardBreakEscape"),e.consume(s),i}function i(s){return K(s)?(e.exit("hardBreakEscape"),t(s)):n(s)}}const Fc={name:"headingAtx",resolve:Uc,tokenize:zc};function Uc(e,t){let n=e.length-2,r=3,i,s;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(i={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},s={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},ct(e,r,n-r+1,[["enter",i,t],["enter",s,t],["exit",s,t],["exit",i,t]])),e}function zc(e,t,n){let r=0;return i;function i(h){return e.enter("atxHeading"),s(h)}function s(h){return e.enter("atxHeadingSequence"),a(h)}function a(h){return h===35&&r++<6?(e.consume(h),a):h===null||Fe(h)?(e.exit("atxHeadingSequence"),o(h)):n(h)}function o(h){return h===35?(e.enter("atxHeadingSequence"),c(h)):h===null||K(h)?(e.exit("atxHeading"),t(h)):re(h)?oe(e,o,"whitespace")(h):(e.enter("atxHeadingText"),u(h))}function c(h){return h===35?(e.consume(h),c):(e.exit("atxHeadingSequence"),o(h))}function u(h){return h===null||h===35||Fe(h)?(e.exit("atxHeadingText"),o(h)):(e.consume(h),u)}}const Bc=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],xi=["pre","script","style","textarea"],Wc={concrete:!0,name:"htmlFlow",resolveTo:$c,tokenize:Zc},Gc={partial:!0,tokenize:qc},Vc={partial:!0,tokenize:Kc};function $c(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function Zc(e,t,n){const r=this;let i,s,a,o,c;return u;function u(m){return h(m)}function h(m){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(m),p}function p(m){return m===33?(e.consume(m),g):m===47?(e.consume(m),s=!0,w):m===63?(e.consume(m),i=3,r.interrupt?t:f):lt(m)?(e.consume(m),a=String.fromCharCode(m),A):n(m)}function g(m){return m===45?(e.consume(m),i=2,d):m===91?(e.consume(m),i=5,o=0,x):lt(m)?(e.consume(m),i=4,r.interrupt?t:f):n(m)}function d(m){return m===45?(e.consume(m),r.interrupt?t:f):n(m)}function x(m){const xe="CDATA[";return m===xe.charCodeAt(o++)?(e.consume(m),o===xe.length?r.interrupt?t:b:x):n(m)}function w(m){return lt(m)?(e.consume(m),a=String.fromCharCode(m),A):n(m)}function A(m){if(m===null||m===47||m===62||Fe(m)){const xe=m===47,ne=a.toLowerCase();return!xe&&!s&&xi.includes(ne)?(i=1,r.interrupt?t(m):b(m)):Bc.includes(a.toLowerCase())?(i=6,xe?(e.consume(m),E):r.interrupt?t(m):b(m)):(i=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(m):s?_(m):N(m))}return m===45||Ve(m)?(e.consume(m),a+=String.fromCharCode(m),A):n(m)}function E(m){return m===62?(e.consume(m),r.interrupt?t:b):n(m)}function _(m){return re(m)?(e.consume(m),_):U(m)}function N(m){return m===47?(e.consume(m),U):m===58||m===95||lt(m)?(e.consume(m),j):re(m)?(e.consume(m),N):U(m)}function j(m){return m===45||m===46||m===58||m===95||Ve(m)?(e.consume(m),j):L(m)}function L(m){return m===61?(e.consume(m),T):re(m)?(e.consume(m),L):N(m)}function T(m){return m===null||m===60||m===61||m===62||m===96?n(m):m===34||m===39?(e.consume(m),c=m,O):re(m)?(e.consume(m),T):D(m)}function O(m){return m===c?(e.consume(m),c=null,P):m===null||K(m)?n(m):(e.consume(m),O)}function D(m){return m===null||m===34||m===39||m===47||m===60||m===61||m===62||m===96||Fe(m)?L(m):(e.consume(m),D)}function P(m){return m===47||m===62||re(m)?N(m):n(m)}function U(m){return m===62?(e.consume(m),M):n(m)}function M(m){return m===null||K(m)?b(m):re(m)?(e.consume(m),M):n(m)}function b(m){return m===45&&i===2?(e.consume(m),q):m===60&&i===1?(e.consume(m),X):m===62&&i===4?(e.consume(m),Q):m===63&&i===3?(e.consume(m),f):m===93&&i===5?(e.consume(m),ve):K(m)&&(i===6||i===7)?(e.exit("htmlFlowData"),e.check(Gc,ge,H)(m)):m===null||K(m)?(e.exit("htmlFlowData"),H(m)):(e.consume(m),b)}function H(m){return e.check(Vc,G,ge)(m)}function G(m){return e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),F}function F(m){return m===null||K(m)?H(m):(e.enter("htmlFlowData"),b(m))}function q(m){return m===45?(e.consume(m),f):b(m)}function X(m){return m===47?(e.consume(m),a="",ie):b(m)}function ie(m){if(m===62){const xe=a.toLowerCase();return xi.includes(xe)?(e.consume(m),Q):b(m)}return lt(m)&&a.length<8?(e.consume(m),a+=String.fromCharCode(m),ie):b(m)}function ve(m){return m===93?(e.consume(m),f):b(m)}function f(m){return m===62?(e.consume(m),Q):m===45&&i===2?(e.consume(m),f):b(m)}function Q(m){return m===null||K(m)?(e.exit("htmlFlowData"),ge(m)):(e.consume(m),Q)}function ge(m){return e.exit("htmlFlow"),t(m)}}function Kc(e,t,n){const r=this;return i;function i(a){return K(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),s):n(a)}function s(a){return r.parser.lazy[r.now().line]?n(a):t(a)}}function qc(e,t,n){return r;function r(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),e.attempt(kn,t,n)}}const Xc={name:"htmlText",tokenize:Yc};function Yc(e,t,n){const r=this;let i,s,a;return o;function o(f){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(f),c}function c(f){return f===33?(e.consume(f),u):f===47?(e.consume(f),L):f===63?(e.consume(f),N):lt(f)?(e.consume(f),D):n(f)}function u(f){return f===45?(e.consume(f),h):f===91?(e.consume(f),s=0,x):lt(f)?(e.consume(f),_):n(f)}function h(f){return f===45?(e.consume(f),d):n(f)}function p(f){return f===null?n(f):f===45?(e.consume(f),g):K(f)?(a=p,X(f)):(e.consume(f),p)}function g(f){return f===45?(e.consume(f),d):p(f)}function d(f){return f===62?q(f):f===45?g(f):p(f)}function x(f){const Q="CDATA[";return f===Q.charCodeAt(s++)?(e.consume(f),s===Q.length?w:x):n(f)}function w(f){return f===null?n(f):f===93?(e.consume(f),A):K(f)?(a=w,X(f)):(e.consume(f),w)}function A(f){return f===93?(e.consume(f),E):w(f)}function E(f){return f===62?q(f):f===93?(e.consume(f),E):w(f)}function _(f){return f===null||f===62?q(f):K(f)?(a=_,X(f)):(e.consume(f),_)}function N(f){return f===null?n(f):f===63?(e.consume(f),j):K(f)?(a=N,X(f)):(e.consume(f),N)}function j(f){return f===62?q(f):N(f)}function L(f){return lt(f)?(e.consume(f),T):n(f)}function T(f){return f===45||Ve(f)?(e.consume(f),T):O(f)}function O(f){return K(f)?(a=O,X(f)):re(f)?(e.consume(f),O):q(f)}function D(f){return f===45||Ve(f)?(e.consume(f),D):f===47||f===62||Fe(f)?P(f):n(f)}function P(f){return f===47?(e.consume(f),q):f===58||f===95||lt(f)?(e.consume(f),U):K(f)?(a=P,X(f)):re(f)?(e.consume(f),P):q(f)}function U(f){return f===45||f===46||f===58||f===95||Ve(f)?(e.consume(f),U):M(f)}function M(f){return f===61?(e.consume(f),b):K(f)?(a=M,X(f)):re(f)?(e.consume(f),M):P(f)}function b(f){return f===null||f===60||f===61||f===62||f===96?n(f):f===34||f===39?(e.consume(f),i=f,H):K(f)?(a=b,X(f)):re(f)?(e.consume(f),b):(e.consume(f),G)}function H(f){return f===i?(e.consume(f),i=void 0,F):f===null?n(f):K(f)?(a=H,X(f)):(e.consume(f),H)}function G(f){return f===null||f===34||f===39||f===60||f===61||f===96?n(f):f===47||f===62||Fe(f)?P(f):(e.consume(f),G)}function F(f){return f===47||f===62||Fe(f)?P(f):n(f)}function q(f){return f===62?(e.consume(f),e.exit("htmlTextData"),e.exit("htmlText"),t):n(f)}function X(f){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),ie}function ie(f){return re(f)?oe(e,ve,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(f):ve(f)}function ve(f){return e.enter("htmlTextData"),a(f)}}const Sr={name:"labelEnd",resolveAll:tu,resolveTo:nu,tokenize:ru},Jc={tokenize:iu},Qc={tokenize:su},eu={tokenize:au};function tu(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const i=r.type==="labelImage"?4:2;r.type="data",t+=i}}return e.length!==n.length&&ct(e,0,e.length,n),e}function nu(e,t){let n=e.length,r=0,i,s,a,o;for(;n--;)if(i=e[n][1],s){if(i.type==="link"||i.type==="labelLink"&&i._inactive)break;e[n][0]==="enter"&&i.type==="labelLink"&&(i._inactive=!0)}else if(a){if(e[n][0]==="enter"&&(i.type==="labelImage"||i.type==="labelLink")&&!i._balanced&&(s=n,i.type!=="labelLink")){r=2;break}}else i.type==="labelEnd"&&(a=n);const c={type:e[s][1].type==="labelLink"?"link":"image",start:{...e[s][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[s][1].start},end:{...e[a][1].end}},h={type:"labelText",start:{...e[s+r+2][1].end},end:{...e[a-2][1].start}};return o=[["enter",c,t],["enter",u,t]],o=qe(o,e.slice(s+1,s+r+3)),o=qe(o,[["enter",h,t]]),o=qe(o,wr(t.parser.constructs.insideSpan.null,e.slice(s+r+4,a-3),t)),o=qe(o,[["exit",h,t],e[a-2],e[a-1],["exit",u,t]]),o=qe(o,e.slice(a+1)),o=qe(o,[["exit",c,t]]),ct(e,s,e.length,o),e}function ru(e,t,n){const r=this;let i=r.events.length,s,a;for(;i--;)if((r.events[i][1].type==="labelImage"||r.events[i][1].type==="labelLink")&&!r.events[i][1]._balanced){s=r.events[i][1];break}return o;function o(g){return s?s._inactive?p(g):(a=r.parser.defined.includes(jt(r.sliceSerialize({start:s.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(g),e.exit("labelMarker"),e.exit("labelEnd"),c):n(g)}function c(g){return g===40?e.attempt(Jc,h,a?h:p)(g):g===91?e.attempt(Qc,h,a?u:p)(g):a?h(g):p(g)}function u(g){return e.attempt(eu,h,p)(g)}function h(g){return t(g)}function p(g){return s._balanced=!0,n(g)}}function iu(e,t,n){return r;function r(p){return e.enter("resource"),e.enter("resourceMarker"),e.consume(p),e.exit("resourceMarker"),i}function i(p){return Fe(p)?Kt(e,s)(p):s(p)}function s(p){return p===41?h(p):ks(e,a,o,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(p)}function a(p){return Fe(p)?Kt(e,c)(p):h(p)}function o(p){return n(p)}function c(p){return p===34||p===39||p===40?vs(e,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(p):h(p)}function u(p){return Fe(p)?Kt(e,h)(p):h(p)}function h(p){return p===41?(e.enter("resourceMarker"),e.consume(p),e.exit("resourceMarker"),e.exit("resource"),t):n(p)}}function su(e,t,n){const r=this;return i;function i(o){return bs.call(r,e,s,a,"reference","referenceMarker","referenceString")(o)}function s(o){return r.parser.defined.includes(jt(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(o):n(o)}function a(o){return n(o)}}function au(e,t,n){return r;function r(s){return e.enter("reference"),e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),i}function i(s){return s===93?(e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),e.exit("reference"),t):n(s)}}const ou={name:"labelStartImage",resolveAll:Sr.resolveAll,tokenize:lu};function lu(e,t,n){const r=this;return i;function i(o){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(o),e.exit("labelImageMarker"),s}function s(o){return o===91?(e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelImage"),a):n(o)}function a(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):t(o)}}const cu={name:"labelStartLink",resolveAll:Sr.resolveAll,tokenize:uu};function uu(e,t,n){const r=this;return i;function i(a){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(a),e.exit("labelMarker"),e.exit("labelLink"),s}function s(a){return a===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(a):t(a)}}const Un={name:"lineEnding",tokenize:hu};function hu(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),oe(e,t,"linePrefix")}}const Cn={name:"thematicBreak",tokenize:du};function du(e,t,n){let r=0,i;return s;function s(u){return e.enter("thematicBreak"),a(u)}function a(u){return i=u,o(u)}function o(u){return u===i?(e.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||K(u))?(e.exit("thematicBreak"),t(u)):n(u)}function c(u){return u===i?(e.consume(u),r++,c):(e.exit("thematicBreakSequence"),re(u)?oe(e,o,"whitespace")(u):o(u))}}const He={continuation:{tokenize:mu},exit:xu,name:"list",tokenize:gu},pu={partial:!0,tokenize:yu},fu={partial:!0,tokenize:Cu};function gu(e,t,n){const r=this,i=r.events[r.events.length-1];let s=i&&i[1].type==="linePrefix"?i[2].sliceSerialize(i[1],!0).length:0,a=0;return o;function o(d){const x=r.containerState.type||(d===42||d===43||d===45?"listUnordered":"listOrdered");if(x==="listUnordered"?!r.containerState.marker||d===r.containerState.marker:ir(d)){if(r.containerState.type||(r.containerState.type=x,e.enter(x,{_container:!0})),x==="listUnordered")return e.enter("listItemPrefix"),d===42||d===45?e.check(Cn,n,u)(d):u(d);if(!r.interrupt||d===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),c(d)}return n(d)}function c(d){return ir(d)&&++a<10?(e.consume(d),c):(!r.interrupt||a<2)&&(r.containerState.marker?d===r.containerState.marker:d===41||d===46)?(e.exit("listItemValue"),u(d)):n(d)}function u(d){return e.enter("listItemMarker"),e.consume(d),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||d,e.check(kn,r.interrupt?n:h,e.attempt(pu,g,p))}function h(d){return r.containerState.initialBlankLine=!0,s++,g(d)}function p(d){return re(d)?(e.enter("listItemPrefixWhitespace"),e.consume(d),e.exit("listItemPrefixWhitespace"),g):n(d)}function g(d){return r.containerState.size=s+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(d)}}function mu(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(kn,i,s);function i(o){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,oe(e,t,"listItemIndent",r.containerState.size+1)(o)}function s(o){return r.containerState.furtherBlankLines||!re(o)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,a(o)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(fu,t,a)(o))}function a(o){return r.containerState._closeFlow=!0,r.interrupt=void 0,oe(e,e.attempt(He,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o)}}function Cu(e,t,n){const r=this;return oe(e,i,"listItemIndent",r.containerState.size+1);function i(s){const a=r.events[r.events.length-1];return a&&a[1].type==="listItemIndent"&&a[2].sliceSerialize(a[1],!0).length===r.containerState.size?t(s):n(s)}}function xu(e){e.exit(this.containerState.type)}function yu(e,t,n){const r=this;return oe(e,i,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function i(s){const a=r.events[r.events.length-1];return!re(s)&&a&&a[1].type==="listItemPrefixWhitespace"?t(s):n(s)}}const yi={name:"setextUnderline",resolveTo:wu,tokenize:Su};function wu(e,t){let n=e.length,r,i,s;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(i=n)}else e[n][1].type==="content"&&e.splice(n,1),!s&&e[n][1].type==="definition"&&(s=n);const a={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[i][1].type="setextHeadingText",s?(e.splice(i,0,["enter",a,t]),e.splice(s+1,0,["exit",e[r][1],t]),e[r][1].end={...e[s][1].end}):e[r][1]=a,e.push(["exit",a,t]),e}function Su(e,t,n){const r=this;let i;return s;function s(u){let h=r.events.length,p;for(;h--;)if(r.events[h][1].type!=="lineEnding"&&r.events[h][1].type!=="linePrefix"&&r.events[h][1].type!=="content"){p=r.events[h][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||p)?(e.enter("setextHeadingLine"),i=u,a(u)):n(u)}function a(u){return e.enter("setextHeadingLineSequence"),o(u)}function o(u){return u===i?(e.consume(u),o):(e.exit("setextHeadingLineSequence"),re(u)?oe(e,c,"lineSuffix")(u):c(u))}function c(u){return u===null||K(u)?(e.exit("setextHeadingLine"),t(u)):n(u)}}const Eu={tokenize:Tu};function Tu(e){const t=this,n=e.attempt(kn,r,e.attempt(this.parser.constructs.flowInitial,i,oe(e,e.attempt(this.parser.constructs.flow,i,e.attempt(Ic,i)),"linePrefix")));return n;function r(s){if(s===null){e.consume(s);return}return e.enter("lineEndingBlank"),e.consume(s),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function i(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const _u={resolveAll:Rs()},ku=Is("string"),bu=Is("text");function Is(e){return{resolveAll:Rs(e==="text"?vu:void 0),tokenize:t};function t(n){const r=this,i=this.parser.constructs[e],s=n.attempt(i,a,o);return a;function a(h){return u(h)?s(h):o(h)}function o(h){if(h===null){n.consume(h);return}return n.enter("data"),n.consume(h),c}function c(h){return u(h)?(n.exit("data"),s(h)):(n.consume(h),c)}function u(h){if(h===null)return!0;const p=i[h];let g=-1;if(p)for(;++g<p.length;){const d=p[g];if(!d.previous||d.previous.call(r,r.previous))return!0}return!1}}}function Rs(e){return t;function t(n,r){let i=-1,s;for(;++i<=n.length;)s===void 0?n[i]&&n[i][1].type==="data"&&(s=i,i++):(!n[i]||n[i][1].type!=="data")&&(i!==s+2&&(n[s][1].end=n[i-1][1].end,n.splice(s+2,i-s-2),i=s+2),s=void 0);return e?e(n,r):n}}function vu(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],i=t.sliceStream(r);let s=i.length,a=-1,o=0,c;for(;s--;){const u=i[s];if(typeof u=="string"){for(a=u.length;u.charCodeAt(a-1)===32;)o++,a--;if(a)break;a=-1}else if(u===-2)c=!0,o++;else if(u!==-1){s++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(o=0),o){const u={type:n===e.length||c||o<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?a:r.start._bufferIndex+a,_index:r.start._index+s,line:r.end.line,column:r.end.column-o,offset:r.end.offset-o},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(n,0,["enter",u,t],["exit",u,t]),n+=2)}n++}return e}const Iu={42:He,43:He,45:He,48:He,49:He,50:He,51:He,52:He,53:He,54:He,55:He,56:He,57:He,62:Ss},Ru={91:Lc},Au={[-2]:Fn,[-1]:Fn,32:Fn},Mu={35:Fc,42:Cn,45:[yi,Cn],60:Wc,61:yi,95:Cn,96:Ci,126:Ci},Nu={38:Ts,92:Es},Lu={[-5]:Un,[-4]:Un,[-3]:Un,33:ou,38:Ts,42:sr,60:[cc,Xc],91:cu,92:[Pc,Es],93:Sr,95:sr,96:Ec},Ou={null:[sr,_u]},Du={null:[42,95]},ju={null:[]},Pu=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Du,contentInitial:Ru,disable:ju,document:Iu,flow:Mu,flowInitial:Au,insideSpan:Ou,string:Nu,text:Lu},Symbol.toStringTag,{value:"Module"}));function Hu(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const i={},s=[];let a=[],o=[];const c={attempt:O(L),check:O(T),consume:_,enter:N,exit:j,interrupt:O(T,{interrupt:!0})},u={code:null,containerState:{},defineSkip:w,events:[],now:x,parser:e,previous:null,sliceSerialize:g,sliceStream:d,write:p};let h=t.tokenize.call(u,c);return t.resolveAll&&s.push(t),u;function p(M){return a=qe(a,M),A(),a[a.length-1]!==null?[]:(D(t,0),u.events=wr(s,u.events,u),u.events)}function g(M,b){return Uu(d(M),b)}function d(M){return Fu(a,M)}function x(){const{_bufferIndex:M,_index:b,line:H,column:G,offset:F}=r;return{_bufferIndex:M,_index:b,line:H,column:G,offset:F}}function w(M){i[M.line]=M.column,U()}function A(){let M;for(;r._index<a.length;){const b=a[r._index];if(typeof b=="string")for(M=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===M&&r._bufferIndex<b.length;)E(b.charCodeAt(r._bufferIndex));else E(b)}}function E(M){h=h(M)}function _(M){K(M)?(r.line++,r.column=1,r.offset+=M===-3?2:1,U()):M!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===a[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=M}function N(M,b){const H=b||{};return H.type=M,H.start=x(),u.events.push(["enter",H,u]),o.push(H),H}function j(M){const b=o.pop();return b.end=x(),u.events.push(["exit",b,u]),b}function L(M,b){D(M,b.from)}function T(M,b){b.restore()}function O(M,b){return H;function H(G,F,q){let X,ie,ve,f;return Array.isArray(G)?ge(G):"tokenize"in G?ge([G]):Q(G);function Q(se){return Te;function Te(le){const $e=le!==null&&se[le],ze=le!==null&&se.null,nt=[...Array.isArray($e)?$e:$e?[$e]:[],...Array.isArray(ze)?ze:ze?[ze]:[]];return ge(nt)(le)}}function ge(se){return X=se,ie=0,se.length===0?q:m(se[ie])}function m(se){return Te;function Te(le){return f=P(),ve=se,se.partial||(u.currentConstruct=se),se.name&&u.parser.constructs.disable.null.includes(se.name)?ne():se.tokenize.call(b?Object.assign(Object.create(u),b):u,c,xe,ne)(le)}}function xe(se){return M(ve,f),F}function ne(se){return f.restore(),++ie<X.length?m(X[ie]):q}}}function D(M,b){M.resolveAll&&!s.includes(M)&&s.push(M),M.resolve&&ct(u.events,b,u.events.length-b,M.resolve(u.events.slice(b),u)),M.resolveTo&&(u.events=M.resolveTo(u.events,u))}function P(){const M=x(),b=u.previous,H=u.currentConstruct,G=u.events.length,F=Array.from(o);return{from:G,restore:q};function q(){r=M,u.previous=b,u.currentConstruct=H,u.events.length=G,o=F,U()}}function U(){r.line in i&&r.column<2&&(r.column=i[r.line],r.offset+=i[r.line]-1)}}function Fu(e,t){const n=t.start._index,r=t.start._bufferIndex,i=t.end._index,s=t.end._bufferIndex;let a;if(n===i)a=[e[n].slice(r,s)];else{if(a=e.slice(n,i),r>-1){const o=a[0];typeof o=="string"?a[0]=o.slice(r):a.shift()}s>0&&a.push(e[i].slice(0,s))}return a}function Uu(e,t){let n=-1;const r=[];let i;for(;++n<e.length;){const s=e[n];let a;if(typeof s=="string")a=s;else switch(s){case-5:{a="\r";break}case-4:{a=`
`;break}case-3:{a=`\r
`;break}case-2:{a=t?" ":"	";break}case-1:{if(!t&&i)continue;a=" ";break}default:a=String.fromCharCode(s)}i=s===-2,r.push(a)}return r.join("")}function zu(e){const r={constructs:Kl([Pu,...(e||{}).extensions||[]]),content:i(nc),defined:[],document:i(ic),flow:i(Eu),lazy:{},string:i(ku),text:i(bu)};return r;function i(s){return a;function a(o){return Hu(r,s,o)}}}function Bu(e){for(;!_s(e););return e}const wi=/[\0\t\n\r]/g;function Wu(){let e=1,t="",n=!0,r;return i;function i(s,a,o){const c=[];let u,h,p,g,d;for(s=t+(typeof s=="string"?s.toString():new TextDecoder(a||void 0).decode(s)),p=0,t="",n&&(s.charCodeAt(0)===65279&&p++,n=void 0);p<s.length;){if(wi.lastIndex=p,u=wi.exec(s),g=u&&u.index!==void 0?u.index:s.length,d=s.charCodeAt(g),!u){t=s.slice(p);break}if(d===10&&p===g&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),p<g&&(c.push(s.slice(p,g)),e+=g-p),d){case 0:{c.push(65533),e++;break}case 9:{for(h=Math.ceil(e/4)*4,c.push(-2);e++<h;)c.push(-1);break}case 10:{c.push(-4),e=1;break}default:r=!0,e=1}p=g+1}return o&&(r&&c.push(-5),t&&c.push(t),c.push(null)),c}}const Gu=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function Vu(e){return e.replace(Gu,$u)}function $u(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const i=n.charCodeAt(1),s=i===120||i===88;return ws(n.slice(s?2:1),s?16:10)}return yr(n)||e}const As={}.hasOwnProperty;function Zu(e,t,n){return typeof t!="string"&&(n=t,t=void 0),Ku(n)(Bu(zu(n).document().write(Wu()(e,t,!0))))}function Ku(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(rt),autolinkProtocol:P,autolinkEmail:P,atxHeading:s(Be),blockQuote:s(ze),characterEscape:P,characterReference:P,codeFenced:s(nt),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:s(nt,a),codeText:s(_t,a),codeTextData:P,data:P,codeFlowValue:P,definition:s(Ye),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:s(ut),hardBreakEscape:s(mt),hardBreakTrailing:s(mt),htmlFlow:s(Ct,a),htmlFlowData:P,htmlText:s(Ct,a),htmlTextData:P,image:s(Je),label:a,link:s(rt),listItem:s(xt),listItemValue:g,listOrdered:s(it,p),listUnordered:s(it),paragraph:s(st),reference:m,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:s(Be),strong:s(kt),thematicBreak:s(ht)},exit:{atxHeading:c(),atxHeadingSequence:L,autolink:c(),autolinkEmail:$e,autolinkProtocol:le,blockQuote:c(),characterEscapeValue:U,characterReferenceMarkerHexadecimal:ne,characterReferenceMarkerNumeric:ne,characterReferenceValue:se,characterReference:Te,codeFenced:c(A),codeFencedFence:w,codeFencedFenceInfo:d,codeFencedFenceMeta:x,codeFlowValue:U,codeIndented:c(E),codeText:c(F),codeTextData:U,data:U,definition:c(),definitionDestinationString:j,definitionLabelString:_,definitionTitleString:N,emphasis:c(),hardBreakEscape:c(b),hardBreakTrailing:c(b),htmlFlow:c(H),htmlFlowData:U,htmlText:c(G),htmlTextData:U,image:c(X),label:ve,labelText:ie,lineEnding:M,link:c(q),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:xe,resourceDestinationString:f,resourceTitleString:Q,resource:ge,setextHeading:c(D),setextHeadingLineSequence:O,setextHeadingText:T,strong:c(),thematicBreak:c()}};Ms(t,(e||{}).mdastExtensions||[]);const n={};return r;function r(S){let I={type:"root",children:[]};const V={stack:[I],tokenStack:[],config:t,enter:o,exit:u,buffer:a,resume:h,data:n},J=[];let te=-1;for(;++te<S.length;)if(S[te][1].type==="listOrdered"||S[te][1].type==="listUnordered")if(S[te][0]==="enter")J.push(te);else{const ye=J.pop();te=i(S,ye,te)}for(te=-1;++te<S.length;){const ye=t[S[te][0]];As.call(ye,S[te][1].type)&&ye[S[te][1].type].call(Object.assign({sliceSerialize:S[te][2].sliceSerialize},V),S[te][1])}if(V.tokenStack.length>0){const ye=V.tokenStack[V.tokenStack.length-1];(ye[1]||Si).call(V,void 0,ye[0])}for(I.position={start:wt(S.length>0?S[0][1].start:{line:1,column:1,offset:0}),end:wt(S.length>0?S[S.length-2][1].end:{line:1,column:1,offset:0})},te=-1;++te<t.transforms.length;)I=t.transforms[te](I)||I;return I}function i(S,I,V){let J=I-1,te=-1,ye=!1,_e,me,je,we;for(;++J<=V;){const ue=S[J];switch(ue[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{ue[0]==="enter"?te++:te--,we=void 0;break}case"lineEndingBlank":{ue[0]==="enter"&&(_e&&!we&&!te&&!je&&(je=J),we=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:we=void 0}if(!te&&ue[0]==="enter"&&ue[1].type==="listItemPrefix"||te===-1&&ue[0]==="exit"&&(ue[1].type==="listUnordered"||ue[1].type==="listOrdered")){if(_e){let Ze=J;for(me=void 0;Ze--;){const Ie=S[Ze];if(Ie[1].type==="lineEnding"||Ie[1].type==="lineEndingBlank"){if(Ie[0]==="exit")continue;me&&(S[me][1].type="lineEndingBlank",ye=!0),Ie[1].type="lineEnding",me=Ze}else if(!(Ie[1].type==="linePrefix"||Ie[1].type==="blockQuotePrefix"||Ie[1].type==="blockQuotePrefixWhitespace"||Ie[1].type==="blockQuoteMarker"||Ie[1].type==="listItemIndent"))break}je&&(!me||je<me)&&(_e._spread=!0),_e.end=Object.assign({},me?S[me][1].start:ue[1].end),S.splice(me||J,0,["exit",_e,ue[2]]),J++,V++}if(ue[1].type==="listItemPrefix"){const Ze={type:"listItem",_spread:!1,start:Object.assign({},ue[1].start),end:void 0};_e=Ze,S.splice(J,0,["enter",Ze,ue[2]]),J++,V++,je=void 0,we=!0}}}return S[I][1]._spread=ye,V}function s(S,I){return V;function V(J){o.call(this,S(J),J),I&&I.call(this,J)}}function a(){this.stack.push({type:"fragment",children:[]})}function o(S,I,V){this.stack[this.stack.length-1].children.push(S),this.stack.push(S),this.tokenStack.push([I,V||void 0]),S.position={start:wt(I.start),end:void 0}}function c(S){return I;function I(V){S&&S.call(this,V),u.call(this,V)}}function u(S,I){const V=this.stack.pop(),J=this.tokenStack.pop();if(J)J[0].type!==S.type&&(I?I.call(this,S,J[0]):(J[1]||Si).call(this,S,J[0]));else throw new Error("Cannot close `"+S.type+"` ("+Zt({start:S.start,end:S.end})+"): itâ€™s not open");V.position.end=wt(S.end)}function h(){return $l(this.stack.pop())}function p(){this.data.expectingFirstListItemValue=!0}function g(S){if(this.data.expectingFirstListItemValue){const I=this.stack[this.stack.length-2];I.start=Number.parseInt(this.sliceSerialize(S),10),this.data.expectingFirstListItemValue=void 0}}function d(){const S=this.resume(),I=this.stack[this.stack.length-1];I.lang=S}function x(){const S=this.resume(),I=this.stack[this.stack.length-1];I.meta=S}function w(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function A(){const S=this.resume(),I=this.stack[this.stack.length-1];I.value=S.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function E(){const S=this.resume(),I=this.stack[this.stack.length-1];I.value=S.replace(/(\r?\n|\r)$/g,"")}function _(S){const I=this.resume(),V=this.stack[this.stack.length-1];V.label=I,V.identifier=jt(this.sliceSerialize(S)).toLowerCase()}function N(){const S=this.resume(),I=this.stack[this.stack.length-1];I.title=S}function j(){const S=this.resume(),I=this.stack[this.stack.length-1];I.url=S}function L(S){const I=this.stack[this.stack.length-1];if(!I.depth){const V=this.sliceSerialize(S).length;I.depth=V}}function T(){this.data.setextHeadingSlurpLineEnding=!0}function O(S){const I=this.stack[this.stack.length-1];I.depth=this.sliceSerialize(S).codePointAt(0)===61?1:2}function D(){this.data.setextHeadingSlurpLineEnding=void 0}function P(S){const V=this.stack[this.stack.length-1].children;let J=V[V.length-1];(!J||J.type!=="text")&&(J=bt(),J.position={start:wt(S.start),end:void 0},V.push(J)),this.stack.push(J)}function U(S){const I=this.stack.pop();I.value+=this.sliceSerialize(S),I.position.end=wt(S.end)}function M(S){const I=this.stack[this.stack.length-1];if(this.data.atHardBreak){const V=I.children[I.children.length-1];V.position.end=wt(S.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(I.type)&&(P.call(this,S),U.call(this,S))}function b(){this.data.atHardBreak=!0}function H(){const S=this.resume(),I=this.stack[this.stack.length-1];I.value=S}function G(){const S=this.resume(),I=this.stack[this.stack.length-1];I.value=S}function F(){const S=this.resume(),I=this.stack[this.stack.length-1];I.value=S}function q(){const S=this.stack[this.stack.length-1];if(this.data.inReference){const I=this.data.referenceType||"shortcut";S.type+="Reference",S.referenceType=I,delete S.url,delete S.title}else delete S.identifier,delete S.label;this.data.referenceType=void 0}function X(){const S=this.stack[this.stack.length-1];if(this.data.inReference){const I=this.data.referenceType||"shortcut";S.type+="Reference",S.referenceType=I,delete S.url,delete S.title}else delete S.identifier,delete S.label;this.data.referenceType=void 0}function ie(S){const I=this.sliceSerialize(S),V=this.stack[this.stack.length-2];V.label=Vu(I),V.identifier=jt(I).toLowerCase()}function ve(){const S=this.stack[this.stack.length-1],I=this.resume(),V=this.stack[this.stack.length-1];if(this.data.inReference=!0,V.type==="link"){const J=S.children;V.children=J}else V.alt=I}function f(){const S=this.resume(),I=this.stack[this.stack.length-1];I.url=S}function Q(){const S=this.resume(),I=this.stack[this.stack.length-1];I.title=S}function ge(){this.data.inReference=void 0}function m(){this.data.referenceType="collapsed"}function xe(S){const I=this.resume(),V=this.stack[this.stack.length-1];V.label=I,V.identifier=jt(this.sliceSerialize(S)).toLowerCase(),this.data.referenceType="full"}function ne(S){this.data.characterReferenceType=S.type}function se(S){const I=this.sliceSerialize(S),V=this.data.characterReferenceType;let J;V?(J=ws(I,V==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):J=yr(I);const te=this.stack[this.stack.length-1];te.value+=J}function Te(S){const I=this.stack.pop();I.position.end=wt(S.end)}function le(S){U.call(this,S);const I=this.stack[this.stack.length-1];I.url=this.sliceSerialize(S)}function $e(S){U.call(this,S);const I=this.stack[this.stack.length-1];I.url="mailto:"+this.sliceSerialize(S)}function ze(){return{type:"blockquote",children:[]}}function nt(){return{type:"code",lang:null,meta:null,value:""}}function _t(){return{type:"inlineCode",value:""}}function Ye(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function ut(){return{type:"emphasis",children:[]}}function Be(){return{type:"heading",depth:0,children:[]}}function mt(){return{type:"break"}}function Ct(){return{type:"html",value:""}}function Je(){return{type:"image",title:null,url:"",alt:null}}function rt(){return{type:"link",title:null,url:"",children:[]}}function it(S){return{type:"list",ordered:S.type==="listOrdered",start:null,spread:S._spread,children:[]}}function xt(S){return{type:"listItem",spread:S._spread,checked:null,children:[]}}function st(){return{type:"paragraph",children:[]}}function kt(){return{type:"strong",children:[]}}function bt(){return{type:"text",value:""}}function ht(){return{type:"thematicBreak"}}}function wt(e){return{line:e.line,column:e.column,offset:e.offset}}function Ms(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?Ms(e,r):qu(e,r)}}function qu(e,t){let n;for(n in t)if(As.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function Si(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Zt({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Zt({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Zt({start:t.start,end:t.end})+") is still open")}function Xu(e){const t=this;t.parser=n;function n(r){return Zu(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function Yu(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function Ju(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function Qu(e,t){const n=t.value?t.value+`
`:"",r={};t.lang&&(r.className=["language-"+t.lang]);let i={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(i.data={meta:t.meta}),e.patch(t,i),i=e.applyData(t,i),i={type:"element",tagName:"pre",properties:{},children:[i]},e.patch(t,i),i}function e1(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function t1(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function n1(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),i=Ht(r.toLowerCase()),s=e.footnoteOrder.indexOf(r);let a,o=e.footnoteCounts.get(r);o===void 0?(o=0,e.footnoteOrder.push(r),a=e.footnoteOrder.length):a=s+1,o+=1,e.footnoteCounts.set(r,o);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+i,id:n+"fnref-"+i+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};e.patch(t,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return e.patch(t,u),e.applyData(t,u)}function r1(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function i1(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function Ns(e,t){const n=t.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const i=e.all(t),s=i[0];s&&s.type==="text"?s.value="["+s.value:i.unshift({type:"text",value:"["});const a=i[i.length-1];return a&&a.type==="text"?a.value+=r:i.push({type:"text",value:r}),i}function s1(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return Ns(e,t);const i={src:Ht(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(i.title=r.title);const s={type:"element",tagName:"img",properties:i,children:[]};return e.patch(t,s),e.applyData(t,s)}function a1(e,t){const n={src:Ht(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)}function o1(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)}function l1(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return Ns(e,t);const i={href:Ht(r.url||"")};r.title!==null&&r.title!==void 0&&(i.title=r.title);const s={type:"element",tagName:"a",properties:i,children:e.all(t)};return e.patch(t,s),e.applyData(t,s)}function c1(e,t){const n={href:Ht(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function u1(e,t,n){const r=e.all(t),i=n?h1(n):Ls(t),s={},a=[];if(typeof t.checked=="boolean"){const h=r[0];let p;h&&h.type==="element"&&h.tagName==="p"?p=h:(p={type:"element",tagName:"p",properties:{},children:[]},r.unshift(p)),p.children.length>0&&p.children.unshift({type:"text",value:" "}),p.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let o=-1;for(;++o<r.length;){const h=r[o];(i||o!==0||h.type!=="element"||h.tagName!=="p")&&a.push({type:"text",value:`
`}),h.type==="element"&&h.tagName==="p"&&!i?a.push(...h.children):a.push(h)}const c=r[r.length-1];c&&(i||c.type!=="element"||c.tagName!=="p")&&a.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:s,children:a};return e.patch(t,u),e.applyData(t,u)}function h1(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=Ls(n[r])}return t}function Ls(e){const t=e.spread;return t??e.children.length>1}function d1(e,t){const n={},r=e.all(t);let i=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++i<r.length;){const a=r[i];if(a.type==="element"&&a.tagName==="li"&&a.properties&&Array.isArray(a.properties.className)&&a.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const s={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,s),e.applyData(t,s)}function p1(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function f1(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function g1(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function m1(e,t){const n=e.all(t),r=n.shift(),i=[];if(r){const a={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],a),i.push(a)}if(n.length>0){const a={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},o=gr(t.children[1]),c=ps(t.children[t.children.length-1]);o&&c&&(a.position={start:o,end:c}),i.push(a)}const s={type:"element",tagName:"table",properties:{},children:e.wrap(i,!0)};return e.patch(t,s),e.applyData(t,s)}function C1(e,t,n){const r=n?n.children:void 0,s=(r?r.indexOf(t):1)===0?"th":"td",a=n&&n.type==="table"?n.align:void 0,o=a?a.length:t.children.length;let c=-1;const u=[];for(;++c<o;){const p=t.children[c],g={},d=a?a[c]:void 0;d&&(g.align=d);let x={type:"element",tagName:s,properties:g,children:[]};p&&(x.children=e.all(p),e.patch(p,x),x=e.applyData(p,x)),u.push(x)}const h={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,h),e.applyData(t,h)}function x1(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const Ei=9,Ti=32;function y1(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),i=0;const s=[];for(;r;)s.push(_i(t.slice(i,r.index),i>0,!0),r[0]),i=r.index+r[0].length,r=n.exec(t);return s.push(_i(t.slice(i),i>0,!1)),s.join("")}function _i(e,t,n){let r=0,i=e.length;if(t){let s=e.codePointAt(r);for(;s===Ei||s===Ti;)r++,s=e.codePointAt(r)}if(n){let s=e.codePointAt(i-1);for(;s===Ei||s===Ti;)i--,s=e.codePointAt(i-1)}return i>r?e.slice(r,i):""}function w1(e,t){const n={type:"text",value:y1(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function S1(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const E1={blockquote:Yu,break:Ju,code:Qu,delete:e1,emphasis:t1,footnoteReference:n1,heading:r1,html:i1,imageReference:s1,image:a1,inlineCode:o1,linkReference:l1,link:c1,listItem:u1,list:d1,paragraph:p1,root:f1,strong:g1,table:m1,tableCell:x1,tableRow:C1,text:w1,thematicBreak:S1,toml:dn,yaml:dn,definition:dn,footnoteDefinition:dn};function dn(){}const Os=-1,bn=0,qt=1,En=2,Er=3,Tr=4,_r=5,kr=6,Ds=7,js=8,ki=typeof self=="object"?self:globalThis,T1=(e,t)=>{const n=(i,s)=>(e.set(s,i),i),r=i=>{if(e.has(i))return e.get(i);const[s,a]=t[i];switch(s){case bn:case Os:return n(a,i);case qt:{const o=n([],i);for(const c of a)o.push(r(c));return o}case En:{const o=n({},i);for(const[c,u]of a)o[r(c)]=r(u);return o}case Er:return n(new Date(a),i);case Tr:{const{source:o,flags:c}=a;return n(new RegExp(o,c),i)}case _r:{const o=n(new Map,i);for(const[c,u]of a)o.set(r(c),r(u));return o}case kr:{const o=n(new Set,i);for(const c of a)o.add(r(c));return o}case Ds:{const{name:o,message:c}=a;return n(new ki[o](c),i)}case js:return n(BigInt(a),i);case"BigInt":return n(Object(BigInt(a)),i);case"ArrayBuffer":return n(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:o}=new Uint8Array(a);return n(new DataView(o),a)}}return n(new ki[s](a),i)};return r},bi=e=>T1(new Map,e)(0),Lt="",{toString:_1}={},{keys:k1}=Object,$t=e=>{const t=typeof e;if(t!=="object"||!e)return[bn,t];const n=_1.call(e).slice(8,-1);switch(n){case"Array":return[qt,Lt];case"Object":return[En,Lt];case"Date":return[Er,Lt];case"RegExp":return[Tr,Lt];case"Map":return[_r,Lt];case"Set":return[kr,Lt];case"DataView":return[qt,n]}return n.includes("Array")?[qt,n]:n.includes("Error")?[Ds,n]:[En,n]},pn=([e,t])=>e===bn&&(t==="function"||t==="symbol"),b1=(e,t,n,r)=>{const i=(a,o)=>{const c=r.push(a)-1;return n.set(o,c),c},s=a=>{if(n.has(a))return n.get(a);let[o,c]=$t(a);switch(o){case bn:{let h=a;switch(c){case"bigint":o=js,h=a.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+c);h=null;break;case"undefined":return i([Os],a)}return i([o,h],a)}case qt:{if(c){let g=a;return c==="DataView"?g=new Uint8Array(a.buffer):c==="ArrayBuffer"&&(g=new Uint8Array(a)),i([c,[...g]],a)}const h=[],p=i([o,h],a);for(const g of a)h.push(s(g));return p}case En:{if(c)switch(c){case"BigInt":return i([c,a.toString()],a);case"Boolean":case"Number":case"String":return i([c,a.valueOf()],a)}if(t&&"toJSON"in a)return s(a.toJSON());const h=[],p=i([o,h],a);for(const g of k1(a))(e||!pn($t(a[g])))&&h.push([s(g),s(a[g])]);return p}case Er:return i([o,a.toISOString()],a);case Tr:{const{source:h,flags:p}=a;return i([o,{source:h,flags:p}],a)}case _r:{const h=[],p=i([o,h],a);for(const[g,d]of a)(e||!(pn($t(g))||pn($t(d))))&&h.push([s(g),s(d)]);return p}case kr:{const h=[],p=i([o,h],a);for(const g of a)(e||!pn($t(g)))&&h.push(s(g));return p}}const{message:u}=a;return i([o,{name:c,message:u}],a)};return s},vi=(e,{json:t,lossy:n}={})=>{const r=[];return b1(!(t||n),!!t,new Map,r)(e),r},Tn=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?bi(vi(e,t)):structuredClone(e):(e,t)=>bi(vi(e,t));function v1(e,t){const n=[{type:"text",value:"â†©"}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function I1(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function R1(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||v1,r=e.options.footnoteBackLabel||I1,i=e.options.footnoteLabel||"Footnotes",s=e.options.footnoteLabelTagName||"h2",a=e.options.footnoteLabelProperties||{className:["sr-only"]},o=[];let c=-1;for(;++c<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[c]);if(!u)continue;const h=e.all(u),p=String(u.identifier).toUpperCase(),g=Ht(p.toLowerCase());let d=0;const x=[],w=e.footnoteCounts.get(p);for(;w!==void 0&&++d<=w;){x.length>0&&x.push({type:"text",value:" "});let _=typeof n=="string"?n:n(c,d);typeof _=="string"&&(_={type:"text",value:_}),x.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+g+(d>1?"-"+d:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,d),className:["data-footnote-backref"]},children:Array.isArray(_)?_:[_]})}const A=h[h.length-1];if(A&&A.type==="element"&&A.tagName==="p"){const _=A.children[A.children.length-1];_&&_.type==="text"?_.value+=" ":A.children.push({type:"text",value:" "}),A.children.push(...x)}else h.push(...x);const E={type:"element",tagName:"li",properties:{id:t+"fn-"+g},children:e.wrap(h,!0)};e.patch(u,E),o.push(E)}if(o.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...Tn(a),id:"footnote-label"},children:[{type:"text",value:i}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(o,!0)},{type:"text",value:`
`}]}}const Ps=function(e){if(e==null)return L1;if(typeof e=="function")return vn(e);if(typeof e=="object")return Array.isArray(e)?A1(e):M1(e);if(typeof e=="string")return N1(e);throw new Error("Expected function, string, or object as test")};function A1(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=Ps(e[n]);return vn(r);function r(...i){let s=-1;for(;++s<t.length;)if(t[s].apply(this,i))return!0;return!1}}function M1(e){const t=e;return vn(n);function n(r){const i=r;let s;for(s in e)if(i[s]!==t[s])return!1;return!0}}function N1(e){return vn(t);function t(n){return n&&n.type===e}}function vn(e){return t;function t(n,r,i){return!!(O1(n)&&e.call(this,n,typeof r=="number"?r:void 0,i||void 0))}}function L1(){return!0}function O1(e){return e!==null&&typeof e=="object"&&"type"in e}const Hs=[],D1=!0,Ii=!1,j1="skip";function P1(e,t,n,r){let i;typeof t=="function"&&typeof n!="function"?(r=n,n=t):i=t;const s=Ps(i),a=r?-1:1;o(e,void 0,[])();function o(c,u,h){const p=c&&typeof c=="object"?c:{};if(typeof p.type=="string"){const d=typeof p.tagName=="string"?p.tagName:typeof p.name=="string"?p.name:void 0;Object.defineProperty(g,"name",{value:"node ("+(c.type+(d?"<"+d+">":""))+")"})}return g;function g(){let d=Hs,x,w,A;if((!t||s(c,u,h[h.length-1]||void 0))&&(d=H1(n(c,h)),d[0]===Ii))return d;if("children"in c&&c.children){const E=c;if(E.children&&d[0]!==j1)for(w=(r?E.children.length:-1)+a,A=h.concat(E);w>-1&&w<E.children.length;){const _=E.children[w];if(x=o(_,w,A)(),x[0]===Ii)return x;w=typeof x[1]=="number"?x[1]:w+a}}return d}}}function H1(e){return Array.isArray(e)?e:typeof e=="number"?[D1,e]:e==null?Hs:[e]}function Fs(e,t,n,r){let i,s,a;typeof t=="function"&&typeof n!="function"?(s=void 0,a=t,i=n):(s=t,a=n,i=r),P1(e,s,o,i);function o(c,u){const h=u[u.length-1],p=h?h.children.indexOf(c):void 0;return a(c,p,h)}}const ar={}.hasOwnProperty,F1={};function U1(e,t){const n=t||F1,r=new Map,i=new Map,s=new Map,a={...E1,...n.handlers},o={all:u,applyData:B1,definitionById:r,footnoteById:i,footnoteCounts:s,footnoteOrder:[],handlers:a,one:c,options:n,patch:z1,wrap:G1};return Fs(e,function(h){if(h.type==="definition"||h.type==="footnoteDefinition"){const p=h.type==="definition"?r:i,g=String(h.identifier).toUpperCase();p.has(g)||p.set(g,h)}}),o;function c(h,p){const g=h.type,d=o.handlers[g];if(ar.call(o.handlers,g)&&d)return d(o,h,p);if(o.options.passThrough&&o.options.passThrough.includes(g)){if("children"in h){const{children:w,...A}=h,E=Tn(A);return E.children=o.all(h),E}return Tn(h)}return(o.options.unknownHandler||W1)(o,h,p)}function u(h){const p=[];if("children"in h){const g=h.children;let d=-1;for(;++d<g.length;){const x=o.one(g[d],h);if(x){if(d&&g[d-1].type==="break"&&(!Array.isArray(x)&&x.type==="text"&&(x.value=Ri(x.value)),!Array.isArray(x)&&x.type==="element")){const w=x.children[0];w&&w.type==="text"&&(w.value=Ri(w.value))}Array.isArray(x)?p.push(...x):p.push(x)}}}return p}}function z1(e,t){e.position&&(t.position=_l(e))}function B1(e,t){let n=t;if(e&&e.data){const r=e.data.hName,i=e.data.hChildren,s=e.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const a="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:a}}n.type==="element"&&s&&Object.assign(n.properties,Tn(s)),"children"in n&&n.children&&i!==null&&i!==void 0&&(n.children=i)}return n}function W1(e,t){const n=t.data||{},r="value"in t&&!(ar.call(n,"hProperties")||ar.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function G1(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:`
`});++r<e.length;)r&&n.push({type:"text",value:`
`}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function Ri(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function Ai(e,t){const n=U1(e,t),r=n.one(e,void 0),i=R1(n),s=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return i&&s.children.push({type:"text",value:`
`},i),s}function V1(e,t){return e&&"run"in e?async function(n,r){const i=Ai(n,{file:r,...t});await e.run(i,r)}:function(n,r){return Ai(n,{file:r,...e||t})}}function Mi(e){if(e)throw e}var xn=Object.prototype.hasOwnProperty,Us=Object.prototype.toString,Ni=Object.defineProperty,Li=Object.getOwnPropertyDescriptor,Oi=function(t){return typeof Array.isArray=="function"?Array.isArray(t):Us.call(t)==="[object Array]"},Di=function(t){if(!t||Us.call(t)!=="[object Object]")return!1;var n=xn.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&xn.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;var i;for(i in t);return typeof i>"u"||xn.call(t,i)},ji=function(t,n){Ni&&n.name==="__proto__"?Ni(t,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):t[n.name]=n.newValue},Pi=function(t,n){if(n==="__proto__")if(xn.call(t,n)){if(Li)return Li(t,n).value}else return;return t[n]},$1=function e(){var t,n,r,i,s,a,o=arguments[0],c=1,u=arguments.length,h=!1;for(typeof o=="boolean"&&(h=o,o=arguments[1]||{},c=2),(o==null||typeof o!="object"&&typeof o!="function")&&(o={});c<u;++c)if(t=arguments[c],t!=null)for(n in t)r=Pi(o,n),i=Pi(t,n),o!==i&&(h&&i&&(Di(i)||(s=Oi(i)))?(s?(s=!1,a=r&&Oi(r)?r:[]):a=r&&Di(r)?r:{},ji(o,{name:n,newValue:e(h,a,i)})):typeof i<"u"&&ji(o,{name:n,newValue:i}));return o};const zn=ds($1);function or(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function Z1(){const e=[],t={run:n,use:r};return t;function n(...i){let s=-1;const a=i.pop();if(typeof a!="function")throw new TypeError("Expected function as last argument, not "+a);o(null,...i);function o(c,...u){const h=e[++s];let p=-1;if(c){a(c);return}for(;++p<i.length;)(u[p]===null||u[p]===void 0)&&(u[p]=i[p]);i=u,h?K1(h,o)(...u):a(null,...u)}}function r(i){if(typeof i!="function")throw new TypeError("Expected `middelware` to be a function, not "+i);return e.push(i),t}}function K1(e,t){let n;return r;function r(...a){const o=e.length>a.length;let c;o&&a.push(i);try{c=e.apply(this,a)}catch(u){const h=u;if(o&&n)throw h;return i(h)}o||(c&&c.then&&typeof c.then=="function"?c.then(s,i):c instanceof Error?i(c):s(c))}function i(a,...o){n||(n=!0,t(a,...o))}function s(a){i(null,a)}}const at={basename:q1,dirname:X1,extname:Y1,join:J1,sep:"/"};function q1(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');en(e);let n=0,r=-1,i=e.length,s;if(t===void 0||t.length===0||t.length>e.length){for(;i--;)if(e.codePointAt(i)===47){if(s){n=i+1;break}}else r<0&&(s=!0,r=i+1);return r<0?"":e.slice(n,r)}if(t===e)return"";let a=-1,o=t.length-1;for(;i--;)if(e.codePointAt(i)===47){if(s){n=i+1;break}}else a<0&&(s=!0,a=i+1),o>-1&&(e.codePointAt(i)===t.codePointAt(o--)?o<0&&(r=i):(o=-1,r=a));return n===r?r=a:r<0&&(r=e.length),e.slice(n,r)}function X1(e){if(en(e),e.length===0)return".";let t=-1,n=e.length,r;for(;--n;)if(e.codePointAt(n)===47){if(r){t=n;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function Y1(e){en(e);let t=e.length,n=-1,r=0,i=-1,s=0,a;for(;t--;){const o=e.codePointAt(t);if(o===47){if(a){r=t+1;break}continue}n<0&&(a=!0,n=t+1),o===46?i<0?i=t:s!==1&&(s=1):i>-1&&(s=-1)}return i<0||n<0||s===0||s===1&&i===n-1&&i===r+1?"":e.slice(i,n)}function J1(...e){let t=-1,n;for(;++t<e.length;)en(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":Q1(n)}function Q1(e){en(e);const t=e.codePointAt(0)===47;let n=eh(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function eh(e,t){let n="",r=0,i=-1,s=0,a=-1,o,c;for(;++a<=e.length;){if(a<e.length)o=e.codePointAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),i=a,s=0;continue}}else if(n.length>0){n="",r=0,i=a,s=0;continue}}t&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(i+1,a):n=e.slice(i+1,a),r=a-i-1;i=a,s=0}else o===46&&s>-1?s++:s=-1}return n}function en(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const th={cwd:nh};function nh(){return"/"}function lr(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function rh(e){if(typeof e=="string")e=new URL(e);else if(!lr(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return ih(e)}function ih(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const r=t.codePointAt(n+2);if(r===70||r===102){const i=new TypeError("File URL path must not include encoded / characters");throw i.code="ERR_INVALID_FILE_URL_PATH",i}}return decodeURIComponent(t)}const Bn=["history","path","basename","stem","extname","dirname"];class zs{constructor(t){let n;t?lr(t)?n={path:t}:typeof t=="string"||sh(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":th.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<Bn.length;){const s=Bn[r];s in n&&n[s]!==void 0&&n[s]!==null&&(this[s]=s==="history"?[...n[s]]:n[s])}let i;for(i in n)Bn.includes(i)||(this[i]=n[i])}get basename(){return typeof this.path=="string"?at.basename(this.path):void 0}set basename(t){Gn(t,"basename"),Wn(t,"basename"),this.path=at.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?at.dirname(this.path):void 0}set dirname(t){Hi(this.basename,"dirname"),this.path=at.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?at.extname(this.path):void 0}set extname(t){if(Wn(t,"extname"),Hi(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=at.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){lr(t)&&(t=rh(t)),Gn(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?at.basename(this.path,this.extname):void 0}set stem(t){Gn(t,"stem"),Wn(t,"stem"),this.path=at.join(this.dirname||"",t+(this.extname||""))}fail(t,n,r){const i=this.message(t,n,r);throw i.fatal=!0,i}info(t,n,r){const i=this.message(t,n,r);return i.fatal=void 0,i}message(t,n,r){const i=new Ne(t,n,r);return this.path&&(i.name=this.path+":"+i.name,i.file=this.path),i.fatal=!1,this.messages.push(i),i}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function Wn(e,t){if(e&&e.includes(at.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+at.sep+"`")}function Gn(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function Hi(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function sh(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const ah=function(e){const r=this.constructor.prototype,i=r[e],s=function(){return i.apply(s,arguments)};return Object.setPrototypeOf(s,r),s},oh={}.hasOwnProperty;class br extends ah{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=Z1()}copy(){const t=new br;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];t.use(...r)}return t.data(zn(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(Zn("data",this.frozen),this.namespace[t]=n,this):oh.call(this.namespace,t)&&this.namespace[t]||void 0:t?(Zn("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const i=n.call(t,...r);typeof i=="function"&&this.transformers.use(i)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=fn(t),r=this.parser||this.Parser;return Vn("parse",r),r(String(n),n)}process(t,n){const r=this;return this.freeze(),Vn("process",this.parser||this.Parser),$n("process",this.compiler||this.Compiler),n?i(void 0,n):new Promise(i);function i(s,a){const o=fn(t),c=r.parse(o);r.run(c,o,function(h,p,g){if(h||!p||!g)return u(h);const d=p,x=r.stringify(d,g);uh(x)?g.value=x:g.result=x,u(h,g)});function u(h,p){h||!p?a(h):s?s(p):n(void 0,p)}}}processSync(t){let n=!1,r;return this.freeze(),Vn("processSync",this.parser||this.Parser),$n("processSync",this.compiler||this.Compiler),this.process(t,i),Ui("processSync","process",n),r;function i(s,a){n=!0,Mi(s),r=a}}run(t,n,r){Fi(t),this.freeze();const i=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?s(void 0,r):new Promise(s);function s(a,o){const c=fn(n);i.run(t,c,u);function u(h,p,g){const d=p||t;h?o(h):a?a(d):r(void 0,d,g)}}}runSync(t,n){let r=!1,i;return this.run(t,n,s),Ui("runSync","run",r),i;function s(a,o){Mi(a),i=o,r=!0}}stringify(t,n){this.freeze();const r=fn(n),i=this.compiler||this.Compiler;return $n("stringify",i),Fi(t),i(t,r)}use(t,...n){const r=this.attachers,i=this.namespace;if(Zn("use",this.frozen),t!=null)if(typeof t=="function")c(t,n);else if(typeof t=="object")Array.isArray(t)?o(t):a(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function s(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[h,...p]=u;c(h,p)}else a(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function a(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");o(u.plugins),u.settings&&(i.settings=zn(!0,i.settings,u.settings))}function o(u){let h=-1;if(u!=null)if(Array.isArray(u))for(;++h<u.length;){const p=u[h];s(p)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,h){let p=-1,g=-1;for(;++p<r.length;)if(r[p][0]===u){g=p;break}if(g===-1)r.push([u,...h]);else if(h.length>0){let[d,...x]=h;const w=r[g][1];or(w)&&or(d)&&(d=zn(!0,w,d)),r[g]=[u,d,...x]}}}}const lh=new br().freeze();function Vn(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function $n(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function Zn(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Fi(e){if(!or(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Ui(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function fn(e){return ch(e)?e:new zs(e)}function ch(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function uh(e){return typeof e=="string"||hh(e)}function hh(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const dh="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",zi=[],Bi={allowDangerousHtml:!0},ph=/^(https?|ircs?|mailto|xmpp)$/i,fh=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Wi(e){const t=gh(e),n=mh(e);return Ch(t.runSync(t.parse(n),n),e)}function gh(e){const t=e.rehypePlugins||zi,n=e.remarkPlugins||zi,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Bi}:Bi;return lh().use(Xu).use(n).use(V1,r).use(t)}function mh(e){const t=e.children||"",n=new zs;return typeof t=="string"&&(n.value=t),n}function Ch(e,t){const n=t.allowedElements,r=t.allowElement,i=t.components,s=t.disallowedElements,a=t.skipHtml,o=t.unwrapDisallowed,c=t.urlTransform||xh;for(const h of fh)Object.hasOwn(t,h.from)&&(""+h.from+(h.to?"use `"+h.to+"` instead":"remove it")+dh+h.id,void 0);return Fs(e,u),Rl(e,{Fragment:l.Fragment,components:i,ignoreInvalidStyle:!0,jsx:l.jsx,jsxs:l.jsxs,passKeys:!0,passNode:!0});function u(h,p,g){if(h.type==="raw"&&g&&typeof p=="number")return a?g.children.splice(p,1):g.children[p]={type:"text",value:h.value},p;if(h.type==="element"){let d;for(d in Hn)if(Object.hasOwn(Hn,d)&&Object.hasOwn(h.properties,d)){const x=h.properties[d],w=Hn[d];(w===null||w.includes(h.tagName))&&(h.properties[d]=c(String(x||""),d,h))}}if(h.type==="element"){let d=n?!n.includes(h.tagName):s?s.includes(h.tagName):!1;if(!d&&r&&typeof p=="number"&&(d=!r(h,p,g)),d&&g&&typeof p=="number")return o&&h.children?g.children.splice(p,1,...h.children):g.children.splice(p,1),p}}}function xh(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),i=e.indexOf("/");return t===-1||i!==-1&&t>i||n!==-1&&t>n||r!==-1&&t>r||ph.test(e.slice(0,t))?e:""}function Bs({children:e,isStreaming:t}){const[n,r]=y.useState(!0),[i,s]=y.useState(!1);y.useEffect(()=>{!t&&!i?(s(!0),r(!1)):t&&(s(!1),r(!0))},[t,i]);const a=()=>{t||r(!n)},o=y.Children.map(e,c=>{if(y.isValidElement(c)){if(c.type===vr)return y.cloneElement(c,{onToggle:a,isExpanded:n});if(c.type===Ir)return y.cloneElement(c,{isVisible:n})}return c});return l.jsx("div",{className:"chat-wrapper__reasoning",children:o})}function vr({title:e,status:t="processing",duration:n,onToggle:r,isExpanded:i=!0}){const s=()=>l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_64_36210",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16",children:l.jsx("rect",{width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_64_36210)",children:l.jsx("path",{d:"M6.79576 11.9996C6.46532 11.9996 6.18343 11.8821 5.9501 11.6471C5.71676 11.4121 5.6001 11.1296 5.6001 10.7996V9.68294C4.96676 9.2685 4.4751 8.73711 4.1251 8.08878C3.7751 7.44044 3.6001 6.74405 3.6001 5.99961C3.6001 4.77394 4.02665 3.73417 4.87976 2.88028C5.73288 2.0265 6.77176 1.59961 7.99643 1.59961C9.2211 1.59961 10.2612 2.0265 11.1168 2.88028C11.9723 3.73417 12.4001 4.77394 12.4001 5.99961C12.4001 6.74205 12.2251 7.43878 11.8751 8.08978C11.5251 8.74078 11.0334 9.27183 10.4001 9.68294V10.7996C10.4001 11.1296 10.2824 11.4121 10.0471 11.6471C9.81188 11.8821 9.52904 11.9996 9.1986 11.9996H6.79576ZM6.8001 10.7996H9.2001V9.03294L9.7501 8.68294C10.2057 8.39405 10.5612 8.00972 10.8168 7.52994C11.0723 7.05017 11.2001 6.54005 11.2001 5.99961C11.2001 5.11428 10.8877 4.35961 10.2629 3.73561C9.63826 3.11161 8.88271 2.79961 7.99626 2.79961C7.10993 2.79961 6.35565 3.11161 5.73343 3.73561C5.11121 4.35961 4.8001 5.11428 4.8001 5.99961C4.8001 6.54005 4.92788 7.05017 5.18343 7.52994C5.43899 8.00972 5.79454 8.39405 6.2501 8.68294L6.8001 9.03294V10.7996ZM6.8001 14.3996C6.57343 14.3996 6.38343 14.3229 6.2301 14.1696C6.07676 14.0163 6.0001 13.8263 6.0001 13.5996V13.1996H10.0001V13.5996C10.0001 13.8263 9.92343 14.0163 9.7701 14.1696C9.61676 14.3229 9.42676 14.3996 9.2001 14.3996H6.8001Z",fill:"#637381"})})]}),a=t==="completed"||e.includes(Z.UI_TEXT.THINKING)||e.includes(Z.UI_TEXT.PROCESSING);return l.jsxs("div",{className:`chat-wrapper__reasoning-trigger ${a?"chat-wrapper__reasoning-trigger--clickable":""}`,onClick:a?r:void 0,style:{cursor:a?"pointer":"default"},children:[l.jsx("div",{className:"chat-wrapper__reasoning-icon",children:s()}),l.jsxs("span",{className:"chat-wrapper__reasoning-title",children:[e,n&&t==="completed"&&l.jsx("span",{className:"chat-wrapper__reasoning-duration",children:n})]}),a&&l.jsx("div",{className:`chat-wrapper__reasoning-arrow ${i?"":"chat-wrapper__reasoning-arrow--collapsed"}`,children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_44_18068",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"17",children:l.jsx("rect",{y:"0.000488281",width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_44_18068)",children:l.jsx("path",{d:"M8 10.4506L4 6.45059L4.85 5.60059L8 8.75059L11.15 5.60059L12 6.45059L8 10.4506Z",fill:"#637381"})})]})})]})}function Ir({children:e,isVisible:t=!0}){return t?l.jsx("div",{className:"chat-wrapper__reasoning-content",children:l.jsx("div",{className:"chat-wrapper__reasoning-text",children:e})}):null}function yh({children:e}){return l.jsx("div",{className:"chat-wrapper__tooling-handle",children:e})}function wh({title:e,status:t="processing",toolData:n,toolName:r,clientTools:i}){var c,u;const s=()=>{if(!r||!i)return null;const h=i.find(p=>p.name===r);return(h==null?void 0:h.description)||null};let a;if(r!=null&&r.startsWith("lat_")){const h=(c=n==null?void 0:n.parameters)==null?void 0:c.query,p=(u=n==null?void 0:n.parameters)==null?void 0:u.url;a=h||p||"Executing tool..."}else a=s();a&&(a.startsWith("http://")||a.startsWith("https://")||(a=a.charAt(0).toUpperCase()+a.slice(1)));const o=()=>{switch(t){case"processing":return l.jsxs("div",{className:"chat-wrapper__tooling-handle-trigger-content",children:[l.jsx("div",{className:"chat-wrapper__thinking-icon",children:r!=null&&r.startsWith("lat_tool_web_")?l.jsxs("svg",{width:"20",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_210_25142",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16",children:l.jsx("rect",{width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_210_25142)",children:l.jsx("path",{d:"M8.00001 14.4001C7.12223 14.4001 6.29445 14.2334 5.51667 13.9001C4.7389 13.5668 4.05834 13.1084 3.47501 12.5251C2.89167 11.9418 2.43334 11.2612 2.10001 10.4834C1.76667 9.70565 1.60001 8.87788 1.60001 8.0001C1.60001 7.11121 1.76667 6.28065 2.10001 5.50843C2.43334 4.73621 2.89167 4.05843 3.47501 3.4751C4.05834 2.89176 4.7389 2.43343 5.51667 2.1001C6.29445 1.76676 7.12223 1.6001 8.00001 1.6001C8.8889 1.6001 9.71945 1.76676 10.4917 2.1001C11.2639 2.43343 11.9417 2.89176 12.525 3.4751C13.1083 4.05843 13.5667 4.73621 13.9 5.50843C14.2333 6.28065 14.4 7.11121 14.4 8.0001C14.4 8.87788 14.2333 9.70565 13.9 10.4834C13.5667 11.2612 13.1083 11.9418 12.525 12.5251C11.9417 13.1084 11.2639 13.5668 10.4917 13.9001C9.71945 14.2334 8.8889 14.4001 8.00001 14.4001ZM8.00001 13.1501C8.1889 12.9612 8.37778 12.6084 8.56667 12.0918C8.75556 11.5751 8.90001 11.0112 9.00001 10.4001H7.00001C7.10001 11.0112 7.24445 11.5751 7.43334 12.0918C7.62223 12.6084 7.81112 12.9612 8.00001 13.1501ZM6.48334 12.9834C6.32778 12.6501 6.19167 12.2668 6.07501 11.8334C5.95834 11.4001 5.86112 10.9223 5.78334 10.4001H3.40001C3.72223 11.0334 4.15001 11.5751 4.68334 12.0251C5.21667 12.4751 5.81667 12.7945 6.48334 12.9834ZM9.51667 12.9834C10.1833 12.7945 10.7833 12.4751 11.3167 12.0251C11.85 11.5751 12.2778 11.0334 12.6 10.4001H10.2167C10.1389 10.9223 10.0417 11.4001 9.92501 11.8334C9.80834 12.2668 9.67223 12.6501 9.51667 12.9834ZM2.95001 9.2001H5.63334C5.61112 8.98899 5.59723 8.78065 5.59167 8.5751C5.58612 8.36954 5.58334 8.16676 5.58334 7.96676C5.58334 7.76676 5.58612 7.56954 5.59167 7.3751C5.59723 7.18065 5.61112 6.98899 5.63334 6.8001H2.95001C2.89445 7.01121 2.85556 7.21399 2.83334 7.40843C2.81112 7.60288 2.80001 7.8001 2.80001 8.0001C2.80001 8.2001 2.81112 8.39732 2.83334 8.59176C2.85556 8.78621 2.89445 8.98899 2.95001 9.2001ZM6.85001 9.2001H9.15001C9.17223 8.97788 9.18612 8.76954 9.19167 8.5751C9.19723 8.38065 9.20001 8.18899 9.20001 8.0001C9.20001 7.81121 9.19723 7.61676 9.19167 7.41676C9.18612 7.21676 9.17223 7.01121 9.15001 6.8001H6.85001C6.82778 7.01121 6.8139 7.21676 6.80834 7.41676C6.80278 7.61676 6.80001 7.81121 6.80001 8.0001C6.80001 8.18899 6.80278 8.38343 6.80834 8.58343C6.8139 8.78343 6.82778 8.98899 6.85001 9.2001ZM10.3667 9.2001H13.05C13.1056 8.98899 13.1445 8.78621 13.1667 8.59176C13.1889 8.39732 13.2 8.2001 13.2 8.0001C13.2 7.8001 13.1889 7.6001 13.1667 7.4001C13.1445 7.2001 13.1056 7.0001 13.05 6.8001H10.3667C10.3889 7.01121 10.4028 7.21954 10.4083 7.4251C10.4139 7.63065 10.4167 7.83343 10.4167 8.03343C10.4167 8.23343 10.4139 8.43065 10.4083 8.6251C10.4028 8.81954 10.3889 9.01121 10.3667 9.2001ZM10.2167 5.6001H12.6C12.2778 4.96676 11.85 4.4251 11.3167 3.9751C10.7833 3.5251 10.1833 3.20565 9.51667 3.01676C9.67223 3.3501 9.80834 3.73343 9.92501 4.16676C10.0417 4.6001 10.1389 5.07788 10.2167 5.6001ZM7.00001 5.6001H9.00001C8.90001 4.98899 8.75556 4.4251 8.56667 3.90843C8.37778 3.39176 8.1889 3.03899 8.00001 2.8501C7.81112 3.03899 7.62223 3.39176 7.43334 3.90843C7.24445 4.4251 7.10001 4.98899 7.00001 5.6001ZM3.40001 5.6001H5.78334C5.86112 5.07788 5.95834 4.6001 6.07501 4.16676C6.19167 3.73343 6.32778 3.3501 6.48334 3.01676C5.81667 3.20565 5.21667 3.5251 4.68334 3.9751C4.15001 4.4251 3.72223 4.96676 3.40001 5.6001Z",fill:"#637381"})})]}):l.jsxs("svg",{width:"20",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_64_36257",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"17",children:l.jsx("rect",{y:"0.381836",width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_64_36257)",children:l.jsx("path",{d:"M11.0999 13.6651L7.91657 10.4817C7.69435 10.5706 7.45268 10.6401 7.19157 10.6901C6.93046 10.7401 6.66657 10.7651 6.3999 10.7651C5.2999 10.7651 4.35824 10.3762 3.5749 9.5984C2.79157 8.82063 2.3999 7.88174 2.3999 6.78174C2.3999 6.36196 2.45268 5.96257 2.55824 5.58357C2.66379 5.20457 2.82212 4.85396 3.03324 4.53174L5.43324 6.93174L6.5999 5.76507L4.1999 3.36507C4.52212 3.17618 4.86935 3.03174 5.24157 2.93174C5.61379 2.83174 5.9999 2.78174 6.3999 2.78174C7.51101 2.78174 8.45546 3.17618 9.23324 3.96507C10.011 4.75396 10.3999 5.69946 10.3999 6.80157C10.3999 7.05502 10.3749 7.29007 10.3249 7.50674C10.2749 7.7234 10.2055 7.94285 10.1166 8.16507L13.3666 11.3984C13.5221 11.5578 13.5999 11.7505 13.5999 11.9762C13.5999 12.2021 13.5221 12.3928 13.3666 12.5484L12.2332 13.6651C12.0767 13.8206 11.8876 13.8984 11.6659 13.8984C11.4441 13.8984 11.2555 13.8206 11.0999 13.6651ZM11.6666 12.5317L12.2499 11.9651L8.66657 8.41507C8.88879 8.14841 9.03324 7.85674 9.0999 7.54007C9.16657 7.2234 9.1999 6.97618 9.1999 6.7984C9.1999 6.05563 8.93601 5.40885 8.40824 4.85807C7.88046 4.30718 7.24435 4.01507 6.4999 3.98174L7.86657 5.33174C7.98879 5.45596 8.0499 5.60091 8.0499 5.76657C8.0499 5.93224 7.98718 6.07735 7.86174 6.20191L5.85474 8.1949C5.72929 8.31946 5.58779 8.38174 5.43024 8.38174C5.27268 8.38174 5.13479 8.32063 5.01657 8.1984L3.5999 6.78174C3.5999 7.5484 3.8749 8.20396 4.4249 8.7484C4.9749 9.29285 5.63324 9.56507 6.3999 9.56507C6.58879 9.56507 6.8499 9.52618 7.18324 9.44841C7.51657 9.37063 7.82768 9.21507 8.11657 8.98174L11.6666 12.5317Z",fill:"#637381"})})]})}),l.jsx("span",{children:a}),l.jsxs("div",{className:"chat-wrapper__status-group",children:[l.jsx("div",{className:"chat-wrapper__thinking-icon",children:l.jsx("div",{className:"chat-wrapper__thinking-icon",children:l.jsxs("svg",{width:"20",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_64_36278",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"17",children:l.jsx("rect",{y:"0.381836",width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_64_36278)",children:l.jsx("path",{d:"M6.7966 7.78193C6.9656 7.78193 7.10843 7.72477 7.2251 7.61043C7.34176 7.4961 7.4001 7.35443 7.4001 7.18543C7.4001 7.01643 7.34293 6.8736 7.2286 6.75693C7.11426 6.64027 6.9726 6.58193 6.8036 6.58193C6.6346 6.58193 6.49176 6.6391 6.3751 6.75343C6.25843 6.86777 6.2001 7.00943 6.2001 7.17843C6.2001 7.34743 6.25726 7.49027 6.3716 7.60693C6.48593 7.7236 6.6276 7.78193 6.7966 7.78193ZM6.7966 10.1819C6.9656 10.1819 7.10843 10.1248 7.2251 10.0104C7.34176 9.8961 7.4001 9.75443 7.4001 9.58543C7.4001 9.41643 7.34293 9.2736 7.2286 9.15693C7.11426 9.04027 6.9726 8.98193 6.8036 8.98193C6.6346 8.98193 6.49176 9.0391 6.3751 9.15343C6.25843 9.26777 6.2001 9.40943 6.2001 9.57843C6.2001 9.74743 6.25726 9.89027 6.3716 10.0069C6.48593 10.1236 6.6276 10.1819 6.7966 10.1819ZM4.8001 7.58193C4.90676 7.58193 5.0001 7.54193 5.0801 7.46193C5.1601 7.38193 5.2001 7.2886 5.2001 7.18193C5.2001 7.07527 5.1601 6.98193 5.0801 6.90193C5.0001 6.82193 4.90676 6.78193 4.8001 6.78193C4.69343 6.78193 4.6001 6.82193 4.5201 6.90193C4.4401 6.98193 4.4001 7.07527 4.4001 7.18193C4.4001 7.2886 4.4401 7.38193 4.5201 7.46193C4.6001 7.54193 4.69343 7.58193 4.8001 7.58193ZM6.8001 11.9819C6.90676 11.9819 7.0001 11.9419 7.0801 11.8619C7.1601 11.7819 7.2001 11.6886 7.2001 11.5819C7.2001 11.4753 7.1601 11.3819 7.0801 11.3019C7.0001 11.2219 6.90676 11.1819 6.8001 11.1819C6.69343 11.1819 6.6001 11.2219 6.5201 11.3019C6.4401 11.3819 6.4001 11.4753 6.4001 11.5819C6.4001 11.6886 6.4401 11.7819 6.5201 11.8619C6.6001 11.9419 6.69343 11.9819 6.8001 11.9819ZM4.8001 9.98193C4.90676 9.98193 5.0001 9.94193 5.0801 9.86193C5.1601 9.78193 5.2001 9.6886 5.2001 9.58193C5.2001 9.47527 5.1601 9.38193 5.0801 9.30193C5.0001 9.22193 4.90676 9.18193 4.8001 9.18193C4.69343 9.18193 4.6001 9.22193 4.5201 9.30193C4.4401 9.38193 4.4001 9.47527 4.4001 9.58193C4.4001 9.6886 4.4401 9.78193 4.5201 9.86193C4.6001 9.94193 4.69343 9.98193 4.8001 9.98193ZM6.8001 5.58193C6.90676 5.58193 7.0001 5.54193 7.0801 5.46193C7.1601 5.38193 7.2001 5.2886 7.2001 5.18193C7.2001 5.07527 7.1601 4.98193 7.0801 4.90193C7.0001 4.82193 6.90676 4.78193 6.8001 4.78193C6.69343 4.78193 6.6001 4.82193 6.5201 4.90193C6.4401 4.98193 6.4001 5.07527 6.4001 5.18193C6.4001 5.2886 6.4401 5.38193 6.5201 5.46193C6.6001 5.54193 6.69343 5.58193 6.8001 5.58193ZM9.1966 7.78193C9.3656 7.78193 9.50843 7.72477 9.6251 7.61043C9.74176 7.4961 9.8001 7.35443 9.8001 7.18543C9.8001 7.01643 9.74293 6.8736 9.6286 6.75693C9.51426 6.64027 9.3726 6.58193 9.2036 6.58193C9.0346 6.58193 8.89176 6.6391 8.7751 6.75343C8.65843 6.86777 8.6001 7.00943 8.6001 7.17843C8.6001 7.34743 8.65726 7.49027 8.7716 7.60693C8.88593 7.7236 9.0276 7.78193 9.1966 7.78193ZM9.2001 5.58193C9.30676 5.58193 9.4001 5.54193 9.4801 5.46193C9.5601 5.38193 9.6001 5.2886 9.6001 5.18193C9.6001 5.07527 9.5601 4.98193 9.4801 4.90193C9.4001 4.82193 9.30676 4.78193 9.2001 4.78193C9.09343 4.78193 9.0001 4.82193 8.9201 4.90193C8.8401 4.98193 8.8001 5.07527 8.8001 5.18193C8.8001 5.2886 8.8401 5.38193 8.9201 5.46193C9.0001 5.54193 9.09343 5.58193 9.2001 5.58193ZM11.2001 9.98193C11.3068 9.98193 11.4001 9.94193 11.4801 9.86193C11.5601 9.78193 11.6001 9.6886 11.6001 9.58193C11.6001 9.47527 11.5601 9.38193 11.4801 9.30193C11.4001 9.22193 11.3068 9.18193 11.2001 9.18193C11.0934 9.18193 11.0001 9.22193 10.9201 9.30193C10.8401 9.38193 10.8001 9.47527 10.8001 9.58193C10.8001 9.6886 10.8401 9.78193 10.9201 9.86193C11.0001 9.94193 11.0934 9.98193 11.2001 9.98193ZM11.2001 7.58193C11.3068 7.58193 11.4001 7.54193 11.4801 7.46193C11.5601 7.38193 11.6001 7.2886 11.6001 7.18193C11.6001 7.07527 11.5601 6.98193 11.4801 6.90193C11.4001 6.82193 11.3068 6.78193 11.2001 6.78193C11.0934 6.78193 11.0001 6.82193 10.9201 6.90193C10.8401 6.98193 10.8001 7.07527 10.8001 7.18193C10.8001 7.2886 10.8401 7.38193 10.9201 7.46193C11.0001 7.54193 11.0934 7.58193 11.2001 7.58193ZM8.00476 14.7819C7.12388 14.7819 6.29454 14.6153 5.51676 14.2819C4.73899 13.9486 4.05843 13.4903 3.4751 12.9069C2.89176 12.3236 2.43343 11.6433 2.1001 10.8659C1.76676 10.0886 1.6001 9.25805 1.6001 8.37427C1.6001 7.49049 1.76676 6.66249 2.1001 5.89027C2.43343 5.11805 2.89176 4.44027 3.4751 3.85693C4.05843 3.2736 4.73876 2.81527 5.5161 2.48193C6.29343 2.1486 7.12399 1.98193 8.00776 1.98193C8.89154 1.98193 9.71954 2.1486 10.4918 2.48193C11.264 2.81527 11.9418 3.2736 12.5251 3.85693C13.1084 4.44027 13.5668 5.11927 13.9001 5.89393C14.2334 6.66871 14.4001 7.49649 14.4001 8.37727C14.4001 9.25816 14.2334 10.0875 13.9001 10.8653C13.5668 11.643 13.1084 12.3236 12.5251 12.9069C11.9418 13.4903 11.2628 13.9486 10.4881 14.2819C9.71332 14.6153 8.88554 14.7819 8.00476 14.7819ZM8.0001 13.5819C9.44454 13.5819 10.6723 13.0764 11.6834 12.0653C12.6945 11.0542 13.2001 9.82638 13.2001 8.38193C13.2001 6.93749 12.6945 5.70971 11.6834 4.6986C10.6723 3.68749 9.44454 3.18193 8.0001 3.18193C6.55565 3.18193 5.32788 3.68749 4.31676 4.6986C3.30565 5.70971 2.8001 6.93749 2.8001 8.38193C2.8001 9.82638 3.30565 11.0542 4.31676 12.0653C5.32788 13.0764 6.55565 13.5819 8.0001 13.5819ZM9.2001 11.9819C9.30676 11.9819 9.4001 11.9419 9.4801 11.8619C9.5601 11.7819 9.6001 11.6886 9.6001 11.5819C9.6001 11.4753 9.5601 11.3819 9.4801 11.3019C9.4001 11.2219 9.30676 11.1819 9.2001 11.1819C9.09343 11.1819 9.0001 11.2219 8.9201 11.3019C8.8401 11.3819 8.8001 11.4753 8.8001 11.5819C8.8001 11.6886 8.8401 11.7819 8.9201 11.8619C9.0001 11.9419 9.09343 11.9819 9.2001 11.9819ZM9.1966 10.1819C9.3656 10.1819 9.50843 10.1248 9.6251 10.0104C9.74176 9.8961 9.8001 9.75443 9.8001 9.58543C9.8001 9.41643 9.74293 9.2736 9.6286 9.15693C9.51426 9.04027 9.3726 8.98193 9.2036 8.98193C9.0346 8.98193 8.89176 9.0391 8.7751 9.15343C8.65843 9.26777 8.6001 9.40943 8.6001 9.57843C8.6001 9.74743 8.65726 9.89027 8.7716 10.0069C8.88593 10.1236 9.0276 10.1819 9.1966 10.1819Z",fill:"#637381"})})]})})}),l.jsx("span",{children:"Running..."})]})]});case"completed":return l.jsxs("div",{className:"chat-wrapper__tooling-handle-trigger-content",children:[l.jsx("div",{className:"chat-wrapper__thinking-icon",children:r!=null&&r.startsWith("lat_tool_web_")?l.jsxs("svg",{width:"20",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_210_25142",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16",children:l.jsx("rect",{width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_210_25142)",children:l.jsx("path",{d:"M8.00001 14.4001C7.12223 14.4001 6.29445 14.2334 5.51667 13.9001C4.7389 13.5668 4.05834 13.1084 3.47501 12.5251C2.89167 11.9418 2.43334 11.2612 2.10001 10.4834C1.76667 9.70565 1.60001 8.87788 1.60001 8.0001C1.60001 7.11121 1.76667 6.28065 2.10001 5.50843C2.43334 4.73621 2.89167 4.05843 3.47501 3.4751C4.05834 2.89176 4.7389 2.43343 5.51667 2.1001C6.29445 1.76676 7.12223 1.6001 8.00001 1.6001C8.8889 1.6001 9.71945 1.76676 10.4917 2.1001C11.2639 2.43343 11.9417 2.89176 12.525 3.4751C13.1083 4.05843 13.5667 4.73621 13.9 5.50843C14.2333 6.28065 14.4 7.11121 14.4 8.0001C14.4 8.87788 14.2333 9.70565 13.9 10.4834C13.5667 11.2612 13.1083 11.9418 12.525 12.5251C11.9417 13.1084 11.2639 13.5668 10.4917 13.9001C9.71945 14.2334 8.8889 14.4001 8.00001 14.4001ZM8.00001 13.1501C8.1889 12.9612 8.37778 12.6084 8.56667 12.0918C8.75556 11.5751 8.90001 11.0112 9.00001 10.4001H7.00001C7.10001 11.0112 7.24445 11.5751 7.43334 12.0918C7.62223 12.6084 7.81112 12.9612 8.00001 13.1501ZM6.48334 12.9834C6.32778 12.6501 6.19167 12.2668 6.07501 11.8334C5.95834 11.4001 5.86112 10.9223 5.78334 10.4001H3.40001C3.72223 11.0334 4.15001 11.5751 4.68334 12.0251C5.21667 12.4751 5.81667 12.7945 6.48334 12.9834ZM9.51667 12.9834C10.1833 12.7945 10.7833 12.4751 11.3167 12.0251C11.85 11.5751 12.2778 11.0334 12.6 10.4001H10.2167C10.1389 10.9223 10.0417 11.4001 9.92501 11.8334C9.80834 12.2668 9.67223 12.6501 9.51667 12.9834ZM2.95001 9.2001H5.63334C5.61112 8.98899 5.59723 8.78065 5.59167 8.5751C5.58612 8.36954 5.58334 8.16676 5.58334 7.96676C5.58334 7.76676 5.58612 7.56954 5.59167 7.3751C5.59723 7.18065 5.61112 6.98899 5.63334 6.8001H2.95001C2.89445 7.01121 2.85556 7.21399 2.83334 7.40843C2.81112 7.60288 2.80001 7.8001 2.80001 8.0001C2.80001 8.2001 2.81112 8.39732 2.83334 8.59176C2.85556 8.78621 2.89445 8.98899 2.95001 9.2001ZM6.85001 9.2001H9.15001C9.17223 8.97788 9.18612 8.76954 9.19167 8.5751C9.19723 8.38065 9.20001 8.18899 9.20001 8.0001C9.20001 7.81121 9.19723 7.61676 9.19167 7.41676C9.18612 7.21676 9.17223 7.01121 9.15001 6.8001H6.85001C6.82778 7.01121 6.8139 7.21676 6.80834 7.41676C6.80278 7.61676 6.80001 7.81121 6.80001 8.0001C6.80001 8.18899 6.80278 8.38343 6.80834 8.58343C6.8139 8.78343 6.82778 8.98899 6.85001 9.2001ZM10.3667 9.2001H13.05C13.1056 8.98899 13.1445 8.78621 13.1667 8.59176C13.1889 8.39732 13.2 8.2001 13.2 8.0001C13.2 7.8001 13.1889 7.6001 13.1667 7.4001C13.1445 7.2001 13.1056 7.0001 13.05 6.8001H10.3667C10.3889 7.01121 10.4028 7.21954 10.4083 7.4251C10.4139 7.63065 10.4167 7.83343 10.4167 8.03343C10.4167 8.23343 10.4139 8.43065 10.4083 8.6251C10.4028 8.81954 10.3889 9.01121 10.3667 9.2001ZM10.2167 5.6001H12.6C12.2778 4.96676 11.85 4.4251 11.3167 3.9751C10.7833 3.5251 10.1833 3.20565 9.51667 3.01676C9.67223 3.3501 9.80834 3.73343 9.92501 4.16676C10.0417 4.6001 10.1389 5.07788 10.2167 5.6001ZM7.00001 5.6001H9.00001C8.90001 4.98899 8.75556 4.4251 8.56667 3.90843C8.37778 3.39176 8.1889 3.03899 8.00001 2.8501C7.81112 3.03899 7.62223 3.39176 7.43334 3.90843C7.24445 4.4251 7.10001 4.98899 7.00001 5.6001ZM3.40001 5.6001H5.78334C5.86112 5.07788 5.95834 4.6001 6.07501 4.16676C6.19167 3.73343 6.32778 3.3501 6.48334 3.01676C5.81667 3.20565 5.21667 3.5251 4.68334 3.9751C4.15001 4.4251 3.72223 4.96676 3.40001 5.6001Z",fill:"#637381"})})]}):l.jsxs("svg",{width:"20",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_64_36257",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"17",children:l.jsx("rect",{y:"0.381836",width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_64_36257)",children:l.jsx("path",{d:"M11.0999 13.6651L7.91657 10.4817C7.69435 10.5706 7.45268 10.6401 7.19157 10.6901C6.93046 10.7401 6.66657 10.7651 6.3999 10.7651C5.2999 10.7651 4.35824 10.3762 3.5749 9.5984C2.79157 8.82063 2.3999 7.88174 2.3999 6.78174C2.3999 6.36196 2.45268 5.96257 2.55824 5.58357C2.66379 5.20457 2.82212 4.85396 3.03324 4.53174L5.43324 6.93174L6.5999 5.76507L4.1999 3.36507C4.52212 3.17618 4.86935 3.03174 5.24157 2.93174C5.61379 2.83174 5.9999 2.78174 6.3999 2.78174C7.51101 2.78174 8.45546 3.17618 9.23324 3.96507C10.011 4.75396 10.3999 5.69946 10.3999 6.80157C10.3999 7.05502 10.3749 7.29007 10.3249 7.50674C10.2749 7.7234 10.2055 7.94285 10.1166 8.16507L13.3666 11.3984C13.5221 11.5578 13.5999 11.7505 13.5999 11.9762C13.5999 12.2021 13.5221 12.3928 13.3666 12.5484L12.2332 13.6651C12.0767 13.8206 11.8876 13.8984 11.6659 13.8984C11.4441 13.8984 11.2555 13.8206 11.0999 13.6651ZM11.6666 12.5317L12.2499 11.9651L8.66657 8.41507C8.88879 8.14841 9.03324 7.85674 9.0999 7.54007C9.16657 7.2234 9.1999 6.97618 9.1999 6.7984C9.1999 6.05563 8.93601 5.40885 8.40824 4.85807C7.88046 4.30718 7.24435 4.01507 6.4999 3.98174L7.86657 5.33174C7.98879 5.45596 8.0499 5.60091 8.0499 5.76657C8.0499 5.93224 7.98718 6.07735 7.86174 6.20191L5.85474 8.1949C5.72929 8.31946 5.58779 8.38174 5.43024 8.38174C5.27268 8.38174 5.13479 8.32063 5.01657 8.1984L3.5999 6.78174C3.5999 7.5484 3.8749 8.20396 4.4249 8.7484C4.9749 9.29285 5.63324 9.56507 6.3999 9.56507C6.58879 9.56507 6.8499 9.52618 7.18324 9.44841C7.51657 9.37063 7.82768 9.21507 8.11657 8.98174L11.6666 12.5317Z",fill:"#637381"})})]})}),l.jsx("span",{children:a}),l.jsxs("div",{className:"chat-wrapper__status-group",children:[l.jsx("div",{className:"chat-wrapper__thinking-icon",children:l.jsx("div",{className:"chat-wrapper__thinking-icon",children:l.jsxs("svg",{width:"20",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_64_36345",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"17",children:l.jsx("rect",{y:"0.381836",width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_64_36345)",children:l.jsx("path",{d:"M7.1501 10.7819L11.1168 6.83193L10.2668 5.98193L7.1501 9.08193L5.73343 7.68193L4.88343 8.53193L7.1501 10.7819ZM8.0001 14.7819C7.12232 14.7819 6.29454 14.6153 5.51676 14.2819C4.73899 13.9486 4.05843 13.4903 3.4751 12.9069C2.89176 12.3236 2.43343 11.643 2.1001 10.8653C1.76676 10.0875 1.6001 9.25971 1.6001 8.38193C1.6001 7.49304 1.76676 6.66249 2.1001 5.89027C2.43343 5.11805 2.89176 4.44027 3.4751 3.85693C4.05843 3.2736 4.73899 2.81527 5.51676 2.48193C6.29454 2.1486 7.12232 1.98193 8.0001 1.98193C8.88899 1.98193 9.71954 2.1486 10.4918 2.48193C11.264 2.81527 11.9418 3.2736 12.5251 3.85693C13.1084 4.44027 13.5668 5.11805 13.9001 5.89027C14.2334 6.66249 14.4001 7.49304 14.4001 8.38193C14.4001 9.25971 14.2334 10.0875 13.9001 10.8653C13.5668 11.643 13.1084 12.3236 12.5251 12.9069C11.9418 13.4903 11.264 13.9486 10.4918 14.2819C9.71954 14.6153 8.88899 14.7819 8.0001 14.7819ZM8.0001 13.5819C9.44454 13.5819 10.6723 13.0764 11.6834 12.0653C12.6945 11.0542 13.2001 9.82638 13.2001 8.38193C13.2001 6.93749 12.6945 5.70971 11.6834 4.6986C10.6723 3.68749 9.44454 3.18193 8.0001 3.18193C6.55565 3.18193 5.32788 3.68749 4.31676 4.6986C3.30565 5.70971 2.8001 6.93749 2.8001 8.38193C2.8001 9.82638 3.30565 11.0542 4.31676 12.0653C5.32788 13.0764 6.55565 13.5819 8.0001 13.5819Z",fill:"#4EAD13"})})]})})}),l.jsx("span",{children:"Completed"})]})]});case"error":return l.jsxs("div",{className:"chat-wrapper__tooling-handle-trigger-content",children:[l.jsx("div",{className:"chat-wrapper__tooling-handle-error",children:l.jsx("svg",{width:"20",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),l.jsx("span",{className:"chat-wrapper__tooling-handle-title",children:e})]});default:return l.jsxs("div",{className:"chat-wrapper__tooling-handle-trigger-content",children:[l.jsx("div",{className:"chat-wrapper__thinking-icon",children:r!=null&&r.startsWith("lat_tool_web_")?l.jsxs("svg",{width:"20",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_210_25142",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16",children:l.jsx("rect",{width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_210_25142)",children:l.jsx("path",{d:"M8.00001 14.4001C7.12223 14.4001 6.29445 14.2334 5.51667 13.9001C4.7389 13.5668 4.05834 13.1084 3.47501 12.5251C2.89167 11.9418 2.43334 11.2612 2.10001 10.4834C1.76667 9.70565 1.60001 8.87788 1.60001 8.0001C1.60001 7.11121 1.76667 6.28065 2.10001 5.50843C2.43334 4.73621 2.89167 4.05843 3.47501 3.4751C4.05834 2.89176 4.7389 2.43343 5.51667 2.1001C6.29445 1.76676 7.12223 1.6001 8.00001 1.6001C8.8889 1.6001 9.71945 1.76676 10.4917 2.1001C11.2639 2.43343 11.9417 2.89176 12.525 3.4751C13.1083 4.05843 13.5667 4.73621 13.9 5.50843C14.2333 6.28065 14.4 7.11121 14.4 8.0001C14.4 8.87788 14.2333 9.70565 13.9 10.4834C13.5667 11.2612 13.1083 11.9418 12.525 12.5251C11.9417 13.1084 11.2639 13.5668 10.4917 13.9001C9.71945 14.2334 8.8889 14.4001 8.00001 14.4001ZM8.00001 13.1501C8.1889 12.9612 8.37778 12.6084 8.56667 12.0918C8.75556 11.5751 8.90001 11.0112 9.00001 10.4001H7.00001C7.10001 11.0112 7.24445 11.5751 7.43334 12.0918C7.62223 12.6084 7.81112 12.9612 8.00001 13.1501ZM6.48334 12.9834C6.32778 12.6501 6.19167 12.2668 6.07501 11.8334C5.95834 11.4001 5.86112 10.9223 5.78334 10.4001H3.40001C3.72223 11.0334 4.15001 11.5751 4.68334 12.0251C5.21667 12.4751 5.81667 12.7945 6.48334 12.9834ZM9.51667 12.9834C10.1833 12.7945 10.7833 12.4751 11.3167 12.0251C11.85 11.5751 12.2778 11.0334 12.6 10.4001H10.2167C10.1389 10.9223 10.0417 11.4001 9.92501 11.8334C9.80834 12.2668 9.67223 12.6501 9.51667 12.9834ZM2.95001 9.2001H5.63334C5.61112 8.98899 5.59723 8.78065 5.59167 8.5751C5.58612 8.36954 5.58334 8.16676 5.58334 7.96676C5.58334 7.76676 5.58612 7.56954 5.59167 7.3751C5.59723 7.18065 5.61112 6.98899 5.63334 6.8001H2.95001C2.89445 7.01121 2.85556 7.21399 2.83334 7.40843C2.81112 7.60288 2.80001 7.8001 2.80001 8.0001C2.80001 8.2001 2.81112 8.39732 2.83334 8.59176C2.85556 8.78621 2.89445 8.98899 2.95001 9.2001ZM6.85001 9.2001H9.15001C9.17223 8.97788 9.18612 8.76954 9.19167 8.5751C9.19723 8.38065 9.20001 8.18899 9.20001 8.0001C9.20001 7.81121 9.19723 7.61676 9.19167 7.41676C9.18612 7.21676 9.17223 7.01121 9.15001 6.8001H6.85001C6.82778 7.01121 6.8139 7.21676 6.80834 7.41676C6.80278 7.61676 6.80001 7.81121 6.80001 8.0001C6.80001 8.18899 6.80278 8.38343 6.80834 8.58343C6.8139 8.78343 6.82778 8.98899 6.85001 9.2001ZM10.3667 9.2001H13.05C13.1056 8.98899 13.1445 8.78621 13.1667 8.59176C13.1889 8.39732 13.2 8.2001 13.2 8.0001C13.2 7.8001 13.1889 7.6001 13.1667 7.4001C13.1445 7.2001 13.1056 7.0001 13.05 6.8001H10.3667C10.3889 7.01121 10.4028 7.21954 10.4083 7.4251C10.4139 7.63065 10.4167 7.83343 10.4167 8.03343C10.4167 8.23343 10.4139 8.43065 10.4083 8.6251C10.4028 8.81954 10.3889 9.01121 10.3667 9.2001ZM10.2167 5.6001H12.6C12.2778 4.96676 11.85 4.4251 11.3167 3.9751C10.7833 3.5251 10.1833 3.20565 9.51667 3.01676C9.67223 3.3501 9.80834 3.73343 9.92501 4.16676C10.0417 4.6001 10.1389 5.07788 10.2167 5.6001ZM7.00001 5.6001H9.00001C8.90001 4.98899 8.75556 4.4251 8.56667 3.90843C8.37778 3.39176 8.1889 3.03899 8.00001 2.8501C7.81112 3.03899 7.62223 3.39176 7.43334 3.90843C7.24445 4.4251 7.10001 4.98899 7.00001 5.6001ZM3.40001 5.6001H5.78334C5.86112 5.07788 5.95834 4.6001 6.07501 4.16676C6.19167 3.73343 6.32778 3.3501 6.48334 3.01676C5.81667 3.20565 5.21667 3.5251 4.68334 3.9751C4.15001 4.4251 3.72223 4.96676 3.40001 5.6001Z",fill:"#637381"})})]}):l.jsxs("svg",{width:"20",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_64_36257",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"17",children:l.jsx("rect",{y:"0.381836",width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_64_36257)",children:l.jsx("path",{d:"M11.0999 13.6651L7.91657 10.4817C7.69435 10.5706 7.45268 10.6401 7.19157 10.6901C6.93046 10.7401 6.66657 10.7651 6.3999 10.7651C5.2999 10.7651 4.35824 10.3762 3.5749 9.5984C2.79157 8.82063 2.3999 7.88174 2.3999 6.78174C2.3999 6.36196 2.45268 5.96257 2.55824 5.58357C2.66379 5.20457 2.82212 4.85396 3.03324 4.53174L5.43324 6.93174L6.5999 5.76507L4.1999 3.36507C4.52212 3.17618 4.86935 3.03174 5.24157 2.93174C5.61379 2.83174 5.9999 2.78174 6.3999 2.78174C7.51101 2.78174 8.45546 3.17618 9.23324 3.96507C10.011 4.75396 10.3999 5.69946 10.3999 6.80157C10.3999 7.05502 10.3749 7.29007 10.3249 7.50674C10.2749 7.7234 10.2055 7.94285 10.1166 8.16507L13.3666 11.3984C13.5221 11.5578 13.5999 11.7505 13.5999 11.9762C13.5999 12.2021 13.5221 12.3928 13.3666 12.5484L12.2332 13.6651C12.0767 13.8206 11.8876 13.8984 11.6659 13.8984C11.4441 13.8984 11.2555 13.8206 11.0999 13.6651ZM11.6666 12.5317L12.2499 11.9651L8.66657 8.41507C8.88879 8.14841 9.03324 7.85674 9.0999 7.54007C9.16657 7.2234 9.1999 6.97618 9.1999 6.7984C9.1999 6.05563 8.93601 5.40885 8.40824 4.85807C7.88046 4.30718 7.24435 4.01507 6.4999 3.98174L7.86657 5.33174C7.98879 5.45596 8.0499 5.60091 8.0499 5.76657C8.0499 5.93224 7.98718 6.07735 7.86174 6.20191L5.85474 8.1949C5.72929 8.31946 5.58779 8.38174 5.43024 8.38174C5.27268 8.38174 5.13479 8.32063 5.01657 8.1984L3.5999 6.78174C3.5999 7.5484 3.8749 8.20396 4.4249 8.7484C4.9749 9.29285 5.63324 9.56507 6.3999 9.56507C6.58879 9.56507 6.8499 9.52618 7.18324 9.44841C7.51657 9.37063 7.82768 9.21507 8.11657 8.98174L11.6666 12.5317Z",fill:"#637381"})})]})}),l.jsxs("span",{children:[`AI text input${r?` <${r}>`:""}`,"..."]}),l.jsx("div",{className:"chat-wrapper__thinking-icon",children:l.jsx("div",{className:"chat-wrapper__thinking-icon",children:l.jsxs("svg",{width:"20",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_44_18068",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"17",children:l.jsx("rect",{y:"0.000488281",width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_44_18068)",children:l.jsx("path",{d:"M8 10.4506L4 6.45059L4.85 5.60059L8 8.75059L11.15 5.60059L12 6.45059L8 10.4506Z",fill:"#637381"})})]})})}),l.jsx("div",{className:"chat-wrapper__thinking-icon",children:l.jsx("div",{className:"chat-wrapper__thinking-icon",children:l.jsxs("svg",{width:"20",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_64_36278",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"17",children:l.jsx("rect",{y:"0.381836",width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_64_36278)",children:l.jsx("path",{d:"M6.7966 7.78193C6.9656 7.78193 7.10843 7.72477 7.2251 7.61043C7.34176 7.4961 7.4001 7.35443 7.4001 7.18543C7.4001 7.01643 7.34293 6.8736 7.2286 6.75693C7.11426 6.64027 6.9726 6.58193 6.8036 6.58193C6.6346 6.58193 6.49176 6.6391 6.3751 6.75343C6.25843 6.86777 6.2001 7.00943 6.2001 7.17843C6.2001 7.34743 6.25726 7.49027 6.3716 7.60693C6.48593 7.7236 6.6276 7.78193 6.7966 7.78193ZM6.7966 10.1819C6.9656 10.1819 7.10843 10.1248 7.2251 10.0104C7.34176 9.8961 7.4001 9.75443 7.4001 9.58543C7.4001 9.41643 7.34293 9.2736 7.2286 9.15693C7.11426 9.04027 6.9726 8.98193 6.8036 8.98193C6.6346 8.98193 6.49176 9.0391 6.3751 9.15343C6.25843 9.26777 6.2001 9.40943 6.2001 9.57843C6.2001 9.74743 6.25726 9.89027 6.3716 10.0069C6.48593 10.1236 6.6276 10.1819 6.7966 10.1819ZM4.8001 7.58193C4.90676 7.58193 5.0001 7.54193 5.0801 7.46193C5.1601 7.38193 5.2001 7.2886 5.2001 7.18193C5.2001 7.07527 5.1601 6.98193 5.0801 6.90193C5.0001 6.82193 4.90676 6.78193 4.8001 6.78193C4.69343 6.78193 4.6001 6.82193 4.5201 6.90193C4.4401 6.98193 4.4001 7.07527 4.4001 7.18193C4.4001 7.2886 4.4401 7.38193 4.5201 7.46193C4.6001 7.54193 4.69343 7.58193 4.8001 7.58193ZM6.8001 11.9819C6.90676 11.9819 7.0001 11.9419 7.0801 11.8619C7.1601 11.7819 7.2001 11.6886 7.2001 11.5819C7.2001 11.4753 7.1601 11.3819 7.0801 11.3019C7.0001 11.2219 6.90676 11.1819 6.8001 11.1819C6.69343 11.1819 6.6001 11.2219 6.5201 11.3019C6.4401 11.3819 6.4001 11.4753 6.4001 11.5819C6.4001 11.6886 6.4401 11.7819 6.5201 11.8619C6.6001 11.9419 6.69343 11.9819 6.8001 11.9819ZM4.8001 9.98193C4.90676 9.98193 5.0001 9.94193 5.0801 9.86193C5.1601 9.78193 5.2001 9.6886 5.2001 9.58193C5.2001 9.47527 5.1601 9.38193 5.0801 9.30193C5.0001 9.22193 4.90676 9.18193 4.8001 9.18193C4.69343 9.18193 4.6001 9.22193 4.5201 9.30193C4.4401 9.38193 4.4001 9.47527 4.4001 9.58193C4.4001 9.6886 4.4401 9.78193 4.5201 9.86193C4.6001 9.94193 4.69343 9.98193 4.8001 9.98193ZM6.8001 5.58193C6.90676 5.58193 7.0001 5.54193 7.0801 5.46193C7.1601 5.38193 7.2001 5.2886 7.2001 5.18193C7.2001 5.07527 7.1601 4.98193 7.0801 4.90193C7.0001 4.82193 6.90676 4.78193 6.8001 4.78193C6.69343 4.78193 6.6001 4.82193 6.5201 4.90193C6.4401 4.98193 6.4001 5.07527 6.4001 5.18193C6.4001 5.2886 6.4401 5.38193 6.5201 5.46193C6.6001 5.54193 6.69343 5.58193 6.8001 5.58193ZM9.1966 7.78193C9.3656 7.78193 9.50843 7.72477 9.6251 7.61043C9.74176 7.4961 9.8001 7.35443 9.8001 7.18543C9.8001 7.01643 9.74293 6.8736 9.6286 6.75693C9.51426 6.64027 9.3726 6.58193 9.2036 6.58193C9.0346 6.58193 8.89176 6.6391 8.7751 6.75343C8.65843 6.86777 8.6001 7.00943 8.6001 7.17843C8.6001 7.34743 8.65726 7.49027 8.7716 7.60693C8.88593 7.7236 9.0276 7.78193 9.1966 7.78193ZM9.2001 5.58193C9.30676 5.58193 9.4001 5.54193 9.4801 5.46193C9.5601 5.38193 9.6001 5.2886 9.6001 5.18193C9.6001 5.07527 9.5601 4.98193 9.4801 4.90193C9.4001 4.82193 9.30676 4.78193 9.2001 4.78193C9.09343 4.78193 9.0001 4.82193 8.9201 4.90193C8.8401 4.98193 8.8001 5.07527 8.8001 5.18193C8.8001 5.2886 8.8401 5.38193 8.9201 5.46193C9.0001 5.54193 9.09343 5.58193 9.2001 5.58193ZM11.2001 9.98193C11.3068 9.98193 11.4001 9.94193 11.4801 9.86193C11.5601 9.78193 11.6001 9.6886 11.6001 9.58193C11.6001 9.47527 11.5601 9.38193 11.4801 9.30193C11.4001 9.22193 11.3068 9.18193 11.2001 9.18193C11.0934 9.18193 11.0001 9.22193 10.9201 9.30193C10.8401 9.38193 10.8001 9.47527 10.8001 9.58193C10.8001 9.6886 10.8401 9.78193 10.9201 9.86193C11.0001 9.94193 11.0934 9.98193 11.2001 9.98193ZM11.2001 7.58193C11.3068 7.58193 11.4001 7.54193 11.4801 7.46193C11.5601 7.38193 11.6001 7.2886 11.6001 7.18193C11.6001 7.07527 11.5601 6.98193 11.4801 6.90193C11.4001 6.82193 11.3068 6.78193 11.2001 6.78193C11.0934 6.78193 11.0001 6.82193 10.9201 6.90193C10.8401 6.98193 10.8001 7.07527 10.8001 7.18193C10.8001 7.2886 10.8401 7.38193 10.9201 7.46193C11.0001 7.54193 11.0934 7.58193 11.2001 7.58193ZM8.00476 14.7819C7.12388 14.7819 6.29454 14.6153 5.51676 14.2819C4.73899 13.9486 4.05843 13.4903 3.4751 12.9069C2.89176 12.3236 2.43343 11.6433 2.1001 10.8659C1.76676 10.0886 1.6001 9.25805 1.6001 8.37427C1.6001 7.49049 1.76676 6.66249 2.1001 5.89027C2.43343 5.11805 2.89176 4.44027 3.4751 3.85693C4.05843 3.2736 4.73876 2.81527 5.5161 2.48193C6.29343 2.1486 7.12399 1.98193 8.00776 1.98193C8.89154 1.98193 9.71954 2.1486 10.4918 2.48193C11.264 2.81527 11.9418 3.2736 12.5251 3.85693C13.1084 4.44027 13.5668 5.11927 13.9001 5.89393C14.2334 6.66871 14.4001 7.49649 14.4001 8.37727C14.4001 9.25816 14.2334 10.0875 13.9001 10.8653C13.5668 11.643 13.1084 12.3236 12.5251 12.9069C11.9418 13.4903 11.2628 13.9486 10.4881 14.2819C9.71332 14.6153 8.88554 14.7819 8.00476 14.7819ZM8.0001 13.5819C9.44454 13.5819 10.6723 13.0764 11.6834 12.0653C12.6945 11.0542 13.2001 9.82638 13.2001 8.38193C13.2001 6.93749 12.6945 5.70971 11.6834 4.6986C10.6723 3.68749 9.44454 3.18193 8.0001 3.18193C6.55565 3.18193 5.32788 3.68749 4.31676 4.6986C3.30565 5.70971 2.8001 6.93749 2.8001 8.38193C2.8001 9.82638 3.30565 11.0542 4.31676 12.0653C5.32788 13.0764 6.55565 13.5819 8.0001 13.5819ZM9.2001 11.9819C9.30676 11.9819 9.4001 11.9419 9.4801 11.8619C9.5601 11.7819 9.6001 11.6886 9.6001 11.5819C9.6001 11.4753 9.5601 11.3819 9.4801 11.3019C9.4001 11.2219 9.30676 11.1819 9.2001 11.1819C9.09343 11.1819 9.0001 11.2219 8.9201 11.3019C8.8401 11.3819 8.8001 11.4753 8.8001 11.5819C8.8001 11.6886 8.8401 11.7819 8.9201 11.8619C9.0001 11.9419 9.09343 11.9819 9.2001 11.9819ZM9.1966 10.1819C9.3656 10.1819 9.50843 10.1248 9.6251 10.0104C9.74176 9.8961 9.8001 9.75443 9.8001 9.58543C9.8001 9.41643 9.74293 9.2736 9.6286 9.15693C9.51426 9.04027 9.3726 8.98193 9.2036 8.98193C9.0346 8.98193 8.89176 9.0391 8.7751 9.15343C8.65843 9.26777 8.6001 9.40943 8.6001 9.57843C8.6001 9.74743 8.65726 9.89027 8.7716 10.0069C8.88593 10.1236 9.0276 10.1819 9.1966 10.1819Z",fill:"#637381"})})]})})}),l.jsx("span",{children:"Pending..."})]})}};return l.jsx("div",{className:"chat-wrapper__tooling-handle-trigger",children:o()})}function Rr({size:e=16,variant:t="dots"}){return t==="dots"?l.jsxs("div",{className:"chat-wrapper__loader-dots",style:{fontSize:e},children:[l.jsx("span",{}),l.jsx("span",{}),l.jsx("span",{})]}):t==="pulse"?l.jsx("div",{className:"chat-wrapper__loader-pulse",style:{width:e,height:e}}):l.jsx("div",{className:"chat-wrapper__loader-spinner",style:{width:e,height:e}})}const Sh=({message:e})=>{const[t,n]=y.useState(!0),r=()=>e.role==="system"?l.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[l.jsx("div",{className:"chat-wrapper__thinking-icon",children:l.jsxs("svg",{width:"20",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_64_36257",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"17",children:l.jsx("rect",{y:"0.381836",width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_64_36257)",children:l.jsx("path",{d:"M11.0999 13.6651L7.91657 10.4817C7.69435 10.5706 7.45268 10.6401 7.19157 10.6901C6.93046 10.7401 6.66657 10.7651 6.3999 10.7651C5.2999 10.7651 4.35824 10.3762 3.5749 9.5984C2.79157 8.82063 2.3999 7.88174 2.3999 6.78174C2.3999 6.36196 2.45268 5.96257 2.55824 5.58357C2.66379 5.20457 2.82212 4.85396 3.03324 4.53174L5.43324 6.93174L6.5999 5.76507L4.1999 3.36507C4.52212 3.17618 4.86935 3.03174 5.24157 2.93174C5.61379 2.83174 5.9999 2.78174 6.3999 2.78174C7.51101 2.78174 8.45546 3.17618 9.23324 3.96507C10.011 4.75396 10.3999 5.69946 10.3999 6.80157C10.3999 7.05502 10.3749 7.29007 10.3249 7.50674C10.2749 7.7234 10.2055 7.94285 10.1166 8.16507L13.3666 11.3984C13.5221 11.5578 13.5999 11.7505 13.5999 11.9762C13.5999 12.2021 13.5221 12.3928 13.3666 12.5484L12.2332 13.6651C12.0767 13.8206 11.8876 13.8984 11.6659 13.8984C11.4441 13.8984 11.2555 13.8206 11.0999 13.6651ZM11.6666 12.5317L12.2499 11.9651L8.66657 8.41507C8.88879 8.14841 9.03324 7.85674 9.0999 7.54007C9.16657 7.2234 9.1999 6.97618 9.1999 6.7984C9.1999 6.05563 8.93601 5.40885 8.40824 4.85807C7.88046 4.30718 7.24435 4.01507 6.4999 3.98174L7.86657 5.33174C7.98879 5.45596 8.0499 5.60091 8.0499 5.76657C8.0499 5.93224 7.98718 6.07735 7.86174 6.20191L5.85474 8.1949C5.72929 8.31946 5.58779 8.38174 5.43024 8.38174C5.27268 8.38174 5.13479 8.32063 5.01657 8.1984L3.5999 6.78174C3.5999 7.5484 3.8749 8.20396 4.4249 8.7484C4.9749 9.29285 5.63324 9.56507 6.3999 9.56507C6.58879 9.56507 6.8499 9.52618 7.18324 9.44841C7.51657 9.37063 7.82768 9.21507 8.11657 8.98174L11.6666 12.5317Z",fill:"#637381"})})]})}),l.jsx("span",{children:"AI text input <show-toolname>..."})]}):l.jsx("span",{children:"System Message"});return l.jsxs("div",{className:"chat-wrapper__system-message",children:[l.jsxs("div",{className:"chat-wrapper__system-message-header",onClick:()=>n(!t),style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[r(),l.jsx("div",{className:"chat-wrapper__thinking-icon",children:l.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{transform:t?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:[l.jsx("mask",{id:"mask0_44_18068",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"17",children:l.jsx("rect",{y:"0.000488281",width:"16",height:"16",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_44_18068)",children:l.jsx("path",{d:"M8 10.4506L4 6.45059L4.85 5.60059L8 8.75059L11.15 5.60059L12 6.45059L8 10.4506Z",fill:"#637381"})})]})})]}),t&&l.jsx("div",{className:"chat-wrapper__system-message-content",children:l.jsx("span",{children:e.content})})]})},Ws=y.createContext(null);function Eh({children:e,value:t}){return l.jsx(Ws.Provider,{value:t,children:e})}function tn(){const e=y.useContext(Ws);if(!e)throw new Error("useChatContext must be used within ChatProvider. Make sure your component is wrapped with <ChatProvider>.");return e}const Gs={pre:({children:e,...t})=>l.jsx("pre",{className:"chat-wrapper__code-block",...t,children:e}),code:({children:e,className:t,...n})=>!t?l.jsx("code",{className:"chat-wrapper__inline-code",...n,children:e}):l.jsx("code",{className:"chat-wrapper__code-block",...n,children:e}),ul:({children:e,...t})=>l.jsx("ul",{className:"chat-wrapper__list",...t,children:e}),ol:({children:e,...t})=>l.jsx("ol",{className:"chat-wrapper__ordered-list",...t,children:e}),li:({children:e,...t})=>l.jsx("li",{className:"chat-wrapper__list-item",...t,children:e})},Th={...Gs,code:({children:e,className:t,...n})=>!t?l.jsx("code",{className:"chat-wrapper__inline-code",...n,children:e}):l.jsx("code",{className:"chat-wrapper__code",...n,children:e})},Vs=y.memo(({message:e})=>{const{getReasoningTitle:t,getReasoningStatus:n,getReasoningDuration:r,getReasoningContentOnly:i,getToolingTitle:s,getToolingStatus:a,clientTools:o,currentAssistantMessageIdRef:c,onRetryMessage:u}=tn(),[h,p]=y.useState(!1),[g,d]=y.useState(!1),x=y.useCallback(async()=>{try{await navigator.clipboard.writeText(e.content),p(!0),setTimeout(()=>p(!1),2e3)}catch(P){console.error("Failed to copy message:",P)}},[e.content]),w=y.useCallback(()=>{u&&u(e.id)},[u,e.id]),A=()=>l.jsxs("div",{className:"chat-wrapper__streaming-placeholder",children:[l.jsx(Rr,{size:16,variant:"dots"}),l.jsx("span",{children:Z.UI_TEXT.THINKING})]}),E=()=>l.jsxs("div",{className:"chat-wrapper__error-message chat-wrapper__error-message--retrying",children:[l.jsx("div",{className:"chat-wrapper__error-icon",children:"ðŸ”„"}),l.jsx("div",{className:"chat-wrapper__error-content",children:l.jsx("div",{className:"chat-wrapper__error-text chat-wrapper__error-text--retrying",children:"Retrying message..."})})]}),_=()=>l.jsxs("div",{className:"chat-wrapper__error-message",children:[l.jsx("div",{className:"chat-wrapper__error-icon",children:"âš ï¸"}),l.jsxs("div",{className:"chat-wrapper__error-content",children:[l.jsx("div",{className:"chat-wrapper__error-text",children:e.errorMessage||"Failed to send message. Server may be down."}),u&&l.jsx("button",{className:"chat-wrapper__retry-button",onClick:w,children:"ðŸ”„ Retry"})]})]}),N=()=>l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"chat-wrapper__copy-button-container",children:l.jsx("button",{className:`chat-wrapper__copy-button ${g?"chat-wrapper__copy-button--visible":"chat-wrapper__copy-button--hidden"}`,onClick:x,title:"Copy message",children:l.jsx(is,{})})}),h&&l.jsx("div",{className:"chat-wrapper__copied-notification",children:"Copied!"})]}),j=()=>l.jsx("div",{className:"chat-wrapper__regular-message chat-wrapper__assistant-message-container",children:l.jsxs("div",{className:"chat-wrapper__assistant-content-wrapper",children:[l.jsx("div",{className:"chat-wrapper__markdown-content",children:l.jsx(Wi,{components:Gs,children:e.content})}),N()]})}),L=()=>l.jsxs("div",{className:"chat-wrapper__regular-message",children:[l.jsx("div",{className:"chat-wrapper__markdown-content",children:l.jsx(Wi,{components:Th,children:e.content})}),e.media&&e.media.length>0&&l.jsx("div",{className:"chat-wrapper__media",children:e.media.map((P,U)=>l.jsx("img",{src:P,alt:`Uploaded content ${U+1}`,className:"chat-wrapper__media-image"},U))}),e.isRetrying&&E(),e.hasError&&!e.isRetrying&&_()]}),T=()=>e.role==="assistant"&&e.isStreaming&&e.content===""&&e.id===c.current?A():e.role==="system"?l.jsx(Sh,{message:e}):e.role==="assistant"?j():L(),O=()=>l.jsxs(Bs,{isStreaming:e.isStreaming||!1,children:[l.jsx(vr,{title:t(e.content,e.isStreaming),status:n(e.content,e.isStreaming),duration:r(e.content)}),l.jsx(Ir,{children:i(e.content)})]}),D=()=>{var P;return l.jsx(yh,{isStreaming:e.isStreaming||!1,children:l.jsx(wh,{title:s(e.content,e.isStreaming),status:a(e.content,e.isStreaming),toolData:e.toolData,toolName:(P=e.toolData)==null?void 0:P.toolName,clientTools:o})})};return l.jsx("div",{className:`chat-wrapper__message chat-wrapper__message--${e.role==="system"?"assistant":e.role==="reasoning"?"reasoning":e.role==="tooling"?"tooling":e.role}`,onMouseEnter:()=>e.role==="assistant"&&d(!0),onMouseLeave:()=>e.role==="assistant"&&d(!1),children:e.role==="reasoning"?O():e.role==="tooling"?D():l.jsx("div",{className:"chat-wrapper__message-content",children:T()})})});Vs.displayName="MessageItem";const _h=({isVisible:e})=>e?l.jsx("div",{className:"chat-wrapper__message chat-wrapper__message--assistant",children:l.jsx("div",{className:"chat-wrapper__thinking-bubble",children:l.jsx("div",{className:"chat-wrapper__thinking-content",children:l.jsxs("div",{className:"chat-wrapper__thinking-dots",children:[l.jsx("span",{}),l.jsx("span",{}),l.jsx("span",{})]})})})}):null,$s=y.forwardRef((e,t)=>{const{messages:n,isThinking:r,isHandlingTool:i}=tn();return l.jsxs("div",{className:"chat-wrapper__messages",children:[n.map(s=>l.jsx(Vs,{message:s},s.id)),l.jsx(_h,{isVisible:r&&!i}),l.jsx("div",{ref:t})]})});$s.displayName="MessagesList";const tt=(...e)=>e.filter(Boolean).join(" "),kh=()=>l.jsxs("svg",{width:"54",height:"55",viewBox:"0 0 54 55",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsxs("g",{filter:"url(#filter0_dd_121_23927)",children:[l.jsx("path",{d:"M3 26.3541C3 13.0993 13.7452 2.35413 27 2.35413C40.2548 2.35413 51 13.0993 51 26.3541C51 39.609 40.2548 50.3541 27 50.3541C13.7452 50.3541 3 39.609 3 26.3541Z",fill:"#3D0099",shapeRendering:"crispEdges"}),l.jsx("g",{clipPath:"url(#clip0_121_23927)",children:l.jsx("path",{d:"M16.3333 26.3541L18.2133 28.2341L25.6666 20.7941V37.0208H28.3333V20.7941L35.7733 28.2474L37.6666 26.3541L26.9999 15.6874L16.3333 26.3541Z",fill:"white"})})]}),l.jsxs("defs",{children:[l.jsxs("filter",{id:"filter0_dd_121_23927",x:"0",y:"0.354126",width:"54",height:"54",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[l.jsx("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),l.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),l.jsx("feOffset",{dy:"1"}),l.jsx("feGaussianBlur",{stdDeviation:"1"}),l.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),l.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.06 0"}),l.jsx("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_121_23927"}),l.jsx("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),l.jsx("feOffset",{dy:"1"}),l.jsx("feGaussianBlur",{stdDeviation:"1.5"}),l.jsx("feComposite",{in2:"hardAlpha",operator:"out"}),l.jsx("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0"}),l.jsx("feBlend",{mode:"normal",in2:"effect1_dropShadow_121_23927",result:"effect2_dropShadow_121_23927"}),l.jsx("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect2_dropShadow_121_23927",result:"shape"})]}),l.jsx("clipPath",{id:"clip0_121_23927",children:l.jsx("rect",{width:"32",height:"32",fill:"white",transform:"translate(11 10.3541)"})})]})]}),Zs=({className:e,...t})=>l.jsx("form",{className:tt("chat-wrapper__prompt-input",e),...t}),Ar=y.forwardRef(({onChange:e,className:t,placeholder:n="What would you like to know?",minHeight:r=48,maxHeight:i=164,onKeyDown:s,...a},o)=>{const c=u=>{if(u.key==="Enter"){if(u.shiftKey)return;u.preventDefault();const h=u.currentTarget.form;if(h){const p=new Event("submit",{cancelable:!0,bubbles:!0});h.dispatchEvent(p)}}s==null||s(u)};return l.jsx("textarea",{ref:o,className:tt("chat-wrapper__prompt-textarea",t),name:"message",onChange:e,onKeyDown:c,placeholder:n,style:{minHeight:`${r}px`,maxHeight:`${i}px`},...a})});Ar.displayName="PromptInputTextarea";const Ks=({className:e,...t})=>l.jsx("div",{className:tt("chat-wrapper__prompt-toolbar",e),...t}),qs=({className:e,...t})=>l.jsx("div",{className:tt("chat-wrapper__prompt-tools",e),...t}),Xs=({variant:e="ghost",size:t="default",className:n,children:r,...i})=>{const s=t==="default"&&(typeof r=="string"||y.Children.count(r)===1)?"icon":t;return l.jsx("button",{className:tt("chat-wrapper__prompt-button",`chat-wrapper__prompt-button--${e}`,`chat-wrapper__prompt-button--${s}`,n),type:"button",...i,children:r})},Ys=({className:e,variant:t="default",size:n="icon",status:r=Ge.IDLE,children:i,disabled:s,...a})=>{let o=l.jsx(kh,{});return l.jsx("button",{className:tt("chat-wrapper__prompt-submit",`chat-wrapper__prompt-submit--${t}`,`chat-wrapper__prompt-submit--${n}`,!s&&"chat-wrapper__prompt-submit--enabled",e),type:"submit",disabled:s,...a,children:i??o})},bh=({className:e,children:t,...n})=>l.jsx("select",{className:tt("chat-wrapper__prompt-select",e),...n,children:t}),vh=({className:e,children:t,...n})=>l.jsx("button",{className:tt("chat-wrapper__prompt-select-trigger",e),type:"button",...n,children:t}),Ih=({className:e,...t})=>l.jsx("div",{className:tt("chat-wrapper__prompt-select-content",e),...t}),Rh=({className:e,value:t,...n})=>l.jsx("div",{className:tt("chat-wrapper__prompt-select-item",e),"data-value":t,...n}),Ah=({className:e,placeholder:t,...n})=>l.jsx("span",{className:tt("chat-wrapper__prompt-select-value",e),...n,children:t}),Js=({placeholderTexts:e,shouldAnimate:t,className:n=""})=>{const[r,i]=y.useState(0),[s,a]=y.useState(!1),[o,c]=y.useState(0);return y.useEffect(()=>{if(!t||e.length<=1)return;const u=setInterval(()=>{a(!0),setTimeout(()=>{i(h=>(h+1)%e.length),c(h=>h+1),a(!1)},150)},2e3);return()=>clearInterval(u)},[t,e.length]),y.useEffect(()=>{t||(i(0),a(!1),c(0))},[t]),l.jsx("div",{className:`animated-placeholder-container ${n}`,children:l.jsx("span",{className:`animated-placeholder-text ${s?"transitioning":""}`,children:e[r]},o)})},Mh=y.forwardRef((e,t)=>{const{placeholderTexts:n,isStreaming:r,isLoadingConversation:i,chatStatus:s,fileUploadEnabled:a,chipName:o,chipLogo:c,messages:u,onSubmit:h,onFileUpload:p,onStopGeneration:g}=tn(),d=u.length>0,[x,w]=y.useState(""),[A,E]=y.useState([]),_=y.useRef(null),N=n&&n.length>0?n:["What would you like to know?"],j=x.length===0&&!d&&N.length>1;y.useImperativeHandle(t,()=>({focus:()=>{var D;(D=_.current)==null||D.focus()},setText:D=>{w(D),setTimeout(()=>{if(_.current){_.current.focus();const P=D.length;_.current.setSelectionRange(P,P)}},0)}}));const L=y.useCallback(D=>{D.preventDefault();const U=new FormData(D.currentTarget).get("message");if(U!=null&&U.trim()){const M=wn(U.trim(),!1);if(!M.trim()){console.warn("Message was blocked due to security concerns");return}h(M,A),w(""),E([])}},[h,A]),T=y.useCallback(D=>{const U=D.target.value.replace(/<script[\s\S]*?<\/script>/gi,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"");w(U)},[]),O=y.useCallback(async()=>{const D=document.createElement("input");D.type="file",D.accept="image/*",D.multiple=!1,D.onchange=async P=>{const U=P.target.files;if(U){const M=Array.from(U).filter(b=>{const H=go(b.name);return H!==b.name&&console.warn(`File name sanitized: ${b.name} -> ${H}`),b.size>10485760?(console.warn(`File too large: ${b.name} (${b.size} bytes)`),!1):["image/jpeg","image/png","image/gif","image/webp"].includes(b.type)?!0:(console.warn(`File type not allowed: ${b.name} (${b.type})`),!1)});if(M.length>0){const b=await p(M);E(b)}}},D.click()},[p]);return l.jsxs(Zs,{onSubmit:L,style:{position:"relative"},className:r||i?"chat-wrapper__prompt-input--disabled":"",children:[l.jsx(Ar,{ref:_,name:"message",value:x,onChange:T,placeholder:"",disabled:r||i}),!x.trim()&&l.jsx(Js,{placeholderTexts:N,shouldAnimate:j}),A.length>0&&l.jsx("div",{style:{padding:"8px 16px",display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"center"},children:A.map((D,P)=>{const U=D.startsWith("data:image/"),M=D.startsWith("http://")||D.startsWith("https://"),b=U||M;return l.jsxs("div",{style:{position:"relative",display:"inline-block"},children:[b?l.jsxs("div",{style:{position:"relative",width:"56px",height:"56px",borderRadius:"8px",overflow:"hidden",border:"1px solid #e2e8f0"},children:[l.jsx("img",{src:D,alt:`Attachment ${P+1}`,style:{width:"100%",height:"100%",objectFit:"cover"}}),l.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.3)",zIndex:1}})]}):l.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",backgroundColor:"#1f2937",borderRadius:"12px",padding:"8px 12px",minWidth:"200px",maxWidth:"300px"},children:[l.jsx("div",{style:{width:"40px",height:"40px",backgroundColor:"#8b5cf6",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"12px",flexShrink:0},children:l.jsxs("svg",{width:"24",height:"25",viewBox:"0 0 24 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("mask",{id:"mask0_190_623",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"24",height:"25",children:l.jsx("rect",{y:"0.354126",width:"24",height:"24",fill:"#D9D9D9"})}),l.jsx("g",{mask:"url(#mask0_190_623)",children:l.jsx("path",{d:"M8.19225 13.0079H15.8077V11.5079H8.19225V13.0079ZM8.19225 15.8926H15.8077V14.3926H8.19225V15.8926ZM8.19225 18.7771H12.8077V17.2771H8.19225V18.7771ZM6.30775 21.8541C5.80258 21.8541 5.375 21.6791 5.025 21.3291C4.675 20.9791 4.5 20.5515 4.5 20.0464V4.66188C4.5 4.15671 4.675 3.72913 5.025 3.37913C5.375 3.02913 5.80258 2.85413 6.30775 2.85413H14.25L19.5 8.10413V20.0464C19.5 20.5515 19.325 20.9791 18.975 21.3291C18.625 21.6791 18.1974 21.8541 17.6923 21.8541H6.30775ZM13.5 8.85413V4.35413H6.30775C6.23075 4.35413 6.16025 4.38621 6.09625 4.45038C6.03208 4.51438 6 4.58488 6 4.66188V20.0464C6 20.1234 6.03208 20.1939 6.09625 20.2579C6.16025 20.322 6.23075 20.3541 6.30775 20.3541H17.6923C17.7692 20.3541 17.8398 20.322 17.9038 20.2579C17.9679 20.1939 18 20.1234 18 20.0464V8.85413H13.5Z",fill:"white"})})]})}),l.jsxs("div",{style:{flex:1,minWidth:0},children:[l.jsx("div",{style:{color:"white",fontSize:"14px",fontWeight:"500",marginBottom:"2px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"100px"},children:(()=>{const H=D.match(/name=([^;]+)/);return H?decodeURIComponent(H[1]):"document.pdf"})()}),l.jsx("div",{style:{color:"#9ca3af",fontSize:"12px",textTransform:"uppercase"},children:(()=>{const H=D.match(/data:([^;]+)/);if(H){const G=H[1];switch(G){case"application/pdf":return"PDF";case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return"DOC";case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":return"XLS";case"application/vnd.ms-powerpoint":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":return"PPT";case"text/plain":return"TXT";case"text/csv":return"CSV";case"application/json":return"JSON";case"application/xml":case"text/xml":return"XML";case"application/zip":return"ZIP";case"application/x-rar-compressed":return"RAR";default:const F=G.split("/")[1];return F?F.toUpperCase().substring(0,4):"FILE"}}return"FILE"})()})]})]}),l.jsx("button",{onClick:()=>{E(H=>H.filter((G,F)=>F!==P))},style:{position:"absolute",top:b?"6px":"8px",right:b?"6px":"8px",width:"20px",height:"20px",borderRadius:"50%",backgroundColor:"transparent",border:"2px solid white",color:"white",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2,boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3)",fontWeight:"bold",transition:"all 0.2s"},title:"Remove attachment",children:"Ã—"})]},P)})}),l.jsxs(Ks,{children:[l.jsxs(qs,{children:[a&&l.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[l.jsx(Xs,{variant:"ghost",size:"icon",onClick:O,title:A.length>0?`${A.length} image(s) attached`:"Attach image",disabled:r||i,style:{position:"relative"},children:l.jsxs("svg",{width:"36",height:"37",viewBox:"0 0 36 37",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[l.jsx("rect",{y:"0.354126",width:"36",height:"36",rx:"18",fill:"#F4F6F8"}),l.jsx("g",{clipPath:"url(#clip0_121_9706)",children:l.jsx("path",{d:"M21.3334 13.3541V22.9374C21.3334 24.7791 19.8417 26.2708 18 26.2708C16.1584 26.2708 14.6667 24.7791 14.6667 22.9374V12.5208C14.6667 11.3708 15.6 10.4374 16.75 10.4374C17.9 10.4374 18.8334 11.3708 18.8334 12.5208V21.2708C18.8334 21.7291 18.4584 22.1041 18 22.1041C17.5417 22.1041 17.1667 21.7291 17.1667 21.2708V13.3541H15.9167V21.2708C15.9167 22.4208 16.85 23.3541 18 23.3541C19.15 23.3541 20.0834 22.4208 20.0834 21.2708V12.5208C20.0834 10.6791 18.5917 9.18744 16.75 9.18744C14.9084 9.18744 13.4167 10.6791 13.4167 12.5208V22.9374C13.4167 25.4708 15.4667 27.5208 18 27.5208C20.5334 27.5208 22.5834 25.4708 22.5834 22.9374V13.3541H21.3334Z",fill:"#212B36"})}),l.jsx("defs",{children:l.jsx("clipPath",{id:"clip0_121_9706",children:l.jsx("rect",{width:"20",height:"20",fill:"white",transform:"translate(8 8.35413)"})})})]})}),l.jsx("span",{onClick:O,style:{fontSize:"12px",color:"#919EAB",marginLeft:"4px",cursor:"pointer"},children:"Attach"})]}),a&&o&&l.jsx("div",{className:"chat-wrapper__divider"}),o&&l.jsxs("div",{className:"chat-wrapper__restaurant-chip",children:[c&&l.jsx("img",{src:c,alt:"Chip logo",className:"chat-wrapper__restaurant-logo"}),l.jsx("span",{className:"chat-wrapper__restaurant-name",children:o})]})]}),l.jsx(Ys,{status:s,disabled:!x.trim()||i,onClick:s===Ge.STREAMING&&g?()=>{g()}:void 0})]})]})}),Qs=()=>{const{suggestedPrompts:e,chatInputRef:t}=tn();if(!e||e.length===0)return null;const n=r=>{t.current&&t.current.setText(r.description)};return l.jsxs("div",{className:"chat-wrapper__suggested-prompts",children:[l.jsx("h3",{className:"chat-wrapper__suggested-prompts-title",children:"Suggested Prompts"}),l.jsx("div",{className:"chat-wrapper__suggested-prompts-grid",children:e.map((r,i)=>l.jsx("button",{className:"chat-wrapper__suggested-prompt-card",onClick:()=>n(r),children:l.jsxs("div",{className:"chat-wrapper__suggested-prompt-content",children:[l.jsx("h4",{className:"chat-wrapper__suggested-prompt-title",children:r.title}),l.jsx("p",{className:"chat-wrapper__suggested-prompt-description",children:r.description})]})},i))})]})},ea=({size:e=20,fullHeight:t=!1})=>l.jsx("div",{className:`chat-wrapper__inline-loader ${t?"chat-wrapper__inline-loader--full-height":""}`,children:l.jsx("div",{className:"chat-wrapper__inline-loader-content",children:l.jsx(Rr,{size:e,variant:"dots"})})}),Nh=({headerName:e,headerDescription:t})=>l.jsxs("div",{className:"chat-wrapper__main-header",children:[l.jsx("h1",{className:"chat-wrapper__main-title",children:e}),t&&l.jsx("p",{className:"chat-wrapper__description",children:t})]}),Lh=()=>{const{messages:e,isLoadingConversation:t,isStreaming:n,headerName:r,headerDescription:i,suggestedPrompts:s,messagesEndRef:a,chatInputRef:o,conversationError:c}=tn(),u=ot.state.shouldShowMainHeader(e.length,n,t),h=ot.state.shouldShowSuggestedPrompts(e.length,n,t,s),p=ot.state.getContentAreaClass(e.length,n,t);return l.jsxs(l.Fragment,{children:[c&&l.jsx("div",{className:"chat-wrapper__conversation-error",children:l.jsxs("p",{children:["âš ï¸ ",c]})}),u&&l.jsx(Nh,{headerName:r,headerDescription:i}),l.jsxs("div",{className:p,children:[t&&e.length===0?l.jsx("div",{className:"chat-wrapper__messages",children:l.jsx(ea,{fullHeight:!0})}):l.jsx($s,{ref:a}),l.jsx("div",{className:"chat-wrapper__input-container",children:l.jsx(Mh,{ref:o})}),h&&l.jsx(Qs,{})]})]})},ta=y.forwardRef(({auth:e,chatServerUrl:t,chatServerKey:n,metadata:r,config:i,tools:s,devMode:a=!1,contextHelpers:o},c)=>{var on,Ft;const{token:u,entityId:h,entityType:p}=e;ot.validation.validateAuthProps({userMpAuthToken:u,chatServerUrl:t,chatServerKey:n});const g=y.useMemo(()=>ot.url.convertWebSocketToHttp(t),[t]),d=y.useMemo(()=>new bo({apiUrl:g,userMpAuthToken:u,chatServerKey:n}),[g,u,n]),x=y.useMemo(()=>s&&s.length>0?s.map(({execute:k,...de})=>de):[],[s]),w=Eo(),A=$(k=>k.isModalOpen),E=$(k=>k.isCollapsed),_=$(k=>k.currentMode),N=$(k=>k.openModal),j=$(k=>k.closeModal),L=$(k=>k.toggleCollapse),T=$(k=>k.toggleFullscreen),O=$(k=>k.setCurrentMode),D=$(k=>k.chatStatus),P=$(k=>k.setChatStatus),U=$(k=>k.streamingStatus),M=$(k=>k.setStreamingStatus),b=$(k=>k.isLoadingConversation),H=$(k=>k.setIsLoadingConversation),G=$(k=>k.conversationError),F=$(k=>k.setConversationError),q=$(k=>k.setCurrentThreadId),X=$(k=>k.providerResId),ie=$(k=>k.setProviderResId),ve=$(k=>k.isDevSettingsOpen),f=$(k=>k.setIsDevSettingsOpen),Q=$(k=>k.isStreaming),ge=$(k=>k.setIsStreaming),m=$(k=>k.isThinking),xe=$(k=>k.setIsThinking),ne=$(k=>k.streamingContent),se=$(k=>k.isHandlingTool);y.useEffect(()=>{i.mode&&O(i.mode)},[i.mode,O]),y.useEffect(()=>{if(typeof window>"u"||typeof document>"u")return;const k=de=>{de.key==="Escape"&&_==="modal"&&A&&j()};if(_==="modal"&&A)return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[_,A,j]);const{messages:Te,setMessages:le,currentAssistantMessageIdRef:$e,getReasoningStatus:ze,getReasoningDuration:nt,getReasoningContentOnly:_t,getReasoningTitle:Ye,getToolingTitle:ut,getToolingStatus:Be,handleSetMessage:mt,handleReasoningUpdate:Ct,handleChatFinished:Je,handleChatError:rt,stopGeneration:it}=w,xt=y.useRef(null),st=y.useRef(null),kt=y.useRef(null),bt=y.useCallback(k=>{ie(k.providerResId),q(k.threadId),k.canUpdateMetadata&&r&&Object.keys(r).length>0&&kt.current&&kt.current.updateMetadata(k.providerResId,{metadata:r}).then(()=>{console.log("[ChatWrapper] âœ… Metadata update successful")}).catch(de=>{console.error("[ChatWrapper] âŒ Failed to update metadata:",de)})},[ie,q,r]),ht=y.useCallback(k=>{var de,Se;switch(console.log("[ChatWrapper] System event received:",k),k.type){case Ke.CHAT_COMPLETED:(de=k.data)!=null&&de.conversationId&&ie(k.data.conversationId),Je(),setTimeout(()=>{var Ce;(Ce=st.current)==null||Ce.focus()},0);break;case Ke.CHAT_ERROR:(Se=k.data)!=null&&Se.error&&rt(k.data.error);break;case Ke.CONNECTION_LOST:break;case Ke.CONNECTION_RESTORED:break;case Ke.RECONNECTING:break}},[Je,rt,ie,q]),{chatClient:S,isConnected:I,connectChatClient:V,disconnectChatClient:J}=Ga({userMpAuthToken:u,chatServerUrl:t,chatServerKey:n,entityId:h,entityType:p,tools:s,contextHelpers:o,onSetMessage:mt,onSystemEvent:ht,onReasoningUpdate:Ct,onThreadCreated:bt});y.useEffect(()=>{kt.current=S},[S]),ko({metadata:r,chatClient:S,currentProviderResId:X,isLoadingConversation:b,messages:Te,entityId:h,entityType:p}),y.useImperativeHandle(c,()=>({updateMetadata:k=>{if(!S){console.warn("ChatWrapper: Cannot update metadata - chat client not initialized");return}if(!X){console.warn("ChatWrapper: Cannot update metadata - no active conversation (providerResId not set)");return}S.updateMetadata(X,k).catch(de=>{console.error("ChatWrapper: Failed to update thread metadata:",de)})}}),[S,X]);const te=y.useMemo(()=>S?new vo(S,{onError:i.onError}):null,[S,i.onError]),{resetConversationLoader:ye}=_o({entityId:h,entityType:p,httpApiUrl:g,userMpAuthToken:u,chatServerKey:n,messages:Te,setMessages:le,setIsLoadingConversation:H,setConversationError:F,setCurrentThreadId:q,setProviderResId:ie,metadata:r}),_e=y.useRef(null),me=y.useCallback(()=>{_e.current&&cancelAnimationFrame(_e.current),_e.current=requestAnimationFrame(()=>{var k;(k=xt.current)==null||k.scrollIntoView({behavior:"smooth"}),_e.current=null})},[]);y.useEffect(()=>{me()},[Te,me]),y.useEffect(()=>{ne&&me()},[ne,me]),y.useEffect(()=>{i.onStreamingStatusChange&&i.onStreamingStatusChange(U)},[U,i]),y.useEffect(()=>()=>{_e.current&&cancelAnimationFrame(_e.current)},[]);const je=y.useCallback(async(k,de)=>{if(!k.trim()||Q||!te||!S)return;ge(!0),xe(!0),P(Ge.SUBMITTED),M(Yt.STARTING);const Se=te.createUserMessage(k,de);le(Ce=>[...Ce,Se]);try{await S.onTriggerMessage({message:Se.content,media:de,providerResId:X||void 0}),P(Ge.STREAMING)}catch(Ce){xe(!1),P(Ge.ERROR),le(Re=>Re.map(Qe=>Qe.id===Se.id?{...Qe,hasError:!0,errorMessage:I?Ce instanceof Error?Ce.message:"Failed to send message":"Failed to send message."}:Qe)),ge(!1),P(Ge.IDLE),M(Yt.IDLE)}},[te,S,Q,I,le,ge,xe,P,M,X]),we=y.useCallback(async k=>await d.uploadFiles(k),[d]),ue=y.useMemo(()=>ot.css.getContainerClasses(_,i.position,i.theme,E,i.constrainedHeight),[_,i.position,i.theme,E,i.constrainedHeight]),Ze=y.useCallback(()=>{_==="modal"?N():L()},[_,N,L]),Ie=y.useCallback(()=>{f(!0)},[f]),nn=y.useCallback(k=>{st.current&&st.current.setText(k.description)},[]),vt=y.useMemo(()=>({messages:Te,isStreaming:Q,isThinking:m,isHandlingTool:se}),[Te,Q,m,se]),It=y.useMemo(()=>({isLoadingConversation:b,chatStatus:D,conversationError:G}),[b,D,G]),rn=y.useMemo(()=>{var k;return{headerName:i.headerName,headerDescription:i.headerDescription,placeholderTexts:i.placeholderTexts,chipName:i.chipName,chipLogo:i.chipLogo,suggestedPrompts:i.suggestedPrompts,clientTools:x,fileUploadEnabled:(k=i.features)==null?void 0:k.fileUpload}},[i.headerName,i.headerDescription,i.placeholderTexts,i.chipName,i.chipLogo,i.suggestedPrompts,(on=i.features)==null?void 0:on.fileUpload,x]),yt=y.useMemo(()=>({getReasoningTitle:Ye,getReasoningStatus:ze,getReasoningDuration:nt,getReasoningContentOnly:_t,getToolingTitle:ut,getToolingStatus:Be}),[Ye,ze,nt,_t,ut,Be]),sn=y.useCallback(async k=>{const de=Te.find(Se=>Se.id===k);if(de){le(Se=>Se.map(Ce=>Ce.id===k?{...Ce,hasError:!1,isRetrying:!0,errorMessage:void 0}:Ce));try{ye(),await V(),await(S==null?void 0:S.onTriggerMessage({message:de.content,media:de.media,providerResId:X||void 0})),le(Se=>Se.map(Ce=>Ce.id===k?{...Ce,isRetrying:!1}:Ce))}catch(Se){le(Ce=>Ce.map(Re=>Re.id===k?{...Re,isRetrying:!1,hasError:!0,errorMessage:Se instanceof Error?Se.message:"Retry failed"}:Re))}}},[Te,le,ye,V,je]),an=y.useMemo(()=>({onSubmit:je,onFileUpload:we,onStopGeneration:it,onPromptSelect:nn,onRetryMessage:sn}),[je,we,it,nn,sn]),he=y.useMemo(()=>({...vt,...It,...rn,...yt,...an,currentAssistantMessageIdRef:$e,messagesEndRef:xt,chatInputRef:st}),[vt,It,rn,yt,an,$e,xt,st]);return y.useMemo(()=>ot.state.shouldShowBubble(_,A,E),[_,A,E])?l.jsx(Jr,{children:l.jsx(No,{mode:_,headerName:i.headerName,bubbleText:i.bubbleText,showBubbleText:((Ft=i.features)==null?void 0:Ft.showBubbleText)!==!1,onClick:Ze})}):l.jsx(Jr,{children:l.jsx(Ao,{onError:k=>{console.error("WebSocket error in ChatWrapper:",k),i.onError&&i.onError(k)},children:l.jsxs("div",{className:ue,style:i.customStyles,children:[a&&i.headerVisible===!1&&l.jsx("button",{className:"chat-wrapper__settings-button chat-wrapper__settings-button--floating",onClick:Ie,title:"Developer Settings",children:l.jsx(hr,{size:16})}),ot.state.shouldShowHeader(i.headerVisible)&&l.jsx(Lo,{headerName:i.headerName,mode:_,isCollapsed:E,isModalOpen:A,devMode:a,onClose:j,onToggleFullscreen:T,onToggleCollapse:L,onOpenSettings:Ie}),!E&&l.jsx(Mo,{onError:k=>{console.error("File upload error:",k),i.onError&&i.onError(k)},children:l.jsx(Eh,{value:he,children:l.jsx(Lh,{})})}),l.jsx(Vi,{isOpen:ve,onClose:()=>f(!1),apiUrl:g,userMpAuthToken:u,chatServerKey:n,onDisconnect:J,isConnected:I})]})})})});ta.displayName="ChatWrapperContainer";const Oh=y.memo(ta);function Dh({isConnected:e,isConnecting:t=!1,isReconnecting:n=!1,reconnectAttempt:r=0,maxReconnectAttempts:i=1/0,onRetry:s,autoHideDuration:a=3e3}){const[o,c]=y.useState("hidden"),[u,h]=y.useState(!1);if(y.useEffect(()=>{console.log("[ConnectionNotification] State update:",{isConnected:e,isConnecting:t,isReconnecting:n,reconnectAttempt:r,wasDisconnected:u,currentState:o}),t?c("connecting"):!e&&!n?(h(!0),i!==1/0&&r>=i?c("error"):c("hidden")):n?(console.log("[ConnectionNotification] Setting state to RECONNECTING"),c("reconnecting")):e&&u?(c("hidden"),h(!1)):e&&!u&&c("hidden")},[e,t,n,r,i,u,a]),o==="hidden")return null;const p=()=>{s&&s()},d=(()=>{switch(o){case"connecting":return{icon:"ðŸ”„",title:"Connecting...",message:"Establishing connection to the server"};case"reconnecting":return{icon:"ðŸ”„",title:"Reconnecting...",message:i===1/0?`Attempting to restore connection (${r})`:`Attempting to restore connection (${r}/${i})`};case"error":return{icon:"âŒ",title:"Connection Failed",message:"Unable to connect to the server. Please check your internet connection and try again."};default:return null}})();return d?o==="connecting"?l.jsx("div",{className:`connection-notification connection-notification--${o}`,children:l.jsxs("div",{className:"connection-notification__bubbles",children:[l.jsx("div",{className:"connection-notification__bubble"}),l.jsx("div",{className:"connection-notification__bubble"}),l.jsx("div",{className:"connection-notification__bubble"})]})}):o==="reconnecting"?(console.log("[ConnectionNotification] RENDERING RECONNECTING BANNER",{reconnectAttempt:r}),l.jsx("div",{className:`connection-notification connection-notification--banner connection-notification--${o}`,children:l.jsxs("div",{className:"connection-notification__banner-content",children:[l.jsx("span",{className:"connection-notification__banner-spinner"}),l.jsxs("span",{className:"connection-notification__banner-text",children:["Reconnecting... (attempt ",r,")"]})]})})):l.jsx("div",{className:`connection-notification connection-notification--${o}`,children:l.jsxs("div",{className:"connection-notification__content",children:[l.jsx("div",{className:"connection-notification__icon",children:d.icon}),l.jsx("div",{className:"connection-notification__title",children:d.title}),l.jsx("div",{className:"connection-notification__message",children:d.message}),s&&l.jsx("div",{className:"connection-notification__actions",children:l.jsx("button",{className:"connection-notification__retry-btn primary",onClick:p,children:"Try Again"})})]})}):null}var na=(e=>(e.BRAND="BRAND",e.ACCOUNT="ACCOUNT",e.USER="USER",e))(na||{});exports.AnimatedPlaceholder=Js;exports.CHAT_STATUS=Ge;exports.ChatIcon=es;exports.ChatWrapper=Oh;exports.CloseIcon=ts;exports.CollapseIcon=rs;exports.ConnectionNotification=Dh;exports.CopyIcon=is;exports.DevSettings=Vi;exports.EntityType=na;exports.FullscreenIcon=ns;exports.InlineLoader=ea;exports.Loader=Rr;exports.PROCESSING_STATUS=be;exports.PromptInput=Zs;exports.PromptInputButton=Xs;exports.PromptInputModelSelect=bh;exports.PromptInputModelSelectContent=Ih;exports.PromptInputModelSelectItem=Rh;exports.PromptInputModelSelectTrigger=vh;exports.PromptInputModelSelectValue=Ah;exports.PromptInputSubmit=Ys;exports.PromptInputTextarea=Ar;exports.PromptInputToolbar=Ks;exports.PromptInputTools=qs;exports.Reasoning=Bs;exports.ReasoningContent=Ir;exports.ReasoningTrigger=vr;exports.STREAMING_STATUS=Yt;exports.SettingsIcon=hr;exports.SuggestedPrompts=Qs;exports.fetchThreadMessages=Gi;exports.isChatActive=ya;exports.isChatError=Sa;exports.isChatIdle=wa;exports.isProcessingActive=Ea;exports.isProcessingComplete=Ta;exports.isProcessingError=_a;exports.updateThread=cr;exports.updateThreadMetadata=ur;exports.useChatState=Ma;exports.useConversationState=Na;exports.useDevState=Oa;exports.useLayoutState=Aa;exports.useThreadState=La;exports.useUIState=To;exports.useUIStore=$;
